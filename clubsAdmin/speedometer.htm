<html>
<head>
<title>Upload in Progress...</title>
<script>
function getProgress() {
	if (parent.PU3_total) {
		return [parent.PU3_total, parent.PU3_uploaded].join('|');
	}
	return '0|0';
}

function generateFlash() {
  var session = "", varBeg, varName, varValue;
  var progressUrl = "", uploadId = "";
  var str = document.location.href;
  var theleft = str.indexOf("?");
  if (theleft != -1) {
    var queryString = str.substring(theleft+1);
    var vars = queryString.split("&");
    for (var vi=0;vi < vars.length; vi++) {
      varBeg = vars[vi].indexOf("=");
      if (varBeg != -1) {
        varName = vars[vi].substring(0,varBeg);
        varValue = vars[vi].substring(varBeg+1,vars[vi].length);
      }
      if (varName) {
        switch (varName.toLowerCase()) {
          case "progressurl":
            progressUrl = "ProgressUrl=" + escape(varValue) + "&"
            break;
          case "uploadid":
            uploadId = "UploadId=" + escape(varValue) + "&"
            break;
        }
      }
    }
  } else {
    window.close();
  }

  var protocol = "http";
  var theUrl = document.location.href;
  if (theUrl) {
    theUrl = theUrl.toLowerCase();
    protocol = (theUrl.indexOf('https://') != -1 ? 'https' : 'http');
  }

  var tag = '' +
  '<object id="progress" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="' + protocol + '://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" width="400" height="200">' +
  '  <param name="movie" value="speedometer.swf">' +
  '  <param name="FlashVars" value="' + progressUrl + uploadId + 'BackgroundColor=#222222&MeterTextColor=#000000&MeterBackgroundColor=#D0D0D0&MeterWijzerColor=#FF0000&InfoText=#status%20#file&InitText=Initializing&UploadingText=Uploading&WritingText=Writing&CompletedText=Done&TimeVarsText=second,seconds,minute,minutes,hour,hours" />' +
  '  <param name="menu" value="false" />' +
  '  <param name="quality" value="high" />'+
  '  <param name="wmode" value="transparent" />'+
  '  <embed src="speedometer.swf"' +
  '    flashvars="' + progressUrl + uploadId + 'BackgroundColor=#222222&MeterTextColor=#000000&MeterBackgroundColor=#D0D0D0&MeterWijzerColor=#FF0000&InfoText=#status%20#file&InitText=Initializing&UploadingText=Uploading&WritingText=Writing&CompletedText=Done&TimeVarsText=second,seconds,minute,minutes,hour,hours' +
  '    quality="high" wmode="transparent" pluginspage="' + protocol + '://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="400" height="200">'+
  '  </embed>'+
  '</object>';
  document.write(tag);
}
</script>
</head>
<body marginheight="0" topmargin="0" vspace="0" marginwidth="0" leftmargin="0" hspace="0" style="margin:0; padding:0">
<script>if (document.location) generateFlash();</script>
</body>
</html>