(function(h){var t,q,G=function(h,l){var m=0,n=[];l&&(l.length?n=l:n[l-1]=null);this.complete=function(){m+=1;m===n.length&&(h(n),m=0,n=[])};this.push=function(c){n.push(c)};this.getList=function(){return n}},R=function(){var h=[];this.push=function(l){h.push(l);1===h.length&&l()};this.next=function(){h.shift();if(h.length)h[0]()}};t=function(f){var l=this,m,n,c={namespace:"file_upload",uploadFormFilter:function(a){return!0},fileInputFilter:function(a){return!0},cssClass:"file_upload",dragDropSupport:!0,
dropZone:f,url:function(a){return a.attr("action")},method:function(a){return a.attr("method")},fieldName:function(a){return a.attr("name")},formData:function(a){return a.serializeArray()},requestHeaders:null,multipart:!0,multiFileRequest:!1,withCredentials:!1,forceIframeUpload:!1,sequentialUploads:!1,maxChunkSize:null,maxFileReaderSize:5E7,replaceFileInput:!0},r={},s={},q=/^http(s)?:\/\//,y,u=new G(function(a){if("function"===typeof c.onLoadAll)c.onLoadAll(a)}),z=new R,p=function(){u.complete();
z.next()},t=function(){return"undefined"!==typeof XMLHttpRequest&&"undefined"!==typeof XMLHttpRequestUpload&&"undefined"!==typeof File&&(!c.multipart||"undefined"!==typeof FormData||"undefined"!==typeof FileReader&&"function"===typeof XMLHttpRequest.prototype.sendAsBinary)},H=function(){c.dragDropSupport&&("function"===typeof c.onDocumentDragEnter&&(r["dragenter."+c.namespace]=function(a){c.onDocumentDragEnter(a)}),"function"===typeof c.onDocumentDragLeave&&(r["dragleave."+c.namespace]=function(a){c.onDocumentDragLeave(a)}),
r["dragover."+c.namespace]=l.onDocumentDragOver,r["drop."+c.namespace]=l.onDocumentDrop,h(document).bind(r),"function"===typeof c.onDragEnter&&(s["dragenter."+c.namespace]=function(a){c.onDragEnter(a)}),"function"===typeof c.onDragLeave&&(s["dragleave."+c.namespace]=function(a){c.onDragLeave(a)}),s["dragover."+c.namespace]=l.onDragOver,s["drop."+c.namespace]=l.onDrop,c.dropZone.bind(s));n.bind("change."+c.namespace,l.onChange)},I=function(){h.each(r,function(a,b){h(document).unbind(a,b)});h.each(s,
function(a,b){c.dropZone.unbind(a,b)});n.unbind("change."+c.namespace)},v=function(a){return"undefined"!==typeof a.uploadedBytes},w=function(a,b,g){var d;"function"===typeof document.createEvent&&"undefined"!==typeof ProgressEvent?(d=document.createEvent("ProgressEvent"),d.initProgressEvent("progress",!1,!1,a,b,g)):d={lengthComputable:!0,loaded:b,total:g};return d},A=function(a,b,g){var d;if("undefined"===typeof g.progressTotal)if(a[b])d=a[b].size,g.progressTotal=d?d:1;else{for(b=d=0;b<a.length;b+=
1)d+=a[b].size;g.progressTotal=d}return g.progressTotal},B=function(a,b,g,d,e){var c=0,k=0;a.lengthComputable&&"function"===typeof e.onProgressAll&&(e.progressLoaded=parseInt(a.loaded/a.total*A(b,g,e),10),b=u.getList(),h.each(b,function(a,b){c+=b[3].progressLoaded||0;k+=A(b[0],b[1],b[3])}),a=w(!0,c,k),e.onProgressAll(a,b))},S=function(a,b,g,d,e){var c;if(v(e)){e.uploadedBytes+=e.chunkSize;c=w(!0,e.uploadedBytes,b[g].size);if("function"===typeof e.onProgress)e.onProgress(c,b,g,d,e);B(c,b,g,d,e);if(e.uploadedBytes<
b[g].size){"function"===typeof e.resumeUpload?e.resumeUpload(a,b,g,d,e,function(){x(a,b,g,d,e,!0)}):x(a,b,g,d,e,!0);return}}e.progressLoaded=A(b,g,e);if("function"===typeof e.onLoad)e.onLoad(a,b,g,d,e);p()},T=function(a,b,g,d){g.upload&&(g.upload.onprogress=function(e){var c=e;v(d)&&e.lengthComputable&&(c=w(!0,d.uploadedBytes+parseInt(e.loaded/e.total*d.chunkSize,10),a[b].size));if("function"===typeof d.onProgress)d.onProgress(c,a,b,g,d);B(c,a,b,g,d)});g.onload=function(e){S(e,a,b,g,d)};g.onabort=
function(e){d.progressTotal=d.progressLoaded;if("function"===typeof d.onAbort)d.onAbort(e,a,b,g,d);p()};g.onerror=function(e){d.progressTotal=d.progressLoaded;if("function"===typeof d.onError)d.onError(e,a,b,g,d);p()}},J=function(a){return"function"===typeof a.url?a.url(a.uploadForm||m):a.url},K=function(a){return"function"===typeof a.method?a.method(a.uploadForm||m):a.method},C=function(a){return"function"===typeof a.fieldName?a.fieldName(a.fileInput||n):a.fieldName},D=function(a){var b;return"function"===
typeof a.formData?a.formData(a.uploadForm||m):h.isArray(a.formData)?a.formData:a.formData?(b=[],h.each(a.formData,function(a,d){b.push({name:a,value:d})}),b):[]},U=function(a){if(q.test(a)){var b=location.host,g=location.protocol.length+2,d=a.indexOf(b,g),b=d+b.length;return d!==g&&d!==a.indexOf("@",g)+1||a.length!==b&&-1===h.inArray(a.charAt(b),["/","?","#"])?!1:!0}return!0},V=function(a,b,g,d){a=a[b];b=J(d);var e=U(b);g.open(K(d),b,!0);if(e){if(g.setRequestHeader("X-Requested-With","XMLHttpRequest"),
!d.multipart||v(d))g.setRequestHeader("X-File-Name",a.name),g.setRequestHeader("X-File-Type",a.type),g.setRequestHeader("X-File-Size",a.size),v(d)?d.multipart||g.setRequestHeader("Content-Type","application/octet-stream"):g.setRequestHeader("Content-Type",a.type)}else d.withCredentials&&(g.withCredentials=!0);h.isArray(d.requestHeaders)?h.each(d.requestHeaders,function(a,b){g.setRequestHeader(b.name,b.value)}):d.requestHeaders&&h.each(d.requestHeaders,function(a,b){g.setRequestHeader(a,b)})},W=function(a,
b,g){var d=new FormData,e;h.each(D(g),function(a,b){d.append(b.name,b.value)});for(e=0;e<a.length;e+=1)d.append(C(g),a[e]);b.send(d)},X=function(a,b){a.reader=new FileReader;a.reader.onload=b;a.reader.readAsBinaryString(a)},Y=function(a,b,g,d){var e="",c=[];h.each(d,function(b,d){e+="--"+a+'\r\nContent-Disposition: form-data; name="'+unescape(encodeURIComponent(d.name))+'"\r\n\r\n'+unescape(encodeURIComponent(d.value))+"\r\n"});h.each(b,function(b,d){e+="--"+a+'\r\nContent-Disposition: form-data; name="'+
unescape(encodeURIComponent(g))+'"; filename="'+unescape(encodeURIComponent(d.name))+'"\r\nContent-Type: '+unescape(encodeURIComponent(d.type))+"\r\n\r\n";c.push(e);c.push(d.reader.result);delete d.reader;e="\r\n"});e+="--"+a+"--\r\n";c.push(e);return c.join("")},Z=function(a,b,g){var d="----MultiPartFormBoundary"+(new Date).getTime(),e,c;b.setRequestHeader("Content-Type","multipart/form-data; boundary="+d);e=new G(function(){b.sendAsBinary(Y(d,a,C(g),D(g)))},a.length);for(c=0;c<a.length;c+=1)X(a[c],
e.complete)},x=function(a,b,g,d,e,c){var k;k=function(){if(c||"function"!==typeof e.onSend||!1!==e.onSend(a,b,g,d,e)){var k;var f=b[g];k=e;var l=k.uploadedBytes,m=k.maxChunkSize;f&&"function"===typeof f.slice&&(l||m&&m<f.size)&&(k.uploadedBytes=l=l||0,f=f.slice(l,m||f.size-l),k.chunkSize=f.size);k=f;T(b,g,d,e);V(b,g,d,e);e.multipart?(k="number"===typeof g?[k]:b,"undefined"!==typeof FormData?W(k,d,e):"undefined"!==typeof FileReader&&"function"===typeof d.sendAsBinary?Z(k,d,e):h.error("Browser does not support multipart/form-data XHR file uploads")):
d.upload?d.send(k):h.error("Browser does not support XHR file uploads")}else p()};if(!c&&(u.push(Array.prototype.slice.call(arguments,1)),e.sequentialUploads)){z.push(k);return}k()},L=function(a,b,g,d,e){var f=new XMLHttpRequest,k=h.extend({},c);k.fileInput=g;k.uploadForm=d;"function"===typeof k.initUpload?k.initUpload(a,b,e,f,k,function(){x(a,b,e,f,k)}):x(a,b,e,f,k)},M=function(a,b,c,d,e){var f=0;"undefined"===typeof c?h.each(b,function(a,b){f+=b.size?b.size:1}):f=b[c].size?b[c].size:1;a=w(!0,f,
f);e.progressLoaded=f;B(a,b,c,d,e)},$=function(a,b,c){var d=D(c);b.find(":input").not(":disabled").attr("disabled",!0).addClass(c.namespace+"_disabled");h.each(d,function(a,d){h('<input type="hidden"/>').attr("name",d.name).val(d.value).addClass(c.namespace+"_form_data").appendTo(b)});a.attr("name",C(c)).appendTo(b)},aa=function(a,b,c){a.detach();b.find("."+c.namespace+"_disabled").removeAttr("disabled").removeClass(c.namespace+"_disabled");b.find("."+c.namespace+"_form_data").remove()},N=function(a,
b,c,d,e,f,k){var l;l=function(){if("function"===typeof f.onSend&&!1===f.onSend(a,b,k,e,f))p();else{var l={action:d.attr("action"),method:d.attr("method"),target:d.attr("target"),enctype:d.attr("enctype")};e.unbind("abort").bind("abort",function(a){e.readyState=0;e.unbind("load").attr("src","javascript".concat(":false;"));M(a,b,k,e,f);if("function"===typeof f.onAbort)f.onAbort(a,b,k,e,f);p()}).unbind("load").bind("load",function(a){e.readyState=4;M(a,b,k,e,f);if("function"===typeof f.onLoad)f.onLoad(a,
b,k,e,f);h('<iframe src="javascript:false;" style="display:none;"></iframe>').appendTo(d).remove();p()});d.attr("action",J(f)).attr("method",K(f)).attr("target",e.attr("name")).attr("enctype","multipart/form-data");$(c,d,f);e.readyState=2;d.get(0).submit();aa(c,d,f);h.each(l,function(a,b){b?d.attr(a,b):d.removeAttr(a)})}};u.push([b,k,e,f]);f.sequentialUploads?z.push(l):l()},O=function(a,b){"undefined"===typeof b.name&&"undefined"===typeof b.size&&(b.name=b.fileName,b.size=b.fileSize)},P=function(a,
b,g,d){if(a&&b&&g){var e=h('<iframe src="javascript:false;" style="display:none;" name="iframe_'+c.namespace+"_"+(new Date).getTime()+'"></iframe>'),f=h.extend({},c),k=a.target&&a.target.files,k=k?Array.prototype.slice.call(k,0):[{name:b.val(),type:null,size:null}];h.each(k,O);d=1===k.length?0:d;f.fileInput=b;f.uploadForm=g;e.readyState=0;e.abort=function(){e.trigger("abort")};e.bind("load",function(){e.unbind("load");"function"===typeof f.initUpload?f.initUpload(a,k,d,e,f,function(){N(a,k,b,g,e,
f,d)}):N(a,k,b,g,e,f,d)}).appendTo(g)}else h.error("Iframe based File Upload requires a file input change event")},E=function(a,b,g,d){var e;a:{var f=e=0,k;if(c.multipart&&"undefined"===typeof FormData){for(k=0;k<b.length;k+=1){e=b[k].size;if(e>c.maxFileReaderSize){e=!1;break a}f+=e}if(c.multiFileRequest&&f>c.maxFileReaderSize){e=!1;break a}}e=!0}if(e)if(b=Array.prototype.slice.call(b,0),h.each(b,O),c.multiFileRequest&&c.multipart&&b.length)L(a,b,g,d);else for(e=0;e<b.length;e+=1)L(a,b,g,d,e);else P(a,
g,d)},Q=function(){m=(f.is("form")?f:f.find("form")).filter(c.uploadFormFilter)},F=function(){n=(m.length?m:f).find("input:file").filter(c.fileInputFilter)};this.onDocumentDragOver=function(a){if("function"===typeof c.onDocumentDragOver&&!1===c.onDocumentDragOver(a))return!1;a.preventDefault()};this.onDocumentDrop=function(a){if("function"===typeof c.onDocumentDrop&&!1===c.onDocumentDrop(a))return!1;a.preventDefault()};this.onDragOver=function(a){if("function"===typeof c.onDragOver&&!1===c.onDragOver(a))return!1;
var b=a.originalEvent.dataTransfer;b&&b.files&&(b.dropEffect=b.effectAllowed="copy",a.preventDefault())};this.onDrop=function(a){if("function"===typeof c.onDrop&&!1===c.onDrop(a))return!1;var b=a.originalEvent.dataTransfer;b&&b.files&&t()&&E(a,b.files);a.preventDefault()};this.onChange=function(a){if("function"===typeof c.onChange&&!1===c.onChange(a))return!1;var b=h(a.target),f=h(a.target.form);if(1===f.length){if(c.replaceFileInput){b.data("file_upload_form",f);var d=b.clone(!0);h("<form/>").append(d).get(0).reset();
b.after(d).detach();F()}}else f=b.data("file_upload_form");!c.forceIframeUpload&&a.target.files&&t()?E(a,a.target.files,b,f):P(a,b,f)};this.init=function(a){a&&(h.extend(c,a),y=a);Q();F();f.data(c.namespace)?h.error('FileUpload with namespace "'+c.namespace+'" already assigned to this element'):(f.data(c.namespace,l).addClass(c.cssClass),c.dropZone.not(f).addClass(c.cssClass),H(),"function"===typeof c.init&&c.init())};this.options=function(a){var b,g,d,e;if("undefined"===typeof a)return h.extend({},
c);y&&h.extend(y,a);I();h.each(a,function(a,f){switch(a){case "namespace":h.error("The FileUpload namespace cannot be updated.");return;case "uploadFormFilter":e=d=!0;break;case "fileInputFilter":e=!0;break;case "cssClass":b=c.cssClass;break;case "dropZone":g=c.dropZone}c[a]=f});d&&Q();e&&F();"undefined"!==typeof b?(f.removeClass(b).addClass(c.cssClass),(g?g:c.dropZone).not(f).removeClass(b),c.dropZone.not(f).addClass(c.cssClass)):g&&(g.not(f).removeClass(c.cssClass),c.dropZone.not(f).addClass(c.cssClass));
H()};this.option=function(a,b){var f;if("undefined"===typeof b)return c[a];f={};f[a]=b;l.options(f)};this.destroy=function(){"function"===typeof c.destroy&&c.destroy();I();f.removeData(c.namespace).removeClass(c.cssClass);c.dropZone.not(f).removeClass(c.cssClass)};this.upload=function(a){"undefined"===typeof a.length&&(a=[a]);E(null,a)}};q={init:function(f){return this.each(function(){(new t(h(this))).init(f)})},option:function(f,l,m){m=m?m:"file_upload";var n=h(this).data(m);if(n){if(!f)return n.options();
if("string"===typeof f&&"undefined"===typeof l)return n.option(f)}else h.error('No FileUpload with namespace "'+m+'" assigned to this element');return this.each(function(){var c=h(this).data(m);c?"string"===typeof f?c.option(f,l):c.options(f):h.error('No FileUpload with namespace "'+m+'" assigned to this element')})},destroy:function(f){f=f?f:"file_upload";return this.each(function(){var l=h(this).data(f);l?l.destroy():h.error('No FileUpload with namespace "'+f+'" assigned to this element')})},upload:function(f,
l){l=l?l:"file_upload";return this.each(function(){var m=h(this).data(l);m?m.upload(f):h.error('No FileUpload with namespace "'+l+'" assigned to this element')})}};h.fn.fileUpload=function(f){if(q[f])return q[f].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof f&&f)h.error('Method "'+f+'" does not exist on jQuery.fileUpload');else return q.init.apply(this,arguments)}})(jQuery);
