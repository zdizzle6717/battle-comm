/*
 Advanced HTML Editor 3
 Version: 3.5.6
 (c) 2015 DMXzone.com
 @build 08-07-2015 13:22:28
 Rangy, a cross-browser JavaScript range and selection library
 http://code.google.com/p/rangy/

 Copyright 2012, Tim Down
 Licensed under the MIT license.
 Version: 1.2.3
 Build date: 26 February 2012
 CSS Class Applier module for Rangy.
 Adds, removes and toggles CSS classes on Ranges and Selections

 Part of Rangy, a cross-browser JavaScript range and selection library
 http://code.google.com/p/rangy/

 Depends on Rangy core.

 Copyright 2012, Tim Down
 Licensed under the MIT license.
 Version: 1.2.3
 Build date: 26 February 2012
 FastClick: polyfill to remove click delays on browsers with touch UIs.

 @version 0.6.11
 @codingstandard ftlabs-jsv2
 @copyright The Financial Times Limited [All Rights Reserved]
 @license MIT License (see LICENSE.txt)
*/
(function(){function t(a){var b,c=this;this.trackingClick=!1;this.trackingClickStart=0;this.targetElement=null;this.lastTouchIdentifier=this.touchStartY=this.touchStartX=0;this.touchBoundary=10;this.layer=a;if(!a||!a.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return t.prototype.onClick.apply(c,arguments)};this.onMouse=function(){return t.prototype.onMouse.apply(c,arguments)};this.onTouchStart=function(){return t.prototype.onTouchStart.apply(c,arguments)};
this.onTouchMove=function(){return t.prototype.onTouchMove.apply(c,arguments)};this.onTouchEnd=function(){return t.prototype.onTouchEnd.apply(c,arguments)};this.onTouchCancel=function(){return t.prototype.onTouchCancel.apply(c,arguments)};t.notNeeded(a)||(this.deviceIsAndroid&&(a.addEventListener("mouseover",this.onMouse,!0),a.addEventListener("mousedown",this.onMouse,!0),a.addEventListener("mouseup",this.onMouse,!0)),a.addEventListener("click",this.onClick,!0),a.addEventListener("touchstart",this.onTouchStart,
!1),a.addEventListener("touchmove",this.onTouchMove,!1),a.addEventListener("touchend",this.onTouchEnd,!1),a.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(a.removeEventListener=function(b,c,d){var k=Node.prototype.removeEventListener;"click"===b?k.call(a,b,c.hijacked||c,d):k.call(a,b,c,d)},a.addEventListener=function(b,c,d){var k=Node.prototype.addEventListener;"click"===b?k.call(a,b,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),
d):k.call(a,b,c,d)}),"function"===typeof a.onclick&&(b=a.onclick,a.addEventListener("click",function(a){b(a)},!1),a.onclick=null))}function Da(a){var b=!1;d.ajax({async:!1,url:a,success:function(){b=!0},dataType:"script"});return b}function la(a,b,c){return b?c?d(a).closest(b)[0]||null:d(a).parent().closest(b)[0]||null:null}function aa(a,b){var c=parseInt(a,10);if(isNaN(c)||0>c)c=aa(b,0);return c}function Ea(a,b){a.config=function(){switch(arguments.length){case 0:return b;case 1:if("string"==typeof arguments[0])return b[arguments[0]];
"object"==typeof arguments[0]&&d.extend(!0,b,arguments[0]);break;case 2:b[arguments[0]]=arguments[1]}}}function sa(){console&&console.log&&console.log.apply&&console.log.apply(console,[].slice.call(arguments))}function I(){console&&console.warn&&console.warn.apply&&console.warn.apply(console,[].slice.call(arguments))}function ba(){console&&console.error&&console.error.apply&&console.error.apply(console,[].slice.call(arguments))}function Fa(){return!1}function ca(){return!0}function ta(a){a.preventDefault()}
function Ga(a){a.stopPropagation()}function P(a,b){return d.isFunction(a)?a.apply(b||{},Array.prototype.slice.call(arguments,2)):a}function Z(a,b){return function(){return b.apply(a,arguments)}}function ua(a,b){for(b=b.split(".");a&&b[0];)if(a=a[b.shift()],"undefined"==typeof a)return!1;return!0}function Q(a){var b,c=window;for(a=a.split(".");a[0];)b=a.shift(),c=c[b]=c[b]||{}}function ha(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Wa(a){a=
ha(a);return a=a.replace(/[^\x00-\x7F]/g,function(a){var c=a.charCodeAt(0);return c in Ha?Ha[c]:a})}function Ia(){var a="dmxEditor_"+ ++Xa;return d.dmxEditor&&d.dmxEditor.instances&&d.dmxEditor.instances[a]?Ia():a}function da(a){d.dmxEditor.ui.hideMenus()}function Ya(a){window.cancelMenuHide=!1;da(d(a).siblings(),!0)}function Ja(a){do a=a.parentNode;while(a&&1===a.nodeType&&!a.hasAttribute("tabindex"));a&&1===a.nodeType&&a.focus&&a.focus()}function Za(a,b){var c=d('<ul class="menu-items-wrapper"/>').appendTo(b),
e,f=0;d.each(a,function(a,k){e=d('<li class="dmx-menu-item hoverable checkable" tabindex="0" />').appendTo(c);var h=d('<span class="dmx-menu-item-left">&nbsp;</span>'),l=d('<span class="dmx-menu-item-label">'+a+"</span>"),n=d('<span class="dmx-menu-item-right">&nbsp;</span>'),m,s;k&&"object"==typeof k?(m=!!P(k.checked,k),s=!!P(k.disabled,k),m&&(b.addClass("checked"),e.addClass("checked")),s&&e.addClass("disabled").removeAttr("tabindex"),"leftStyle"in k&&h.css(k.leftStyle),"labelStyle"in k&&l.css(k.labelStyle),
"rightStyle"in k&&n.css(k.rightStyle),"icon"in k&&(-1!=k.icon.indexOf("://")?h.append('<img src="'+k.icon+'" class="checkable" align="top" />'):h.append('<div class="dmx-editor-icon dmx-editor-icon-'+k.icon+' checkable" />')),"label"in k&&l.html(k.label),"key"in k&&n.html(k.key),k.isGroupLabel&&e.addClass("group-label").removeClass("hoverable"),k.isSeparator&&(l.html(""),e.addClass("separator").removeClass("hoverable")),e.data("menuitemData",k)):"-"==k&&(l.html(""),e.addClass("separator").removeAttr("tabindex"));
k.getMenuData&&(e[0].getMenuData=k.getMenuData,n.addClass("has-children"));e.append(h);e.append(l);e.append(n);f=Math.max(f,l.outerWidth()+n.outerWidth()+30)});c.is(":empty")?d('<li class="dmx-menu-item hoverable disabled" style="width:90px;"><span class="dmx-menu-item-left"/><span class="dmx-menu-item-label">(Empty)</span></li>').appendTo(c):c.css("width",f)}function $a(a){function b(a){var b=d.data(a,"menuitemData")||{};a.parentNode.activeItem=a;a.showMenuTimeout&&window.clearTimeout(a.showMenuTimeout);
Ya(a);d(a).trigger({type:"menuitemin",menuitem:a,menuitemData:b});b.getMenuData&&(a.showMenuTimeout=window.setTimeout(function(){d(a).trigger("popupmenu")},400))}d(".dmx-menu-item",a).not(".separator").not(".disabled").not(".group-label").each(function(a,e){var f=d(e),g=f.data("menuitemData")||{};f.bind("blur",function(a){f.triggerHandler("mouseleave")});f.bind("focus",function(a,c){c||b(this)});f.bind("mouseleave",function(a){this.showMenuTimeout&&(window.clearTimeout(this.showMenuTimeout),this.showMenuTimeout=
null);d(this).trigger({type:"menuitemout",menuitem:this,menuitemData:g})});f.bind("mouseenter",function(a){a.stopPropagation();d(this).trigger("focus",[1]);b(this)});f.bind("mousedown",function(a){a=d.Event("menucommand");a.menuitem=this;a.menuitemData=g;d(this).trigger(a);a.isDefaultPrevented()||d(this).unbind().trigger("hidemenus")})})}function Ka(a){a=d(a||".dmx-menu");d(".dmx-menu-item",a).each(function(a,c){var e=d(".dmx-menu-item-right",c);"&nbsp;"!=e.html()&&d(".dmx-menu-item-label",c).css("marginRight",
e.outerWidth({margin:!0})+12)})}function La(){this.wrapper=d('<li class="dmx-menu-item separator"><span class="dmx-menu-item-left">&nbsp;</span><span class="dmx-menu-item-label"/><span class="dmx-menu-item-right">&nbsp;</span></li>');return this}function F(a){this.options=a;this.editor=a.editor;this.wrapper=d('<li class="dmx-menu-item hoverable checkable" tabindex="0"><span class="dmx-menu-item-left">&nbsp;</span><span class="dmx-menu-item-label"/><span class="dmx-menu-item-right">'+(this.options.key||
"&nbsp;")+"</span></li>");this.init()}function va(a){this.options=a;this.editor=a.editor;this.wrapper=d('<li class="dmx-menu-item hoverable" tabindex="0"><span class="dmx-menu-item-left">&nbsp;</span><span class="dmx-menu-item-label"/><span class="dmx-menu-item-right">&nbsp;</span></li>');this.init()}function ab(a){function b(a,b){a=a.replace(/\/$/gi,"").split("/");b=b.replace(/\/$/gi,"").split("/");for(var c=b.slice(0),e=0;e<a.length;e++)if(void 0!==b[e]&&a[e].toLowerCase()==b[e].toLowerCase())c.shift();
else{for(var d=0,e=a.length-e;d<e;d++)c.unshift("..");break}return c.join("/")}function c(a,b){var c=a.nodeName;"lower"==m.alphaCase.tags?c=c.toLowerCase():"upper"==m.alphaCase.tags&&(c=c.toUpperCase());return c}function e(a,b){var c=String(a.nodeValue||a.innerHTML||a.textContent);if(1==a.nodeType&&a.nodeName in l)return c;v.repeat(m.indent.indentChar,b);8==a.nodeType&&(c="\x3c!--"+c+"--\x3e","lower"==m.alphaCase.cdata?c=c.toLowerCase():"upper"==m.alphaCase.cdata&&(c=c.toUpperCase()));m.indent.enabled&&
(c=c.replace(/[\r\n]+[\t\s]*$/g,""));c&&3==a.nodeType&&(m.indent.enabled&&(c=c.replace(/^[\r\n]+/,""),c=c.replace(/[\r\n]+$/,""),c=c.replace(/^( )+/," "),c=c.replace(/( )+$/," ")),c=Wa(c),"lower"==m.alphaCase.text?c=c.toLowerCase():"upper"==m.alphaCase.text&&(c=c.toUpperCase()));return c}function f(a,b){if(a.hasAttribute&&a.hasAttribute("dmx:orig"))return unescape(a.getAttribute("dmx:orig"));if(a.hasAttribute&&a.hasAttribute("data-orig-script"))return unescape(a.getAttribute("data-orig-script"));
var c;a:{c=m.tagFilter.length;for(var d,f,J;c--;){d=m.tagFilter[c];f=d.name;if("string"==typeof f&&("*"==f||f==a.nodeName)&&(J=P(d.value,{},a),2==J||3==J)){c=J;break a}if(f&&f instanceof RegExp&&f.test(a.nodeName)&&(J=P(d.value,{},a),2==J||3==J)){c=J;break a}}c=1}switch(c){case 1:return 1===a.nodeType?("IMG"!=a.nodeName||a.alt||(a.alt=""),a.nodeName in n?(c=m.indent.enabled,m.indent.enabled=!1,d=k(a,b)+g(a,b+1)+h(a,b),m.indent.enabled=c,d):k(a,b)+g(a,b+1)+h(a,b)):e(a,b);case 3:return 1===a.nodeType?
g(a,b):e(a,b)}return""}function g(a,b){if(1===a.nodeType){var c=a.childNodes.length,d,k="";if(0===c&&("TD"==a.nodeName||"TH"==a.nodeName))return"&nbsp;";for(d=0;d<c;d++)k+=f(a.childNodes[d],b);return k}return e(a,b)}function k(a,b){var e;e=""+((m.indent.enabled?m.eol+v.repeat(m.indent.indentChar,b):"")+"<");e+=c(a,b);if(a.attributes&&0<a.attributes.length)for(var d=0;d<a.attributes.length;d++){var f;if(f=a.attributes[d].specified){a:{f=a.attributes[d];var k=a,g={name:f.name,value:f.value};g.value=
m.attributeValueFilter(f,k);for(var h=m.attributeFilter.length,n=void 0,l=void 0,H=void 0;h--;){n=m.attributeFilter[h];l=n.name;if("string"==typeof l&&("*"==l||l==f.name)&&(H=P(n.value,{},g,k),2==H)){f=H;break a}if(l&&l instanceof RegExp&&l.test(f.name)&&(H=P(n.value,{},g,k),2==H)){f=H;break a}}f=1}f=1===f}f&&(e+=" ",f=a.attributes[d].name,"lower"==m.alphaCase.attributeName?f=f.toLowerCase():"upper"==m.alphaCase.attributeName&&(f=f.toUpperCase()),e+=f,e+='="',f=a.attributes[d],k=f.value,k=m.attributeValueFilter(f,
a),"lower"==m.alphaCase.attributeValue?k=k.toLowerCase():"upper"==m.alphaCase.attributeValue&&(k=k.toUpperCase()),f=k.replace(/"/g,"&quot;"),e+=f,e+='"')}return e+=(a.nodeName in ma?" /":"")+">"}function h(a,b){return a.nodeName in ma?"":(m.indent.enabled&&a.children.length?m.eol+v.repeat(m.indent.indentChar,b):"")+"</"+c(a,b)+">"}var l=v.makeMap("SCRIPT,STYLE,CODE,PRE,TEXTAREA"),n=v.makeMap("A,ABBR,ACRONYM,B,BASEFONT,BDO,BIG,CITE,CODE,DFN,EM,FONT,I,IMG,INPUT,KBD,LABEL,Q,S,SAMP,SELECT,SMALL,SPAN,STRIKE,STRONG,SUB,SUP,TEXTAREA,TT,U,VAR,MARK,TIME,METER,PROGRESS"),
m=d.extend(!0,{eol:"<br/>",forceXHTML:!0,indent:{enabled:!0,indentChar:"&nbsp;",indentCount:4},alphaCase:{tags:"lower",attributeName:"auto",attributeValue:"auto",text:"auto",cdata:"auto"},tagFilter:[{name:"BODY",value:3},{name:"HTML",value:2},{name:"HEAD",value:2},{name:/^dmx/i,value:3},{name:"SCRIPT",value:function(){return na?2:1}},{name:"TBODY",value:function(a){return a.children&&a.children[0]&&"TR"==a.children[0].nodeName?3:1}},{name:"DIV",value:function(a){return"_cssx_load_test"==a.id?2:1}},
{name:"SPAN",value:function(a){return 0==a.attributes.length?3:1}},{name:"FONT",value:function(a){return a.children&&0==a.children.length&&a.textContent&&""==v.trim(a.textContent)?2:1}},{name:"*",value:function(a){return-1<a.nodeName.indexOf(":")?2:"#text"==a.nodeName||a.nodeName in bb?1:2}}],attributeFilter:[{name:"*",value:function(a,b){return-1<a.name.indexOf(":")?2:1}},{name:/^_moz_/i,value:2},{name:/^dmx/i,value:2},{name:/^jquery\d+$/i,value:2},{name:/^on\w+$/i,value:function(a,b){return na?
2:1}},{name:/^(href|src|dynsrc|lowsrc)$/i,value:function(a,b){return na?/^\s*javascript:/i.test(a.value)?2:1:1}},{name:/^(rowspan|colspan)$/i,value:function(a,b){return a.value&&"1"!=a.value?1:2}},{name:/^style$/i,value:function(a,b){return a.value?1:2}},{name:/^class$/i,value:function(a,b){return!a.value||/^apple\-/i.test(a.value)?2:/^mso[^\s]+$/i.test(a.value)?(b&&b.getAttribute&&b.getAttribute("STYLE")&&b.removeAttribute("STYLE"),2):1}}],attributeValueFilter:function(a,c){if("style"==a.name.toLowerCase()){for(var e=
a.value.split(/\s*;\s*/),f=e.length,k=[],g,h=0;h<f;h++)g=e[h],/^\s*mso-/i.test(g)||/(expession|behavior)/i.test(g)||k.push(g);return 0===k.length?"":k.join(";")}if(/(src|href)/i.test(a.name)){f=a.value;e=d('<a href="'+f+'" />')[0].href;k=d('<a href="/" />')[0].href;if(0==e.indexOf(k))switch(m.linkType){case "rel":f=document.location.href;f=f.substring(0,f.lastIndexOf("/"))+"/";f=b(f,e);break;case "abs":f="/"+b(k,e);break;case "full":f=e}return m.forceXHTML?f.replace(/(?:&(amp;)*)/g,"&").replace(/&/g,
"&amp;"):f}return a.value},scriptTranslator:function(a){}},a);m.forceXHTML&&(m.alphaCase.tags="lower",m.alphaCase.attributeName="lower");Ea(this,m);this.walk=function(a,b,c){b=b||0;a=c?g(a,b):f(a,b);return a=a.replace(/^[\r\n\t\s]*/,"")}}function y(a){this.element=a;this.refresh()}function cb(a,b){this.index=b;this.element=a;this.columns=[]}function oa(a,b,c){this.element=a;this.colSpan=parseInt(a.colSpan,10)||1;this.rowSpan=parseInt(a.rowSpan,10)||1;this.startRow=b;this.startCol=c;this.updateCoordinates_()}
function Ma(){d(".dmx-menu").each(function(){var a=d(this).data("settings");if(a&&a.offsetElement){var b=a.position||"bottom",c=d(a.offsetElement).offset();switch(b){case "bottom":d(this).css({left:c.left,top:c.top+d(a.offsetElement).outerHeight(!1)})}}})}function wa(a){0==d(a.target).closest(".dmx-menu").length&&d.dmxEditor.ui.hideMenus()}function S(a,b,c){this.editor=b;this.dialog=null;this.success=!1;this.value=null;this.data={};this.options={container:"body",dialog:"",width:"auto",height:"auto",
minWidth:10,minHeight:10,darken:!1,cache:!1,parent:document,position:"down",modal:!1,retFocus:!0,onShow:null,onClose:null,onSuccess:null};d.extend(!0,this.options,c||{});this.cls="dmx-editor-dialog"+(""!=this.options.dialog?"-"+this.options.dialog:"");this.id=this.cls+"-"+a;this.cls+=" dmx-editor-wrapper"}if(window.jQuery&&"function"==typeof window.jQuery){window.ktmls||(window.ktmls=!0);t.prototype.deviceIsAndroid=0<navigator.userAgent.indexOf("Android");t.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent);
t.prototype.deviceIsIOS4=t.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent);t.prototype.deviceIsIOSWithBadTarget=t.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);t.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case "button":case "select":case "textarea":if(a.disabled)return!0;break;case "input":if(this.deviceIsIOS&&"file"===a.type||a.disabled)return!0;break;case "label":case "video":return!0}return/\bneedsclick\b/.test(a.className)};t.prototype.needsFocus=
function(a){switch(a.nodeName.toLowerCase()){case "textarea":return!0;case "select":return!this.deviceIsAndroid;case "input":switch(a.type){case "button":case "checkbox":case "file":case "image":case "radio":case "submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}};t.prototype.sendClick=function(a,b){var c,e;document.activeElement&&document.activeElement!==a&&document.activeElement.blur();e=b.changedTouches[0];c=document.createEvent("MouseEvents");c.initMouseEvent(this.determineEventType(a),
!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null);c.forwardedTouchEvent=!0;a.dispatchEvent(c)};t.prototype.determineEventType=function(a){return this.deviceIsAndroid&&"select"===a.tagName.toLowerCase()?"mousedown":"click"};t.prototype.focus=function(a){var b;this.deviceIsIOS&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()};t.prototype.updateScrollParent=function(a){var b,c;b=a.fastClickScrollParent;if(!b||
!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c;a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)};t.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a};t.prototype.onTouchStart=function(a){var b,c,e;if(1<a.targetTouches.length)return!0;b=this.getTargetElementFromEventTarget(a.target);c=a.targetTouches[0];if(this.deviceIsIOS){e=window.getSelection();if(e.rangeCount&&!e.isCollapsed)return!0;
if(!this.deviceIsIOS4){if(c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier;this.updateScrollParent(b)}}this.trackingClick=!0;this.trackingClickStart=a.timeStamp;this.targetElement=b;this.touchStartX=c.pageX;this.touchStartY=c.pageY;200>a.timeStamp-this.lastClickTime&&a.preventDefault();return!0};t.prototype.touchHasMoved=function(a){a=a.changedTouches[0];var b=this.touchBoundary;return Math.abs(a.pageX-this.touchStartX)>b||Math.abs(a.pageY-
this.touchStartY)>b?!0:!1};t.prototype.onTouchMove=function(a){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))this.trackingClick=!1,this.targetElement=null;return!0};t.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};t.prototype.onTouchEnd=function(a){var b,
c,e=this.targetElement;if(!this.trackingClick)return!0;if(200>a.timeStamp-this.lastClickTime)return this.cancelNextClick=!0;this.cancelNextClick=!1;this.lastClickTime=a.timeStamp;b=this.trackingClickStart;this.trackingClick=!1;this.trackingClickStart=0;this.deviceIsIOSWithBadTarget&&(c=a.changedTouches[0],e=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset)||e,e.fastClickScrollParent=this.targetElement.fastClickScrollParent);c=e.tagName.toLowerCase();if("label"===c){if(b=
this.findControl(e)){this.focus(e);if(this.deviceIsAndroid)return!1;e=b}}else if(this.needsFocus(e)){if(100<a.timeStamp-b||this.deviceIsIOS&&window.top!==window&&"input"===c)return this.targetElement=null,!1;this.focus(e);this.deviceIsIOS4&&"select"===c||(this.targetElement=null,a.preventDefault());return!1}if(this.deviceIsIOS&&!this.deviceIsIOS4&&(b=e.fastClickScrollParent)&&b.fastClickLastScrollTop!==b.scrollTop)return!0;this.needsClick(e)||(a.preventDefault(),this.sendClick(e,a));return!1};t.prototype.onTouchCancel=
function(){this.trackingClick=!1;this.targetElement=null};t.prototype.onMouse=function(a){return this.targetElement&&!a.forwardedTouchEvent&&a.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0:!0};t.prototype.onClick=function(a){if(this.trackingClick)return this.targetElement=null,this.trackingClick=!1,!0;if("submit"===a.target.type&&0===a.detail)return!0;
a=this.onMouse(a);a||(this.targetElement=null);return a};t.prototype.destroy=function(){var a=this.layer;this.deviceIsAndroid&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0));a.removeEventListener("click",this.onClick,!0);a.removeEventListener("touchstart",this.onTouchStart,!1);a.removeEventListener("touchmove",this.onTouchMove,!1);a.removeEventListener("touchend",this.onTouchEnd,!1);a.removeEventListener("touchcancel",
this.onTouchCancel,!1)};t.notNeeded=function(a){var b,c;if("undefined"===typeof window.ontouchstart)return!0;if(c=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1])if(t.prototype.deviceIsAndroid){if((b=document.querySelector("meta[name=viewport]"))&&(-1!==b.content.indexOf("user-scalable=no")||31<c&&window.innerWidth<=window.screen.width))return!0}else return!0;return"none"===a.style.msTouchAction?!0:!1};t.attach=function(a){return new t(a)};var d=window.jQuery,ea=function(){var a=!1,b=/xyz/.test(function(){xyz})?
/\b_super\b/:/.*/,c=function(){};c.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var g=this.prototype;a=!0;var k=new this;a=!1;for(var h in c)k[h]="function"==typeof c[h]&&"function"==typeof g[h]&&b.test(c[h])?function(a,b){return function(){var c=this._super;this._super=g[a];var e=b.apply(this,arguments);this._super=c;return e}}(h,c[h]):c[h];d.prototype=k;d.constructor=d;d.extend=arguments.callee;return d};return c}(),v={makeMap:function(a,b){a=a||[];b=d.extend({},
b||{});"string"==typeof a&&(a=a.split(/\s*,\s*/));for(var c=0,e=a.length;c<e;c++)b[a[c]]=!0;return b},resolve:function(a,b){b=b||window;a=a.split(".");for(var c=0,e=a.length;c<e&&(b=b[a[c]],b);c++);return b},resolveValue:function(a,b){var c=v.resolve(a,b);return"function"==typeof c?c.call(b||{}):c},getBasePath:function(){var a=d("script[src$='dmxEditor.min.js']");return 0!=a.length?a[0].src.replace(/dmxEditor\.min\.js$/,"").replace(/\s/g,"%20"):""},repeat:function(a,b){for(var c="",e=0;e<b;e++)c+=
a;return c},trim:function(a){return a.replace(/^\s+|\s+$/g,"")}},pa=window.opera&&window.opera.version;navigator.userAgent.toLowerCase().indexOf("webkit");var V=!pa&&(-1!=navigator.userAgent.toLowerCase().indexOf("msie")||-1!=navigator.userAgent.toLowerCase().indexOf("trident")),X=!V&&0>navigator.userAgent.toLowerCase().indexOf("compatible")&&-1!=navigator.userAgent.toLowerCase().indexOf("mozilla");navigator.appVersion.indexOf("Mac");var qa=!("iPhone"!=navigator.platform&&"iPad"!=navigator.platform&&
"iPod"!=navigator.platform||!window.Worker),xa="function"==typeof window.getSelection&&"function"==typeof document.createRange,na=!1,Na=!1,Oa={ADDRESS:"Address",BLOCKQUOTE:"Blockquote",CENTER:"Center",DIV:"Div",H1:"Heading 1",H2:"Heading 2",H3:"Heading 3",H4:"Heading 4",H5:"Heading 5",H6:"Heading 6",P:"Paragraph",PRE:"Preformatted text"},ya=d.extend({},Oa,{DIR:"DIR",DL:"Definition list",FIELDSET:"Fieldset",FORM:"Form",HR:"Horizontal rule",ISINDEX:"ISINDEX",MENU:"Menu (list)",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",
OL:"Ordered list",TABLE:"Table",UL:"Unordered list",DT:"Definition therm",DD:"Definition description",LI:"List item"}),ma=v.makeMap("AREA,BASE,BASEFONT,BR,COL,FRAME,HR,IMG,INPUT,ISINDEX,LINK,META,PARAM"),Pa=v.makeMap("TABLE,TBODY",ma),db=v.makeMap("TBODY,THEAD,TFOOT,COL,COLGROUP,TR,TH,TD,CAPTION"),eb=v.makeMap("INPUT,BUTTON,SELECT,TEXTAREA"),fb=v.makeMap("TBODY,THEAD,TFOOT");v.makeMap("CHECKED,COMPACT,DECLARE,DEFER,DISABLED,ISMAP,MULTIPLE,NOHREF,NORESIZE,NOSHADE,NOWRAP,READONLY,SELECTED");var bb=
v.makeMap("A,ABBR,ADDRESS,AREA,ARTICLE,ASIDE,AUDIO,B,BASE,BDO,BLOCKQUOTE,BODY,BR,BUTTON,CANVAS,CAPTION,CITE,CODE,COL,COLGROUP,COMMAND,DATALIST,DD,DEL,DETAILS,DFN,DIV,DL,DT,EM,EMBED,EVENTSOURCE,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEAD,HEADER,HGROUP,HR,HTML,I,IFRAME,IMG,INPUT,INS,KBD,KEYGEN,LABEL,LEGEND,LI,LINK,MARK,MAP,MENU,META,METER,NAV,NOSCRIPT,OBJECT,OL,OPTGROUP,OPTION,OUTPUT,P,PARAM,PRE,PROGRESS,Q,RUBY,RP,RT,SAMP,SCRIPT,SECTION,SELECT,SMALL,SOURCE,SPAN,STRONG,STYLE,SUB,SUMMARY,SUP,TABLE,TBODY,TD,TEXTAREA,TFOOT,TH,THEAD,TIME,TITLE,TR,UL,VAR,VIDEO,WBR,FONT,U,STRIKE,XMP,TT,ACRONYM,BASEFONT,BIG,CENTER,DIR,FRAME,FRAMESET,ISINDEX,LEGEND,NOFRAMES,S"),
Ha={160:"&nbsp;",169:"&copy;",172:"&not;",174:"&reg;",178:"&sup2;",179:"&sup3;",710:"&trade;",732:"&tilde;",8211:"&ndash;",8212:"&mdash;",8216:"&lsquo;",8217:"&rsquo;",8220:"&ldquo;",8221:"&rdquo;",8224:"&dagger;",8225:"&Dagger;",8226:"&bull;",8242:"&prime;",8243:"&Prime;",8249:"&lsaquo;",8250:"&rsaquo;",8364:"&euro;",8482:"&trade;",8592:"&larr;",8593:"&uarr;",8594:"&rarr;",8595:"&darr;",8596:"&harr;",9674:"&loz;",9824:"&spades;",9827:"&clubs;",9829:"&hearts;",9830:"&diams;"},Qa={16:"SHIFT",17:"CTRL",
18:"ALT",224:"CMD"},Ra={8:"BACKSPACE",9:"TAB",13:"ENTER",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",
119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"},gb={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z"};jQuery(window).one("load",function(){Na=!0});var za={};d.each("IE MOZILLA HAS_DOM_RANGE DIALOGS_DIR ICONSETS_DIR LOCALES_DIR EXTENSIONS_DIR NS_DMX IS_MAC NO_SCRIPT_MODE".split(" "),function(a,b){za[b]=
Function("","return "+b+";")});var Xa=0;d.dmxEditor=function(a){function b(a,b,c){if(!b||-1==b.search(/(\/styles\/dmxEditor\.css|\/ScriptLibrary\/dmxEditor\/|\/styles\/dmxEditor\/)/i)){b=a.length;for(var e,d,f=0;f<b;f++)d=a[f],"type"in d&&1!==d.type||(e=d.selectorText,-1==e.indexOf(".")||-1<e.indexOf(":")||-1<e.indexOf(" ")||"dmx"==e.substring(1,4)||(d={},e=e.split("."),d.tag=""!=e[0]?e[0].toUpperCase():"*",d.value=e[1],d.label=e[1].toLowerCase().replace(/[-_]/g," ").replace(/\b(\w)/g,function(a){return a.toUpperCase()}),
e="*"==d.tag?"General":d.tag,c.userStyles[e]||(c.userStyles[e]=[]),c.userStyles[e].push(d)))}}function c(){var a=h.getDocument(),b=d(a),c=h.getBody();d(c);c=h.getWindow();d(c);var c=h.getRootElement(),c=d(c),f=d(h.frame);h.initEvents();b.bind("keydown.editor keypress.editor keyup.editor copy.editor paste.editor delete.editor",function(a){var b=new jQuery.Event("editor:"+a.type);e(b);b.isDefaultPrevented()||h.checkForSelectionChange(a)});c.unbind("drop.editor").bind("drop.editor",function(a){h.checkForSelectionChange(a);
e("editor:drop")});f.bind("editor:unload",function(b){b.isDefaultPrevented()||(l="",d("*",a).add(a).unbind())});b.bind("mouseup.editor",function(a){h.checkForSelectionChange()});b.unbind("mousedown.editor").bind("mousedown.editor",function(a){d(document.documentElement).trigger("hidemenus");a=a.target;if(a.nodeName&&a.nodeName in Pa){var b=h.getSelection();b.removeAllRanges();var c=h.getRange();c.selectNode(a);b.addRange(c);h.checkForSelectionChange()}return!0});xa||c.unbind("mousedrag.editor").bind("mousedrag.editor",
function(a){h.checkForSelectionChange()})}function e(a){var b,c=Array.prototype.slice.call(arguments,1);b="string"==typeof a?a:a.type;b=b.replace(/^(editor\:)?/,"editor:");var e;if(e="editor:nodeselectionchange"==b)e=c,e=e[0]&&e[0]!==h.getDocument()&&1===d(e[0]).closest("body").length?!0:!1,e=!e;if(e)return!1;b=new jQuery.Event(b);"string"==typeof a?d(h.frame).trigger("editor:*",b,c).trigger(b,c):(d(h.frame).trigger("editor:*",b,c).trigger(b,c),b.isDefaultPrevented()&&a.preventDefault(),b.isPropagationStopped()&&
a.stopPropagation(),b.isImmediatePropagationStopped()&&a.stopImmediatePropagation());return b.result}function f(a,b){var c=String(a),c={editor:h,inStr:c};e("editor:"+b,c);return c=c.inStr}function g(a,b){var c=void 0===a?h.getBody().innerHTML:a+"";b||(c=u.htmlToCode(c));return f(c,"untranslate")}function k(a){a=u.codeToHtml(a+"");return f(a,"translate")}if(!a.frame)throw"Missing frame parameter in config";if(!a.element)throw"Missing element parameter in config";d.data(a.element,"dmxEditor",this);
d.data(a.frame,"dmxEditor",this);d.dmxEditor.instances||(d.dmxEditor.instances={});this.ready=!1;this.id=Ia();this.Keys={};d.dmxEditor.instances[this.id]=this;this.options=d.extend(!0,{},d.dmxEditor.Defaults,a);Ea(this,this.options);"noScript"in this.options&&(Na?delete this.options.noScript:na=!!this.options.noScript);var h=this,l,n=!0,m,s;this.importStyles=function(){if(this.options.includeCss){var a=d('link[href*="'+this.options.includeCss+'"]',this.getDocument())[0];try{var c=a.sheet||a.styleSheet,
e=c.cssRules||c.rules;e&&0<e.length&&b(e,c.href,this)}catch(f){}}};this.skin="default";this.frame=this.options.frame;this.element=this.options.element;this.Commands={};this.Toolbars={};this.userStyles={};this.currentView="design";var B=!1;this.isDocumentModified=function(){return!!B};this.history=new hb(this);this.Formatter=new ab(this.options.formatterSettings);this.wrapper=d(this.frame).parents(".dmx-editor-wrapper:first");this.storage={useColorCode:{highlightColor:"hex",backgroundColor:"hex",color:"hex"},
livePreview:{highlightColor:!0,backgroundColor:!0,color:!0}};this.stopModificationsMonitoring=function(){n=!1};this.startModificationsMonitoring=function(){n=!0};this.checkForDocChange=function(){if(n){var a=h.getHTML();if(a!=l){var b=new jQuery.Event("editor:documentedited");B=!0;e(b,l,a);b.isDefaultPrevented()||h.history.saveUndoPoint(a,"Edit document");h.refreshToolbars()}l=a}};var u={htmlToCode:function(a){return a.replace(/<span [^>]*?\bdata-orig-script="([^"]*)?"[^>]*><\/span>/gi,function(a,
b){return unescape(b)})},codeToHtml:function(a){return a.replace(/<script\b[^>]*>[\s\S]*?<\/script>/gi,function(a){return'<span contenteditable="false" onselect="return false;" onselectstart="return false;" onbeforeeditfocus="return false;" onbeforeactivate="return false;" class="dmx-script-lock" data-orig-script="'+escape(a)+'"></span>'})}};this.setHTML=function(a){var b=l;if(b!=a){B=!0;a=k(a);d(this.getBody()).html(a);X&&d(this.getBody()).css({MozUserInput:"enabled",MozUserModify:"read-write"});
l=this.getBody().innerHTML;var c=new jQuery.Event("editor:contentreplaced");e(c,b,a)}};this.save=function(){"code"==this.currentView&&this.setView("design");var a=d("<div>"+this.getBody().innerHTML+"</div>")[0];a.innerHTML=l=g(a.innerHTML,!0);var a=this.Formatter.walk(a,0,!0),a=a.replace(/ contenteditable="(true|false)"/g,""),b={editor:this,html:a};e("editor:beforeSave",b);a=b.html;a=a.replace(/\u200B/g,"");d(this.element).filter(":input").val(a).trigger("change");B=!1;e("editor:afterSave",b)};this.setView=
function(a){this.currentView=a;var b=this.getBody();"code"==a?(this.clearSelection(),this.frame.blur(),b=d("<div>"+this.getBody().innerHTML+"</div>")[0],b.innerHTML=g(b.innerHTML,!0),a=this.Formatter.walk(b,0,!0),b={editor:this,source:a},e("editor:beforeViewSource",b),a=b.source,this.frame.blur(),b=this.getBody(),a=ha(a).replace(/\r\n/g,"<br/>").replace(/ /g,"&nbsp;").replace(/(&lt;(.*?)&gt;)/gi,'<span class="ccp_tag">$1</span>').replace(/(&lt;\/?a\b(.*?)&gt;)/gi,'<span class="ccp_A">$1</span>').replace(/(&lt;\/?img\b(.*?)&gt;)/gi,
'<span class="ccp_img">$1</span>').replace(/(&lt;\/?(form|input|textarea|label|fieldset|legend|select|optgroup|option|button)\b(.*?)&gt;)/gi,'<span class="ccp_form">$1</span>').replace(/(&lt;\/?(table|th|tr|td|caption|colgroup|col|thead|tbody|tfoot)\b(.*?)&gt;)/gi,'<span class="ccp_table">$1</span>').replace(/(&lt;!--(.*?)--&gt;)/gi,'<span class="ccp_htmlcomment">$1</span>').replace(/=(&quot;(.*?)&quot;)/gi,'=<span class="ccp_paramvalue">$1</span>').replace(/(&amp;\w+;)/gi,'<span class="ccp_entity">$1</span>'),
b.innerHTML=a,d(this.getBody()).addClass("dmx-codeview")):"design"==a&&(a=d(b).html().replace(/<br\/?>/g,"\r\n").replace(/&nbsp;/g," ").replace(/<[^>]+>/g,""),a=String(a).replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),a=k(a),d(b).html(a).removeClass("dmx-codeview"),b.contentEditable=!1,l=b.innerHTML,b.contentEditable=!0);this.refreshToolbars();this.dispatch("editor:viewChanged")};this.clearSelection=function(){this.selection&&this.selection.removeAllRanges()};
this.removeNode=function(a){if(a=a||this.getSelectedNode()){if(a.nodeName in ma)return this.deleteNode(a);if(la(a,"BODY",!1)&&!(a.nodeName in db)){var b=h.selectedElement;if(xa){var c=this.getSelection();c.removeAllRanges();var f=a.parentNode,k=this.getDocument().createRange();k.selectNode(f);k.setStartBefore(a);d(a).replaceWith(a.innerHTML);c.addRange(k);c.collapseToStart();e("editor:selectionchange");f!==b&&e("editor:nodeselectionchange",f,b);e("editor:selectstart")}else r=this.getBody().createTextRange(),
r.moveToElementText(a),d(a).replaceWith(a.innerHTML),r.select()}}};this.deleteNode=function(a){var b=a||this.getSelectedNode();if(b&&la(b,"BODY",!1)&&!la(b,"TBODY",!0)&&!la(b,"TBODY",!0)){var c=this.selectedElement;if(xa){a=this.getSelection();a.removeAllRanges();var d=b.parentNode,f=this.getDocument().createRange();f.selectNode(d);f.setStartBefore(b);var k=this.getDocument().createRange();k.selectNode(b);k.deleteContents();a.addRange(f);a.collapseToStart();e("editor:selectionchange");d!==c&&e("editor:nodeselectionchange",
d,c);e("editor:selectstart")}else a.outerHTML=""}};this.setSelectedNode=function(a,b){if(!a||!a.nodeName||a.nodeName in fb||this.selectedElement===a)return!1;var c=this.getSelection(),e=this.createRange();try{e.selectNodeContents(a)}catch(d){try{e.selectNode(a)}catch(f){try{e.setStartBefore(a),e.setEndAfter(a)}catch(k){I("Can't set node selection to "+a.nodeName)}}}c.setSingleRange(e);e.toString()||this.selection.collapseToStart();this.refreshSelection("setSelectedNode");return!0};this.insertHtml=
function(a,b,c){if(!a)return!1;a=String(a);a=k(a);V&&this.focus();l=this.getHTML();var e=this.getDocument();c=this.getSelection();b?c.deleteFromDocument():c.isCollapsed||c.collapseToEnd();b=e.createElement("div");b.innerHTML=a;a=e.createDocumentFragment();for(var d;e=b.firstChild;)d=a.appendChild(e);this.range.insertNode(a);d&&(a=this.range.cloneRange(),a.setStartAfter(d),a.collapse(!0),c.removeAllRanges(),c.addRange(a));h.checkForDocChange();return!0};this.insertNode=function(a){var b=h.getSelection(),
b=h.getRange(b);b.insertNode(a);b.selectNodeContents(a);this.updateSelection();return a};this.destruct=function(){this.idleDetector.destruct();m&&window.clearInterval(m);s&&window.clearTimeout(s);d(this.frame).unbind();d(this.wrapper).find("*").andSelf().unbind(".editor");d(this.getWindow()).unbind();d("*",this.getDocument()).add(this.getDocument()).unbind();h=l=this.idleDetector=null;d(this.element).removeData("dmxEditor");d(this.frame).removeData("dmxEditor");this.storage=this.options=this.history=
this.frame=this.Toolbars=this.Formatter=this.Commands=null;d.dmxEditor.instances[this.id]=null;d(this.wrapper).before(this.element);d(this.wrapper).remove();this.element.wasVisible&&d(this.element).show();d(this.element).trigger("editor:removed")};this.getKeyMap=function(){return KEY_MAP};this.getPathToStyles=function(){var a="/styles",b=d('link[href*="dmxEditor.css"]');0<b.length&&(a=b[0].href.replace(/dmxEditor\.css$/i,""));return a};(function(a){function b(){h.designview={};h.designview.element=
h.frame;h.designview.window=h.getWindow();h.designview.document=h.getDocument();h.designview.body=h.getBody();h.setLocale(h.options.locale);h.initSelection();h.initCommands();h.initControls();h.initKeys();h.createToolbars();c();h.idleDetector=new ib(h,h.options.idleTolerance);h.extensions={};h.options.extensions?h.loadExtension(h.options.extensions,function(){h.reloadAllToolbars();k(a);h.ready=!0;e("editor:ready",h)}):(k(a),h.reloadAllToolbars(),h.ready=!0,e("editor:ready",h))}function f(){h.importStyles()}
function k(a){a=a||(d(h.element).is(":input")?d(h.element).val():d(h.element).html())||"<p>\u200b</p>";h.setHTML(a);d(h.frame).show();B=!1;h.getWindow();e("editor:load");l=h.getHTML();0<h.options.autoSaveInterval&&(a=parseFloat(h.options.autoSaveInterval),!isNaN(a)&&0<a&&(a=Math.max(Math.round(6E4*a),50),m=setInterval(function(){h&&h.execute("save")},a)));h.history.saveUndoPoint(l,"Initial state");h.getBody();d(h.frame).blur();h.options.focusOnLoad&&d(h.getBody()).trigger("focus")}h.setSkin(h.options.skin);
h.setIconSet(h.options.iconSet);var g=h.config(),n="";if(h.options.autoIncludeCss){var N=document.styleSheets;if(N)for(var u=0;u<N.length;u++){var A=N[u].href;if(!A||A&&-1==A.search(/(\/styles\/dmxEditor\.css|\/ScriptLibrary\/dmxEditor\/|\/styles\/dmxEditor\/)/i))try{for(var C=N[u].rules?N[u].rules:N[u].cssRules,A=0;A<C.length;A++)try{var t=C[A].selectorText;t&&(/^\.(dmx|firebug)/.test(t)||(n+=t+" {"+C[A].style.cssText+"}\n"))}catch(v){}}catch(G){}}}N=""!=h.options.includeCss?'    <link rel="stylesheet" type="text/css" href="'+
h.options.includeCss+'" />':"";u=h.frame.contentDocument||h.frame.contentWindow.document;u.open();u.write('<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"  xmlns:dmx="http://www.dmxzone.com/namespace/dmx">  <head>    <meta http-equiv="Content-Type" content="text/html; charset='+document.characterSet+'" />    <meta name="format-detection" content="telephone=no" />    <title>DMXEditor Design View</title>    <link rel="stylesheet" type="text/css" href="'+
h.getPathToStyles()+'dmxEditor/designtime.css" />'+N+"    <style>\n"+n+"body {"+(g.bodyStyle?g.bodyStyle.replace("##bgcolor##",g.bgColor).replace("##textcolor##",g.textColor):"")+"}\n "+(qa?"body {overflow-y:scroll;-webkit-overflow-scrolling:touch;-webkit-touch-callout:none;-webkit-tap-highlight-color: rgba(0,0,0,0);}\n":"")+'    </style>  </head>  <body spellcheck="false" contenteditable="true" onload="window.editorLoaded = true;"></body></html>');u.close();h.getWindow().editorLoaded?f():d(h.getWindow()).load(f);
(function(){function a(){h.getDocument()&&h.getBody()&&h.getWindow()?b():s=setTimeout(a,10)}a()})()})(this.options.content)};d.dmxEditor.replaceElement=function(a,b){var c=d(a);if(!c.data("dmxEditor")){a.wasVisible=c.is(":visible");b=d.extend(!0,{},d.dmxEditor.Defaults,b);var e=b.width,f=b.height,g=d('<div class="dmx-editor-wrapper"></div>'),k=d('<div class="dmx-editor-toolbars"></div>'),h=d('<iframe frameborder="0"></iframe>'),l=d('<div class="dmx-editor-frame-wrapper"></div>'),n=d('<div class="dmx-editor-frame-wrapper-inner"></div>'),
m=(c.is(":input")?c.val():c.html())||"<p>\u200b</p>";c.is("body")?(c.html(g),g=c.find("> .dmx-editor-wrapper")):(c.wrap(g),g=c.parent(),c.hide());g.prepend(k);l.insertAfter(k);n.append(h);l.append(n);V&&g.addClass("ie").mousemove(function(a){a.target.unselectable||a.target.nodeName in eb||"IFRAME"==a.target.nodeName||d(a.target).attr("unselectable","on")});k=h.width()-h.outerWidth();l=h.height()-h.outerHeight();g.css({width:"string"==typeof e?e:e+k,height:"string"==typeof f?f:f+l});d.data(h[0],"origSize",
{width:e,height:f});g.data("origSize",{width:e,height:f});var s=new d.dmxEditor(d.extend(!0,{frame:h[0],content:m,element:a},b));c.bind("focus",function(a){s.focus()});g.removeClass(function(a,b){for(var c=b.split(" "),e=[],d=0;d<c.length;d++)/^dmx-editor-iconset-/.test(c[d])&&e.push(c[d]);return e.join(" ")});"default"!=b.iconSet&&(g.addClass("dmx-editor-iconset-"+b.iconSet),require([d.dmxEditor.basePath+"css.js!"+s.getIconPath(b.iconSet+".css")],function(){s.resizeUI()}));(b.fullscreen||c.is("body"))&&
s.getCommand("togglefulscreen").execute();a.form&&d(a.form).bind("submit",function(){s.save()})}};d.dmxEditor.Command=d.dmxEditor.Command||{};d.dmxEditor.basePath=v.getBasePath();d.dmxEditor.ui=d.dmxEditor.ui||{};var Sa=1;d(document.documentElement).bind("hidemenus.menuhider",da).bind("contextmenu popupmenu",function(a,b){"popupmenu"==a.type&&a.stopPropagation();var c=a.target;if("contextmenu"==a.type){if(!d.isFunction(c.getContextMenuData)&&!d.isFunction(c.getContextMenuHTML))return!0}else if(!d.isFunction(c.getMenuData)&&
!d.isFunction(c.getMenuHTML))return!0;var e=d(c);b&&d(c).addClass("active");e.bind("click.menuhidertmp",function(a){da(e);a.preventDefault();a.stopImmediatePropagation()});var f="contextmenu"==a.type?d.isFunction(c.getContextMenuHTML)?c.getContextMenuHTML:c.getContextMenuData:d.isFunction(c.getMenuHTML)?c.getMenuHTML:c.getMenuData,g="contextmenu"==a.type?a.target.contextMenuId:a.target.menuId;g||("contextmenu_"==a.type?(g="contextmenu_"+Sa++,a.target.contextMenuId=g):(g="menu_"+Sa++,a.target.menuId=
g));var k=d("#"+g);0===k.length&&(d.dmxEditor.ui.createMenu({offsetElement:c,data:"Hello",onHide:function(a){console.log("HIDE?")}}),k=d('<div class="dmx-menu" title="" tabindex="0" />').attr("id",g).bind("contextmenu selectstart",function(a){if(!/^(input|select|button)$/i.test(a.target.nodeName))return!1}).bind("mousedown focus click",Ga).appendTo("body"));k.css({width:"auto",visibility:"hidden"}).empty().show();c=f();"string"==typeof c||c.jquery?k.append(c):c&&"object"==typeof c&&Za(f(),k);$a(k);
if("contextmenu"==a.type)f=e.offset(),k.css({left:a.clientX-f.left,top:a.clientY-f.top});else{var h=e.attr("menuPositionX")||(e.is(".dmx-menu-item")?"left-right":"left-left"),l=e.attr("menuPositionY")||(e.is(".dmx-menu-item")?"top-top":"top-bottom"),f=e.offset();k.css({left:f.left,top:f.top+e.height()})}b&&k.css({marginLeft:"left-right"==h?1:-1,marginTop:"top-top"==l?-1:1}).addClass("root");k.css({visibility:""});k.bind("keydown",function(a){var b=[],c=null,e=-1,e=null;a.stopImmediatePropagation();
switch(a.keyCode){case 27:Ja(k[0]);da(k.parent());break;case 39:d(a.target).trigger("popupmenu").find(".dmx-menu").trigger("focus");break;case 37:if(d(a.target).is(".dmx-menu-item")){if(0<d(".dmx-menu:visible",a.target).length){da(k);break}}else d(a.target).is(".dmx-menu")&&(Ja(k[0]),da(k.parent()));break;case 40:e=d(a.target).is(".dmx-menu")?d(a.target).find("> .menu-items-wrapper")[0]:d(a.target).parents(".menu-items-wrapper:first")[0];b=d("> .dmx-menu-item",e).not(".separator").not(".disabled").not(".group-label");
0<b.length&&(c=b[0],"activeItem"in e&&(e=b.index(e.activeItem),c=++e>=b.length?b[0]:b[e]));c&&c.focus();break;case 38:e=d(a.target).is(".dmx-menu")?d(a.target).find("> .menu-items-wrapper")[0]:d(a.target).parents(".menu-items-wrapper:first")[0];b=d("> .dmx-menu-item",e).not(".separator").not(".disabled").not(".group-label");0<b.length&&(c=b[0],"activeItem"in e&&(e=b.index(e.activeItem),c=0>--e?b[b.length-1]:b[e]));c&&c.focus();break;case 13:d(a.target).is(".dmx-menu-item")&&d(a.target).trigger("mousedown")}});
b&&k.trigger("focus");e.trigger("menuload");return!1});DMXMenu=function(a){this.editor=a;this.wrapper=d('<div class="dmx-menu"></div>');d.data(this.wrapper,"DMXMenu",this);V&&this.wrapper.addClass("ie").attr("unselectable","on")};DMXMenu.prototype={addItem:function(a,b){this.wrapper.is(":empty")&&this.wrapper.append('<ul class="menu-items-wrapper"/>');d("> .menu-items-wrapper",this.wrapper)[b?"prepend":"append"](a.wrapper);a.editor=this.editor;return a},addSubMenu:function(a,b){return this.addItem(new F({label:a,
editor:this.editor}),b)},addControl:function(a,b){var c=this.editor.getControl(a);c.editor=this.editor;if(c instanceof Aa){for(var e=P(c.settings.values,c),d=this.addItem(new F(c),b),g=0,k=e.length;g<k;g++)(function(a){"string"==typeof a?"-"==a?d.addSeparator():d.addItem(new F({label:a,editor:c.editor,execute:function(){c.command.execute(a)}})):d.addItem(new F({label:a.label,editor:c.editor,execute:function(){c.command.execute(a.value)}}))})(e[g]);return d}return c instanceof fa?this.addItem(new va(c),
b):this.addItem(new F(c),b)},addSeparator:function(a){return this.addItem(new La,a)},isEmpty:function(){return this.wrapper.is(":empty")},empty:function(){this.wrapper.empty();return this},showAt:function(a,b){Ka(this.wrapper);this.wrapper.find("li.separator + li.separator").remove();this.wrapper.find("li.separator:first-child, li.separator:last-child").remove();this.wrapper.show().stickTo(d("body"),{stickY:b,stickX:a});document.addEventListener&&document.addEventListener("mousedown",wa,!0);return this},
init:function(){return this},loadDialog:function(a,b,c,e){b=new S("contextmenu",c,{container:this.wrapper,parent:this.wrapper.parent(),cache:!0,position:"none",onClose:function(){this.dialog.closest(".dmx-menu").hide()},onShow:b,onSuccess:function(){e.execute(this.value||this.data);d.dmxEditor.ui.hideMenus()}});e.options.command&&(c=e.options.command.queryValue(),d.isPlainObject(c)?b.data=c:b.value=c);b.open(a)}};F.prototype={init:function(){var a=this,b=this.options,c=d("> .dmx-menu-item-left",this.wrapper),
e=d("> .dmx-menu-item-label",this.wrapper),f=d("> .dmx-menu-item-right",this.wrapper);e.text(this.editor.translate(P(b.label||b.settings&&b.settings.tooltip||b.id||"Unknown",b)));this.execute=function(a){b.execute?b.execute(a):b.command&&b.command.execute?b.command.execute(a):b.settings&&b.settings.execute&&b.settings.execute(a)};if(b.command){var g=b.command.queryEnabled();this.wrapper.setEnabled(g);g&&b.command.queryState()&&this.wrapper.addClass("checked")}if(icon=v.resolveValue("settings.icon",
b))g='<div class="dmx-editor-icon',g=-1!=icon.indexOf("://")?g+('" style="background-image:url(\''+icon+"');\" />"):g+(" dmx-editor-icon-"+icon+'" />'),c.append(g);ua(b,"settings.url")&&(f.addClass("has-children"),e.css("paddingRight",f.outerWidth()+26));this.wrapper.bind({mouseenter:function(a){a.stopPropagation();if(!d(this).hasClass("disabled")){if(F.activeItem&&F.activeItem===this)return!1;d(this).trigger("myfocus")}},mouseleave:function(a){a.target===this&&this.openTimeout&&window.clearTimeout(this.openTimeout);
this.canceled=!0},myfocus:function(c){function e(){if(!f.canceled){F.activeItem=f;var c=a.wrapper.find("> .dmx-menu");0!=c.length&&(c.show().stickTo(a.wrapper,{stickY:"top-top",stickX:"left-right"}),Ka(c));d.isFunction(b.onload)&&b.onload.call(a.menu)}}c.stopPropagation();F.activeItem&&F.activeItem!==this&&d(F.activeItem).trigger("blur");var f=this;this.canceled=!1;this.openTimeout=window.setTimeout(function(){d(a.wrapper).siblings().find(".dmx-menu").hide();ua(b,"settings.url")?(a.menu||(a.menu=
new DMXMenu,a.menu.wrapper.hide().appendTo(a.wrapper)),a.menu.loadDialog(b.settings.url,e,b.editor,a)):e()},400)},mousedown:function(c,e){c.stopPropagation();d(this).is(".disabled")||ua(b,"settings.url")||d(this).is(".has-children")||0!=d(".dmx-menu",this).length||(a.execute(),d(this).trigger("hidemenus"))}})},addItem:function(a,b){var c=d("> .dmx-menu-item-label",this.wrapper),e=d("> .dmx-menu-item-right",this.wrapper);e.addClass("has-children");c.css("paddingRight",e.outerWidth()+26);this.menu||
(this.menu=new DMXMenu(this.editor),this.menu.wrapper.hide().appendTo(this.wrapper));return this.menu.addItem(a,b)},addControl:function(a,b){var c=d("> .dmx-menu-item-label",this.wrapper),e=d("> .dmx-menu-item-right",this.wrapper);e.addClass("has-children");c.css("paddingRight",e.outerWidth()+26);this.menu||(this.menu=new DMXMenu(this.editor),this.menu.wrapper.hide().appendTo(this.wrapper));return this.menu.addControl(a,b)},addSeparator:function(a){this.menu||(this.menu=new DMXMenu(this.editor),this.menu.wrapper.hide().appendTo(this.wrapper));
return this.menu.addSeparator(a)}};va.prototype={init:function(){F.prototype.init.apply(this,arguments)}};d.DMXMenu=DMXMenu;d.DMXMenuItem=F;d.DMXDialogMenuItem=va;d.DMXMenuSeparator=La;(function(a){a.combo=function(b){var c=a.extend(!0,{options:[],index:-1,defaultIcon:"",charSize:0,editText:"",iconic:!0,title:"",attr:{}},b),e=a('<span class="combo"/>').attr(c.attr);e.toggleClass("iconic",c.iconic);c.defaultIcon&&e.css({backgroundImage:"url('"+c.defaultIcon+"')",backgroundRepeat:"no-repeat",backgroundPosition:"3px center"});
b=a('<input type="text" spellcheck="false" />');c.charSize&&b.attr("size",c.charSize);c.editText&&b.val(c.editText);b[0].editText=c.editText;b.bind("keypress",function(b){if(!a(this).is(".disabled")){var c=this.value;d.isFunction(this.getValue)&&(c=this.getValue());void 0!==c?d(this).trigger("dmxcommand",d.makeArray(c)):d(this).trigger("dmxcommand")}b.keyCode&&13==b.keyCode&&b.stopPropagation()});a('<div class="disable-mask"/>').appendTo(e);var f=a("<span/>");c.title&&(f.attr("title",c.title),e.bind("commandupdate",
function(a,b){f.attr("title",K.translate(b.title||c.title,b.editor.options.locale))}));var g=a('<span class="btn"/>');g.click(function(a){e.trigger("popupmenu",!0);return!1});f.append(b);f.append(g);e.append(f);return e};a.fn.setEnabled=function(b){return this.each(function(c,e){b?a(this).clearClass("disabled").removeAttr("disabled"):a(this).addClass("disabled").attr("disabled","disabled");e.disabled=!b})};a.fn.setChecked=function(b){return this.each(function(c,e){b?a(this).addClass("checked").attr("checked",
"checked"):a(this).clearClass("checked").removeAttr("checked");e.checked=b})};a.fn.clearClass=function(b){return this.each(function(){this.className==b?a(this).removeAttr("class"):a(this).removeClass(b)})};a.fn.numCss=function(a,c){var e=parseFloat(this.css(a));return isNaN(e)?c||0:e};a.fn.stickTo=function(b,c,e){var d=a.extend({stickY:"top-bottom",stickX:"left-left"},c),g=a(b),k=g.offset(),h="static"!=g.css("position");return this.each(function(b,c){var m={top:"auto",left:"auto",bottom:"auto",right:"auto"};
switch(d.stickX){case "left-left":m.left=h?0:k.left;break;case "left-right":m.left=h?"100%":k.left+g.outerWidth();break;case "left-center":m.left=h?"50%":k.left+g.outerWidth()/2;break;case "left-pointer":m.left=h?e.clientX-k.left:e.clientX;break;default:"number"==typeof d.stickX&&(m.left=h?d.stickX-k.left:d.stickX)}switch(d.stickY){case "top-top":m.top=h?0:k.top;break;case "top-bottom":m.top=h?"100%":k.top+g.outerHeight();break;case "top-center":m.top=h?"50%":k.top+g.outerHeight()/2;break;case "top-pointer":m.top=
h?e.clientY-k.top:e.clientY;break;default:"number"==typeof d.stickY&&(m.top=h?d.stickY-k.top:d.stickY)}a(this).css(m);var s=a(this).offset(),B=a(this).width(),u=a(this).height(),w=a(window).scrollTop();a(window).scrollLeft();if(s.left+B+20>a(window).width()){switch(d.stickX){case "left-right":h?(m.left="auto",m.right="100%"):(m.left=s.left-B,m.right="auto");break;case "left-left":h?(m.left="auto",m.right=0):(m.left=s.left+(g.outerWidth()-B),m.right="auto");break;default:"number"==typeof d.stickX&&
(m.left=s.left-B,m.right="auto")}a(this).css(m)}if(s.top-w+u+20>a(window).height()){switch(d.stickY){case "top-top":h?(m.top="auto",m.bottom=-4):(m.top=s.top-u+(w+4),m.bottom="auto",m.marginTop="auto");break;default:"number"==typeof d.stickY&&(m.top=s.top-u,m.bottom="auto",m.marginTop="auto")}a(this).css(m)}s=a(this).offset();s.top<w+10&&a(this).css({top:w-k.top+10,bottom:"auto",marginTop:"auto"});s=a(this).offset();0>s.left&&a(this).css({left:-k.left,right:"auto"})})};a.fn.bindKey=function(b,c,e){return this.each(function(d,
g){a(this).attr("tabindex",a(this).attr("tabindex")||"0").bind(pa||X?"keypress.dmx":"keydown.dmx",function(d){var f=d.keyCode||d.charCode;String.fromCharCode(f);f===b&&(f=a.makeArray(e||[]),f.unshift(d),c.apply(this,f))})})};a.tabs=function(b,c){var e=a(b).find(".dmx-tab"),d=a(c).find(".dmx-tab-pannel");e.each(function(b,c){this.tabPannel=d.filter("."+a(this).attr("pannel"))[0];a(this).click(function(b){b=d.filter(".active");0<b.length&&b[0]!==this.tabPannel&&b.hide().removeClass("active").trigger("hide");
a(this.tabPannel).show().addClass("active").trigger("show");e.filter(".active").removeClass("active").trigger("tabdeactivate");a(this).addClass("active").trigger("tabactivate")})})};a.fn.unbindKey=function(){return this.unbind(pa||X?"keypress.dmx":"keydown.dmx")};a.fn.ajaxUpload=function(b){var c=this;require([a.dmxEditor.basePath+"dmxEditor/dialogs/jquery.fileupload.js"],function(){a(c).fileUpload(b);navigator.vendor&&-1!=navigator.vendor.indexOf("Apple")&&-1!=navigator.platform.indexOf("Win")&&
a(c).find("input:file").bind("click.dmxEditor",function(a){function b(a){a.preventDefault();a.stopPropagation();window.removeEventListener("mousedown",b,!0);return!1}window.addEventListener("mousedown",b,!0)})});return this}})(jQuery);(function(a){function b(){function a(){var c=b.hslToRgb(g.hue,g.sat,g.lum);g.r=c[0];g.g=c[1];g.b=c[2]}function e(){var a=b.rgbToHsl(g.r,g.g,g.b);g.hue=a[0];g.sat=a[1];g.lum=a[2]}function d(b,f){b in g&&g[b]!==f&&(g[b]=f,/^(r|g|b)$/.test(b)?e():/^(hue|sat|lum)$/.test(b)&&
a())}var g={hue:0,sat:.5,lum:.5,r:255,g:0,b:0,alpha:1,name:""};this.setAlpha=function(a){d("alpha",Math.max(Math.min(a,1),0));return this};this.setName=function(a){d("name",String(a));return this};this.setHue=function(a){d("hue",Math.max(Math.min(a,1),0));return this};this.setSaturation=function(a){d("sat",Math.max(Math.min(a,1),0));return this};this.setLuminance=function(a){d("lum",Math.max(Math.min(a,1),0));return this};this.setR=function(a){d("r",Math.max(Math.min(a,255),0));return this};this.setG=
function(a){d("g",Math.max(Math.min(a,255),0));return this};this.setB=function(a){d("b",Math.max(Math.min(a,255),0));return this};this.getAlpha=function(){return g.alpha};this.getName=function(){return g.name};this.getHue=function(){return g.hue};this.getSaturation=function(){return g.sat};this.getLuminance=function(){return g.lum};this.getR=function(){return g.r};this.getG=function(){return g.g};this.getB=function(){return g.b};this.getString=function(a){switch(a.toLowerCase()){case "hex":return b.rgbToHex(g.r,
g.g,g.b);case "rgb":return"rgb("+Math.round(g.r)+", "+Math.round(g.g)+", "+Math.round(g.b)+")";case "rgba":return"rgba("+Math.round(g.r)+", "+Math.round(g.g)+", "+Math.round(g.b)+", "+g.alpha+")";case "hsl":return"hsl("+Math.round(3600*g.hue)/10+", "+Math.round(1E3*g.sat)/10+"%, "+Math.round(1E3*g.lum)/10+"%)";case "hsla":return"hsla("+Math.round(3600*g.hue)/10+", "+Math.round(1E3*g.sat)/10+"%, "+Math.round(1E3*g.lum)/10+"%, "+g.alpha+")"}};this.setRGB=function(a,b,c){g.r=Math.max(Math.min(a,255),
0);g.g=Math.max(Math.min(b,255),0);g.b=Math.max(Math.min(c,255),0);e();return this};this.setHSL=function(b,e,d){g.hue=Math.max(Math.min(b,1),0);g.sat=Math.max(Math.min(e,1),0);g.lum=Math.max(Math.min(d,1),0);a();return this};this.setString=function(a){a=b.parse(a);this.setRGB(a.getR(),a.getG(),a.getB());return this}}b.rgbToHex=function(b,e,d){var g=[Math.round(b).toString(16),Math.round(e).toString(16),Math.round(d).toString(16)];a.each(g,function(a,b){1==b.length&&(g[a]="0"+b)});return"#"+g.join("")};
b.rgbToHsl=function(a,b,d){a/=255;b/=255;d/=255;var g=Math.max(a,b,d),k=Math.min(a,b,d),h,l=(g+k)/2;if(g==k)h=k=0;else{var n=g-k,k=.5<l?n/(2-g-k):n/(g+k);switch(g){case a:h=(b-d)/n+(b<d?6:0);break;case b:h=(d-a)/n+2;break;case d:h=(a-b)/n+4}h/=6}return[h,k,l]};b.hslToRgb=function(a,b,d){if(0===b)d=b=a=d;else{var g=function(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a},k=.5>d?d*(1+b):d+b-d*b,h=2*d-k;d=g(h,k,a+1/3);b=g(h,k,a);a=g(h,k,a-1/3)}return[255*d,255*
b,255*a]};b.parse=function(c){var e;if(c&&c.constructor==Array&&(3==c.length||4==c.length))return e=(new b).setRGB(c[0],c[1],c[2]),4==c.length&&e.setAlpha(c[3]),e;c=String(c);if(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return(new b).setRGB(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16));if(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return(new b).setRGB(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16));if(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return(new b).setRGB(parseInt(e[1],
10),parseInt(e[2],10),parseInt(e[3],10));if(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return(new b).setRGB(2.55*parseFloat(e[1]),2.55*parseFloat(e[2]),2.55*parseFloat(e[3]));if(e=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*(0|1|0?\.[0-9]+)\s*\)/.exec(c))return(new b).setRGB(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)).setAlpha(parseFloat(e[4]));if(e=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*(0|1|0?\.[0-9]+)\s*\)/.exec(c))return(new b).setRGB(2.55*
parseFloat(e[1]),2.55*parseFloat(e[2]),2.55*parseFloat(e[3])).setAlpha(parseFloat(e[4]));if(e=/hsl\(\s*([0-9]+(?:\.[0-9]+)?)\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return(new b).setHSL(parseFloat(e[1])/360,parseFloat(e[2])/100,parseFloat(e[3])/100);if(e=/hsla\(\s*([0-9]+(?:\.[0-9]+)?)\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*(0|1|0?\.[0-9]+)\s*\)/.exec(c))return(new b).setHSL(parseFloat(e[1])/360,parseFloat(e[2])/100,parseFloat(e[3])/100).setAlpha(parseFloat(e[4]));
c=a.trim(c).toLowerCase();return(e=b.namedColors[c])?(new b).setRGB(e[0],e[1],e[2]).setName(c):(new b).setRGB(0,0,0)};b.fromRGB=function(a,e,d){return(new b).setRGB(a,e,d)};b.fromHSL=function(a,e,d){return(new b).setHSL(a,e,d)};b.namedColors={black:[0,0,0],darkgreen:[0,100,0],navy:[0,0,128],darkred:[139,0,0],midnightblue:[25,25,112],mediumblue:[0,0,205],forestgreen:[34,139,34],saddlebrown:[139,69,19],darkolivegreen:[85,107,47],firebrick:[178,34,34],brown:[165,42,42],red:[255,0,0],teal:[0,128,128],
seagreen:[46,139,87],darkmagenta:[139,0,139],olivedrab:[107,142,35],sienna:[160,82,45],crimson:[220,20,60],limegreen:[50,205,50],dimgrey:[105,105,105],orangered:[255,69,0],darkgoldenrod:[184,134,11],chocolate:[210,105,30],mediumseagreen:[60,179,113],mediumvioletred:[199,21,133],darkviolet:[148,0,211],lawngreen:[124,252,0],steelblue:[70,130,180],springgreen:[0,255,127],slategrey:[112,128,144],indianred:[205,92,92],royalblue:[65,105,225],slateblue:[106,90,205],mediumspringgreen:[0,250,154],darkorchid:[153,
50,204],lightslategrey:[119,136,153],yellowgreen:[154,205,50],cadetblue:[95,158,160],goldenrod:[218,165,32],orange:[255,165,0],deeppink:[255,20,147],tomato:[255,99,71],dodgerblue:[30,144,255],deepskyblue:[0,191,255],coral:[255,127,80],mediumslateblue:[123,104,238],gold:[255,215,0],rosybrown:[188,143,143],greenyellow:[173,255,47],mediumaquamarine:[102,205,170],palevioletred:[219,112,147],darkkhaki:[189,183,107],mediumorchid:[186,85,211],mediumturquoise:[72,209,204],cornflowerblue:[100,149,237],salmon:[250,
128,114],turquoise:[64,224,208],sandybrown:[244,164,96],darksalmon:[233,150,122],darkgrey:[169,169,169],yellow:[255,255,0],lightgreen:[144,238,144],tan:[210,180,140],lightsalmon:[255,160,122],hotpink:[255,105,180],burlywood:[222,184,135],orchid:[218,112,214],palegreen:[152,251,152],skyblue:[135,206,235],lightskyblue:[135,206,250],lightsteelblue:[176,196,222],plum:[221,160,221],violet:[238,130,238],khaki:[240,230,140],lightblue:[173,216,230],thistle:[216,191,216],powderblue:[176,224,230],lightgrey:[211,
211,211],palegoldenrod:[238,232,170],wheat:[245,222,179],pink:[255,192,203],paleturquoise:[175,238,238],peachpuff:[255,218,185],gainsboro:[220,220,220],moccasin:[255,228,181],bisque:[255,228,196],blanchedalmond:[255,235,205],antiquewhite:[250,235,215],papayawhip:[255,239,213],mistyrose:[255,228,225],lightgoldenrodyellow:[250,250,210],linen:[250,240,230],cornsilk:[255,248,220],oldlace:[253,245,230],lightyellow:[255,255,224],whitesmoke:[245,245,245],seashell:[255,245,238],lavenderblush:[255,240,245],
aliceblue:[240,248,255],floralwhite:[255,250,240],mintcream:[245,255,250],ghostwhite:[248,248,255],snow:[255,250,250],white:[255,255,255]};a.dmxEditor.Color=b})(jQuery);(function(a){function b(b){var c=a('link[href$="dmxEditor\\.css"]'),c=c.length?c[0].href.replace(/dmxEditor\.css$/,"dmxEditor/"):"",e='<table cellpadding="0" cellspacing="0" border="0" class="dmx-color-picker" title="Double click or press Enter to select the color">  <tr>    <td>      <div class="spectrum">        <div class="spectrum-gradient"></div>        <div class="sat-gradient"></div>        <img class="color-pos" src="'+
c+'cross.gif" />      </div>    </td>    <td width="10">&nbsp;&nbsp;</td>    <td>      <div class="lum">        <div class="lum-gradient"></div>        <div class="lum-pos"></div>      </div>    </td>  </tr></table>';a(b).html(e);if(V||pa)a(".spectrum-gradient",b).replaceWith('<img class="spectrum-gradient" src="'+c+'spectrum.jpg" alt="Select Color" />'),a(".lum-gradient",b).replaceWith('<img class="lum-gradient" src="'+c+'lum.png" />')}function c(b){if(!d[b]){var c="",e="",l,n,m,s,B;if("grey"==b)for(l=
0;256>l;l++)s='<a style="background-color:rgb('+l+","+l+","+l+')"  class="c_'+l+"_"+l+"_"+l+'" UNSELECTABLE="on"></a>',c+=s;else if("web"==b)for(l=B=0;256>l;l+=51)for(n=0;256>n;n+=51)for(m=0;256>m;m+=51)0==B%18&&(s='<a style="background-color:rgb('+l+","+l+","+l+')"  class="c_'+l+"_"+l+"_"+l+'" UNSELECTABLE="on"></a>',128>n?c+=s:e+=s),s='<a style="background-color:rgb('+n+","+m+","+l+')"  class="c_'+n+"_"+m+"_"+l+'" UNSELECTABLE="on"></a>',128>n?c+=s:e+=s,B++;else if("named"==b)for(l in a.dmxEditor.Color.namedColors)c+=
'<a style="background-color:'+l+'" class="c_'+l+'" title="'+l+'" UNSELECTABLE="on"></a>';d[b]='<div class="colorTable" UNSELECTABLE="on">'+c+e+"</div>"}return d[b]}function e(b,e){var d=new a.dmxEditor.Color;a(b).empty().append(a(c(e)).bind("click mouseover",function(c){"A"==c.target.nodeName?(d=a.dmxEditor.Color.parse(c.target.style.backgroundColor),a(b).trigger("click"==c.type?"colorSelect":"colorPreview",[d])):a(b).find(".active").removeClass("active")}));b.setColor=function(b){d=a.dmxEditor.Color.parse(b);
a(".colorTable a.active",this).removeClass("active");a(".colorTable a.c_"+Math.round(d.getR())+"_"+Math.round(d.getG())+"_"+Math.round(d.getB()),this).addClass("active").trigger("mouseover");return this};b.getColor=function(){return d}}var d={};a.fn.dmxColorPicker=function(c){var d=a.extend({color:"",type:"web",base:""},c);return"rich"==d.type?this.each(function(c,e){function f(b,c){var e=Math.min(Math.max(b-C,0),H),d=Math.min(Math.max(c-t,0),A);w[0].style.top=d+"px";w[0].style.left=e+"px";G=e/H;
E=1-d/A;e=a.dmxEditor.Color.fromHSL(G,E,.5);z.css("backgroundColor",e.getString("rgb"));s()}function g(a){a=Math.min(Math.max(a-t,0),A);R[0].style.top=a+"px";x=1-a/A;s()}function s(){a(e).trigger("colorPreview",[a.dmxEditor.Color.fromHSL(G,E,x)])}function B(){H=q.width();A=q.height();v=q.offset();C=v.left;t=v.top;W=!0}b(e,d.base);var u=a(e),w=u.find(".color-pos"),q=u.find(".spectrum-gradient"),J=u.find(".sat-gradient"),T=u.find(".lum-gradient"),R=u.find(".lum-pos"),z=u.find(".lum"),N=a(document),
H=0,A=0,C=0,t=0,v={top:0,left:0},G=0,E=.5,x=.5,W=!1;J.unbind("keydown").attr("tabindex","0").bind("keydown",function(b){switch(b.keyCode||0){case 37:G>=1/360&&e.setColor(a.dmxEditor.Color.fromHSL(G-1/360,E,x));break;case 38:99.99>=E&&e.setColor(a.dmxEditor.Color.fromHSL(G,E+.01,x));break;case 39:G<=1-1/360&&e.setColor(a.dmxEditor.Color.fromHSL(G+1/360,E,x));break;case 40:0<E&&e.setColor(a.dmxEditor.Color.fromHSL(G,Math.max(E-.01,0),x));break;case 13:a(u).trigger("colorSelect",[a.dmxEditor.Color.fromHSL(G,
E,x)]);break;default:return!0}return!1});w.bind("dblclick",function(b){a(u).trigger("colorSelect",[a.dmxEditor.Color.fromHSL(G,E,x)])});T.unbind("keydown").attr("tabindex","0").bind("keydown",function(b){switch(b.keyCode||0){case 38:99.99>=x&&e.setColor(a.dmxEditor.Color.fromHSL(G,E,x+.01));break;case 40:0<x&&e.setColor(a.dmxEditor.Color.fromHSL(G,E,Math.max(x-.01,0)));break;case 13:a(u).trigger("colorSelect",[a.dmxEditor.Color.fromHSL(G,E,x)]);break;default:return!0}return!1});R.bind("dblclick",
function(b){a(u).trigger("colorSelect",[a.dmxEditor.Color.fromHSL(G,E,x)])});a(".dmx-color-picker",e).unbind("selectstart dragstart drag drop").bind("selectstart dragstart drag drop",function(a){return!1});a(e).bind("mousedown.colorpicker",function(b){W||B();if(b.target===q[0]||b.target===J[0]||b.target===w[0])f(b.pageX,b.pageY),N.bind("mousemove.colorpicker",function(a){f(a.pageX,a.pageY)}),b.target!==J[0]&&setTimeout(function(){J.trigger("focus")},10);else if(b.target===T[0]||b.target===R[0])g(b.pageY),
N.bind("mousemove.colorpicker",function(a){g(a.pageY)}),b.target!==T[0]&&setTimeout(function(){T.trigger("focus")},10);else return!0;N.one("mouseup.colorpicker",function(b){a(this).unbind("mousemove.colorpicker")})});e.setColor=function(b){b=b instanceof a.dmxEditor.Color?b:"string"==typeof b?a.dmxEditor.Color.parse(b):new a.dmxEditor.Color;G=b.getHue();E=b.getSaturation();x=b.getLuminance();B();w.css({left:H*G,top:A-A*E});R.css({top:A-A*x});b.setLuminance(.5);a(".lum",u).css("backgroundColor",b.getString("rgb"));
b.setLuminance(x);a(u).trigger("colorPreview",[b]);return this};e.getColor=function(b){var c=a.dmxEditor.Color.fromHSL(G,E,x);b&&(c=c.getString(b));return c};d.color&&q.is(":visible")&&e.setColor(d.color)}):this.each(function(a,b){e(b,d.type);d.color&&b.setColor(d.color)})}})(jQuery);(function(){function a(a,b){b=b||document;return b.querySelectorAll("["+a+"]")}function b(a,b){var c=a.attributes,e=c.length,d=[],f;if(c&&e)for(f=0;f<e;f++)b.test(c[f].name)&&d.push(c[f]);return d}function c(a,b){var c=
a.attributes,e=c.length,d;if(c&&e)for(d=0;d<e;d++)if(b.test(c[d].name))return!0;return!1}function e(a){return b(a,/^dmx\:/i)}function f(a){return c(a,/^dmx\:/i)}function g(a){d(a).bind("controlselect.lock",function(){return!1});a.contentEditable=!1}d.dmxEditor.getElementsByAttributeName=a;d.dmxEditor.getDmxAttributes=e;d.dmxEditor.hasDmxAttributes=f;d.dmxEditor.getAttributesByNameExpression=b;d.dmxEditor.hasAttributesByNameExpression=c;d.dmxEditor.nodeIsEditable=function(a,b){if(a){if(3==a.nodeType)return!0;
for(var c=a,e;c&&c.getAttribute;){if("HEAD"==a.nodeName||"HTML"==a.nodeName)return!1;if("BODY"==a.nodeName)return"content"==b;e=String(c.getAttribute("data-locked")).toLowerCase();if("true"==e||"false"==e)return"true"!=e;c=c.parentNode}return!0}return!1};d.dmxEditor.prototype.getElementsByAttributeName=function(b){return a(b,this.getBody())};d.dmxEditor.prototype.getDmxAttributes=function(a){return e(a,this.getBody())};d.dmxEditor.prototype.hasDmxAttributes=function(a){return f(a)};d.dmxEditor.prototype.getNodesWithDmxAttributes=
function(){for(var a=this.getBody().getElementsByTagName("*"),b=a.length,c=[];b--;)f(a[b])&&c.unshift(a[b]);return c};d.dmxEditor.prototype.getDmxNodes=function(){for(var a=this.getBody().getElementsByTagName("*"),b=a.length,c=[];b--;)"DMX:"==a[b].tagName.substr(0,4)&&c.unshift(a[b]);return c};d.dmxEditor.prototype.lockNode=function(a){g(a)};d.dmxEditor.prototype.unlockNode=function(a){a.contentEditable=!0;d(a).unbind("controlselect.lock")}})();y.prototype.refresh=function(){var a=this.rows=[],b=
this.element.getElementsByTagName("TBODY");if(0!==b.length){for(var b=b[0],c=[],b=b.firstChild;b;b=b.nextSibling)"TR"==b.nodeName&&c.push(b);for(var b=0,e;e=c[b];b++){var d=a[b];e=y.getChildCellElements(e);for(var g=0,k=0,h;h=e[k];k++){for(;d&&d.columns[g];)g++;h=new oa(h,b,g);for(var l=0;l<h.rowSpan;l++){var n=b+l,m=a[n];m||a.push(m=new cb(c[n],n));n=g+h.colSpan;m.columns.length<n&&(m.columns.length=n);for(n=0;n<h.colSpan;n++)m.columns[g+n]=h}g+=h.colSpan}}}};y.prototype.insertRow=function(a){a=
aa(a,this.rows.length);var b,c;0==a?(b=this.rows[0],c=!1):(b=this.rows[a-1],c=!0);for(var e=d("<tr/>")[0],f=0,g;g=b.columns[f];f+=1)c&&g.endRow>a||!c&&g.startRow<a?(g.setRowSpan(g.rowSpan+1),1<g.colSpan&&(f+=g.colSpan-1)):e.appendChild(this.createEmptyTd()),c?d(b.element).after(e):d(b.element).before(e);this.refresh();return e};y.prototype.insertColumn=function(a){a=aa(a,this.rows[0]&&this.rows[0].columns.length||0);for(var b=[],c=0,e;e=this.rows[c];c++)(e=e.columns[a])&&e.endCol>=a&&e.startCol<a?
(e.setColSpan(e.colSpan+1),c+=e.rowSpan-1):(e=this.createEmptyTd(),e.style.width=y.OPTIMUM_EMPTY_CELL_WIDTH+"px",this.insertCellElement(e,c,a),b.push(e));this.refresh();return b};y.prototype.removeRow=function(a){var b=this.rows[a];if(b){for(var c=0,e;e=b.columns[c];c+=e.colSpan)1<e.rowSpan&&(e.setRowSpan(e.rowSpan-1),e.startRow==a&&this.insertCellElement(e.element,a+1,e.startCol));b.element.parentNode.removeChild(b.element);this.refresh()}else I("Can't remove row at position "+a+": no such row.")};
y.prototype.removeColumn=function(a){for(var b=0,c;c=this.rows[b];b++){c=c.columns[a];if(!c){I("Can't remove cell at position "+b+", "+a+": no such cell.");return}1<c.colSpan?c.setColSpan(c.colSpan-1):c.element.parentNode.removeChild(c.element);b+=c.rowSpan-1}this.refresh()};y.prototype.mergeCells=function(a,b,c,e){var d=[],g;if(a==c&&b==e)return this.logger_.warning("Can't merge single cell"),!1;for(var k=a;k<=c;k++)for(var h=b;h<=e;h++){g=this.rows[k].columns[h];if(g.startRow<a||g.endRow>c||g.startCol<
b||g.endCol>e)return I("Can't merge cells: the cell in row "+k+", column "+h+"extends outside the supplied rectangle."),!1;d.push(g)}for(var h=d[0],l=h.element,n=document,k=1;g=d[k];k++)if(g=g.element,g.parentNode&&g!=l){l.lastChild&&l.lastChild.nodeType==goog.dom.NodeType.TEXT&&l.appendChild(n.createTextNode(" "));for(var m;m=g.firstChild;)l.appendChild(m);g.parentNode.removeChild(g)}h.setColSpan(e-b+1);h.setRowSpan(c-a+1);e>b&&(l.removeAttribute("width"),l.style.width=null);this.refresh();return!0};
y.prototype.splitCell=function(a,b){for(var c=this.rows[a].columns[b],e=[],d=0;d<c.rowSpan;d++)for(var g=0;g<c.colSpan;g++)if(0<d||0<g){var k=this.createEmptyTd();this.insertCellElement(k,a+d,b+g);e.push(k)}c.setColSpan(1);c.setRowSpan(1);this.refresh();return e};y.prototype.insertCellElement=function(a,b,c){for(var e=this.rows[b],d=null,g;g=e.columns[c];c+=g.colSpan)if(g.startRow==b){d=g.element;break}e.element.insertBefore(a,d)};y.prototype.createEmptyTd=function(){return d("<td>&nbsp;</td>")[0]};
y.OPTIMUM_EMPTY_CELL_WIDTH=60;y.OPTIMUM_MAX_NEW_TABLE_WIDTH=600;y.DEFAULT_BORDER_COLOR="#888";y.getChildCellElements=function(a){for(var b=[],c=0,e;e=a.childNodes[c];c++)"TD"!=e.nodeName&&"TH"!=e.nodeName||b.push(e);return b};y.formatTable=function(a,b,c){b=d.extend({borderCollapse:"collapse",borderColor:y.DEFAULT_BORDER_COLOR,borderWidth:1},b);c=d.extend({border:b.borderWidth,bordercolor:b.borderColor,cellspacing:0},c);d(a).css(b).attr(c);a.width||d("tr",a).each(function(a,b){var c=d("td, th",b),
k=c.length;if(0<k){var h=Math.max(10,Math.min(y.OPTIMUM_EMPTY_CELL_WIDTH,y.OPTIMUM_MAX_NEW_TABLE_WIDTH/k));c.each(function(a,b){d(b).css("width",h*aa(b.colspan,1))})}});return a};y.createDomTable=function(a){a=d.extend(!0,{rows:2,cols:2,width:null,widthExt:"",border:null,cellspacing:null,cellpadding:null,alignment:null,css:{}},a);for(var b={},c="<table>",e=0;e<a.rows;e++){for(var c=c+"<tr>",f=0;f<a.cols;f++)c+="<td>&nbsp;</td>";c+="</tr>"}c=d(c+"</table>");null!==a.width&&(b.width=a.width+""+(a.widthExt||
"")+'"');null!==a.border&&(b.border=a.border);null!==a.cellspacing&&(b.cellspacing=a.cellspacing);null!==a.cellpadding&&(b.cellpadding=a.cellpadding);null!==a.alignment&&(b.align=a.alignment);y.formatTable(c[0],a.css,b);return c[0]};oa.prototype.updateCoordinates_=function(){this.endCol=this.startCol+this.colSpan-1;this.endRow=this.startRow+this.rowSpan-1};oa.prototype.setColSpan=function(a){a!=this.colSpan&&(1<a?this.element.colSpan=a:(this.element.colSpan=1,this.element.removeAttribute("colSpan")),
this.colSpan=a,this.updateCoordinates_())};oa.prototype.setRowSpan=function(a){a!=this.rowSpan&&(1<a?this.element.rowSpan=a.toString():(this.element.rowSpan="1",this.element.removeAttribute("rowSpan")),this.rowSpan=a,this.updateCoordinates_())};var Y={Table:null,useTable:function(a){this.Table?this.Table.element!==a&&(this.Table.element=a,this.Table.refresh()):this.Table=new y(a)},deleteRow:function(a){this.Table.removeRow(a.sectionRowIndex)},deleteCol:function(a){this.Table.removeColumn(a.cellIndex)},
insertRowBefore:function(a){this.Table.insertRow(a.sectionRowIndex)},insertRowAfter:function(a){this.Table.insertRow(a.sectionRowIndex+1)},insertColBefore:function(a){this.Table.insertColumn(a.cellIndex)},insertColAfter:function(a){this.Table.insertColumn(a.cellIndex+1)},splitCell:function(a){this.Table.splitCell(a.parentNode.sectionRowIndex,a.cellIndex)}};d.dmxEditor.prototype.getTableEditor=function(){function a(){var a=d.getParentNode("TD",!0);a||(a=d.getParentNode("TH",!0));return a}function b(){return d.getParentNode("TR",
!0)}function c(){return!!a()}function e(){return!!b()}var d=this,g=this.getParentNode("TABLE",!0);g&&Y.useTable(g);return{canDeleteRow:e,canInsertRowBefore:e,canInsertRowAfter:e,canInsertColBefore:c,canInsertColAfter:c,canDeleteCol:c,canDeleteTable:function(){return!!g},canSplitCell:function(){var b=a();return b&&(1<aa(b.colSpan)||1<aa(b.rowSpan))?!0:!1},deleteTable:function(){g&&d.deleteNode(g)},deleteRow:function(){var a=b();a&&(Y.deleteRow(a),d.dispatch("documentedited"),d.focus())},insertRowBefore:function(){var a=
b();a&&(Y.insertRowBefore(a),d.dispatch("documentedited"),d.focus())},insertRowAfter:function(){var a=b();a&&(Y.insertRowAfter(a),d.dispatch("documentedited"),d.focus())},insertColBefore:function(){var b=a();b&&(Y.insertColBefore(b),d.dispatch("documentedited"),d.focus())},insertColAfter:function(){var b=a();b&&(Y.insertColAfter(b),d.dispatch("documentedited"),d.focus())},deleteCol:function(){var b=a();b&&(Y.deleteCol(b),d.dispatch("documentedited"),d.focus())},splitCell:function(){this.canSplitCell()&&
(Y.splitCell(a()),d.dispatch("documentedited"),d.focus())}}};d.dmxEditor.Defaults={width:600,height:300,iconSet:"default",locale:"auto",includeCss:"",autoIncludeCss:!1,noScript:!0,focusOnLoad:!1,lineBreak:"auto",allowUpload:!1,uploadPath:"",subFolder:"",uploadProcessor:"asp",allowResize:!1,resizeMaxWidth:600,resizeMaxHeight:300,allowLightbox:!1,lightboxPreset:"",idleTolerance:200,historyLimit:50,autoSaveInterval:0,formatterSettings:{eol:"\r\n",forceXHTML:!0,linkType:"rel",indent:{enabled:!0,indentChar:" ",
indentCount:4},alphaCase:{tags:"lower",attributeName:"auto",attributeValue:"auto",text:"auto",cdata:"auto"}},bodyStyle:"background-color: ##bgcolor##; color: ##textcolor##;",textColor:"",bgColor:"",toolbarsOrder:"History Text Format Lists Table Insert Search Font Style Code Common".split(" "),toolbars:{Common:{enabled:!0,visible:!0,items:v.makeMap(["viewsource","togglefullscreen"])},History:{enabled:!0,visible:!0,items:v.makeMap(["undo","redo"])},Text:{enabled:!0,visible:!0,items:v.makeMap("bold italic underline strikethrough subscript superscript -1 justifyleft justifycenter justifyfull justifyright -2 indent outdent -3 forecolor bgcolor".split(" "))},
Format:{enabled:!0,visible:!0,items:v.makeMap(["removeformat"])},Lists:{enabled:!0,visible:!0,items:v.makeMap(["insertunorderedlist","insertorderedlist"])},Table:{enabled:!0,visible:!0,items:v.makeMap("inserttable -1 editTable editTableCell -2 insertRowBefore insertRowAfter insertColBefore insertColAfter -3 deleteRow deleteCol deleteTable".split(" "))},Insert:{enabled:!0,visible:!0,items:v.makeMap("inserthorizontalrule -1 addlink deletelink -2 addaoreditimage insertspecialchar".split(" "))},Search:{enabled:!0,
visible:!0,items:v.makeMap(["find","replace"])},Font:{enabled:!0,visible:!0,items:v.makeMap(["fontname","fontsize","formatblock"])},Style:{enabled:!0,visible:!0,items:v.makeMap(["setClassName"])},Code:{enabled:!0,visible:!1,items:v.makeMap(["code_toggle_wrap","code_toggle_indent"])}},fonts:{"Sans Fonts":"Arial;Verdana;Geneva;Tahoma;Trebuchet MS;Comic Sans MS".split(";"),"Serif Fonts":["Times","Times New Roman","Georgia","Book Antiqua"],"Fixed Width Fonts":["monospace","Courier","Courier New","Lucida Console"]},
fontSizes:[{label:"8px",value:"8px",style:"font-size:8px;"},{label:"9px",value:"9px",style:"font-size:9px;"},{label:"10px",value:"10px",style:"font-size:10px;"},{label:"11px",value:"11px",style:"font-size:11px;"},{label:"12px",value:"12px",style:"font-size:12px;"},{label:"13px",value:"13px",style:"font-size:13px;"},{label:"14px",value:"14px",style:"font-size:14px;"},{label:"16px",value:"16px",style:"font-size:16px;"},{label:"18px",value:"18px",style:"font-size:18px;"},{label:"20px",value:"20px",style:"font-size:20px;"},
{label:"24px",value:"24px",style:"font-size:24px;"},{label:"28px",value:"28px",style:"font-size:28px;"},"-",{label:"No size",value:""}],formatBlocks:[{label:"Heading 1",value:"h1",style:"font-size:30px;font-weight:bold;"},{label:"Heading 2",value:"h2",style:"font-size:26px;font-weight:bold;"},{label:"Heading 3",value:"h3",style:"font-size:22px;font-weight:bold;"},{label:"Heading 4",value:"h4",style:"font-size:18px;font-weight:bold;"},{label:"Heading 5",value:"h5",style:"font-size:14px;font-weight:bold;"},
{label:"Heading 6",value:"h6",style:"font-size:10px;font-weight:bold;"},{label:"Preformatted",value:"pre",style:"font-family:monospace;"},{label:"Div",value:"div"},{label:"Address",value:"address",style:"font-style:italic;"},{label:"Blockquote",value:"blockquote"},{label:"Paragraph",value:"p",style:"line-height:3em;"}]};(function(a){a.extend(a.dmxEditor.prototype,{canInsertLockedRegion:function(){return this.selectionIsEditable()},canInsertEditableRegion:function(){return!this.selectionIsEditable()},
insertLockedRegion:function(a,c){if(this.canInsertLockedRegion()){var e=c||prompt("Enter the locked content","");if(e){var d=this.getDocument().createElement("DIV");d.setAttribute("data-locked","true");d.setAttribute("data-label",a);d.innerHTML=e||"\u00a0";this.stopModificationsMonitoring();this.insertNode(d);this.startModificationsMonitoring()}}},insertEditableRegion:function(a,c){if(this.canInsertEditableRegion()){var e=this.getDocument().createElement("DIV");e.setAttribute("data-locked","false");
e.setAttribute("data-label",a);e.innerHTML=c||"\u00a0";this.stopModificationsMonitoring();this.insertNode(e);this.startModificationsMonitoring()}}});a(function(){a("body").bind({"editor:nodeselectionchange":function(b,c,e){var d=a(b.target).data("dmxEditor");b=d.getDocument();1>a(c).closest("body").length||(d.stopModificationsMonitoring(),a("[data-locked]",b).removeClass("dmx-region").find(".outline-label").remove(),0<a(c).closest("body").length&&(c=a(c).closest("[data-locked]"),1===c.length&&(c.addClass("dmx-region"),
b=c.attr("data-label")))&&(b=a('<span class="outline-label">'+b+"</span>"),"static"==c.css("position")&&c.css("position","relative"),b.appendTo(c),b.bind({selectstart:!1,mousedown:function(a){a.stopPropagation();a.preventDefault();d.setSelectedNode(this.parentNode)}}),V&&c.css("height","auto")),d.startModificationsMonitoring())},"editor:beforeSave":function(a,c){c.html=c.html.replace(/\s*<span\s*class="outline-label">.*?<\/span>/gi,"")},"editor:beforeViewSource":function(a,c){c.source=c.source.replace(/\s*<span\s*class="outline-label">.*?<\/span>/gi,
"")}})})})(jQuery);window.rangy=function(){function a(a,b){var c=typeof a[b];return"function"==c||!("object"!=c||!a[b])||"unknown"==c}function b(a,b){return!("object"!=typeof a[b]||!a[b])}function c(a,b){return"undefined"!=typeof a[b]}function e(a){return function(b,c){for(var e=c.length;e--;)if(!a(b,c[e]))return!1;return!0}}function d(a){return a&&B(a,s)&&w(a,m)}function g(a){window.alert("Rangy not supported in your browser. Reason: "+a);q.initialized=!0;q.supported=!1}function k(){if(!q.initialized){var c,
e=!1,h=!1;a(document,"createRange")&&(c=document.createRange(),B(c,n)&&w(c,l)&&(e=!0),c.detach());(c=b(document,"body")?document.body:document.getElementsByTagName("body")[0])&&a(c,"createTextRange")&&(c=c.createTextRange(),d(c)&&(h=!0));e||h||g("Neither Range nor TextRange are implemented");q.initialized=!0;q.features={implementsDomRange:e,implementsTextRange:h};e=T.concat(J);h=0;for(c=e.length;h<c;++h)try{e[h](q)}catch(k){b(window,"console")&&a(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",
k)}}}function h(a){this.name=a;this.supported=this.initialized=!1}var l="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),n="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),m="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),
s="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),B=e(a),u=e(b),w=e(c),q={version:"1.2.3",initialized:!1,supported:!0,util:{isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:B,areHostObjects:u,areHostProperties:w,isTextRange:d},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};q.fail=g;q.warn=function(a){a="Rangy warning: "+a;q.config.alertOnWarn?window.alert(a):
"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(a)};({}).hasOwnProperty?q.util.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}:g("hasOwnProperty not supported");var J=[],T=[];q.init=k;q.addInitListener=function(a){q.initialized?a(q):J.push(a)};var R=[];q.addCreateMissingNativeApiListener=function(a){R.push(a)};q.createMissingNativeApi=function(a){a=a||window;k();for(var b=0,c=R.length;b<c;++b)R[b](a)};h.prototype.fail=function(a){this.initialized=
!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+a);};h.prototype.warn=function(a){q.warn("Module "+this.name+": "+a)};h.prototype.createError=function(a){return Error("Error in Rangy "+this.name+" module: "+a)};q.createModule=function(a,b){var c=new h(a);q.modules[a]=c;T.push(function(a){b(a,c);c.initialized=!0;c.supported=!0})};q.requireModules=function(a){for(var b=0,c=a.length,e,d;b<c;++b){d=a[b];e=q.modules[d];if(!(e&&e instanceof h))throw Error("Module '"+d+"' not found");
if(!e.supported)throw Error("Module '"+d+"' not supported");}};var z=!1,u=function(a){z||(z=!0,q.initialized||k())};if("undefined"==typeof window)g("No window found");else if("undefined"==typeof document)g("No document found");else return a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",u,!1),a(window,"addEventListener")?window.addEventListener("load",u,!1):a(window,"attachEvent")?window.attachEvent("onload",u):g("Window does not have required addEventListener or attachEvent method"),
q}();rangy.createModule("DomUtil",function(a,b){function c(a){for(var b=0;a=a.previousSibling;)b++;return b}function e(a,b){var c=[],e;for(e=a;e;e=e.parentNode)c.push(e);for(e=b;e;e=e.parentNode)if(w(c,e))return e;return null}function d(a,b,c){for(c=c?a:a.parentNode;c;){a=c.parentNode;if(a===b)return c;c=a}return null}function g(a){a=a.nodeType;return 3==a||4==a||8==a}function k(a,b){var c=b.nextSibling,e=b.parentNode;c?e.insertBefore(a,c):e.appendChild(a);return a}function h(a){if(9==a.nodeType)return a;
if("undefined"!=typeof a.ownerDocument)return a.ownerDocument;if("undefined"!=typeof a.document)return a.document;if(a.parentNode)return h(a.parentNode);throw Error("getDocument: no document found for node");}function l(a){return a?g(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">["+a.childNodes.length+"]":a.nodeName:"[No node]"}function n(a){this._next=this.root=a}function m(a,b){this.node=a;this.offset=b}function s(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+
this.codeName}var B=a.util;B.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method");B.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var u=document.createElement("div");B.areHostMethods(u,["insertBefore","appendChild","cloneNode"])||b.fail("Incomplete Element implementation");B.isHostProperty(u,"innerHTML")||b.fail("Element is missing innerHTML property");u=document.createTextNode("test");
B.areHostMethods(u,["splitText","deleteData","insertData","appendData","cloneNode"])||b.fail("Incomplete Text Node implementation");var w=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1};n.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next,b;if(this._current){b=a.firstChild;if(!b)for(b=null;a!==this.root&&!(b=a.nextSibling);)a=a.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=
null}};m.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+l(this.node)+":"+this.offset+")]"}};s.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};s.prototype.toString=function(){return this.message};a.dom={arrayContains:w,isHtmlNamespace:function(a){var b;return"undefined"==typeof a.namespaceURI||null===(b=a.namespaceURI)||
"http://www.w3.org/1999/xhtml"==b},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:c,getNodeLength:function(a){var b;return g(a)?a.length:(b=a.childNodes)?b.length:0},getCommonAncestor:e,isAncestorOf:function(a,b,c){for(b=c?b:b.parentNode;b;){if(b===a)return!0;b=b.parentNode}return!1},getClosestAncestorIn:d,isCharacterDataNode:g,insertAfter:k,splitDataNode:function(a,b){var c=a.cloneNode(!1);c.deleteData(0,b);a.deleteData(b,a.length-b);k(c,a);return c},getDocument:h,
getWindow:function(a){a=h(a);if("undefined"!=typeof a.defaultView)return a.defaultView;if("undefined"!=typeof a.parentWindow)return a.parentWindow;throw Error("Cannot get a window object for node");},getIframeWindow:function(a){if("undefined"!=typeof a.contentWindow)return a.contentWindow;if("undefined"!=typeof a.contentDocument)return a.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element");},getIframeDocument:function(a){if("undefined"!=typeof a.contentDocument)return a.contentDocument;
if("undefined"!=typeof a.contentWindow)return a.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element");},getBody:function(a){return B.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},comparePoints:function(a,b,g,h){var k;if(a==g)return b===h?0:b<h?-1:1;if(k=d(g,a,!0))return b<=c(k)?-1:1;if(k=d(a,g,!0))return c(k)<h?-1:1;b=e(a,g);a=a===b?b:d(a,b,!0);g=g===b?b:d(g,b,!0);if(a===
g)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(b=b.firstChild;b;){if(b===a)return-1;if(b===g)return 1;b=b.nextSibling}throw Error("Should not be here!");},inspectNode:l,fragmentFromNodeChildren:function(a){for(var b=h(a).createDocumentFragment(),c;c=a.firstChild;)b.appendChild(c);return b},createIterator:function(a){return new n(a)},DomPosition:m};a.DOMException=s});rangy.createModule("DomRange",function(a,b){function c(a,b){return 3!=a.nodeType&&(p.isAncestorOf(a,
b.startContainer,!0)||p.isAncestorOf(a,b.endContainer,!0))}function e(a){return p.getDocument(a.startContainer)}function d(a,b,c){if(b=a._listeners[b])for(var e=0,f=b.length;e<f;++e)b[e].call(a,{target:a,args:c})}function g(a){return new I(a.parentNode,p.getNodeIndex(a))}function k(a){return new I(a.parentNode,p.getNodeIndex(a)+1)}function h(a,b,c){var e=11==a.nodeType?a.firstChild:a;p.isCharacterDataNode(b)?c==b.length?p.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:p.splitDataNode(b,c)):c>=
b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]);return e}function l(a){for(var b,c,d=e(a.range).createDocumentFragment();c=a.next();){b=a.isPartiallySelectedSubtree();c=c.cloneNode(!b);b&&(b=a.getSubtreeIterator(),c.appendChild(l(b)),b.detach(!0));if(10==c.nodeType)throw new L("HIERARCHY_REQUEST_ERR");d.appendChild(c)}return d}function n(a,b,c){var e,d;for(c=c||{stop:!1};e=a.next();)if(a.isPartiallySelectedSubtree())if(!1===b(e)){c.stop=!0;break}else{if(e=a.getSubtreeIterator(),
n(e,b,c),e.detach(!0),c.stop)break}else for(e=p.createIterator(e);d=e.next();)if(!1===b(d)){c.stop=!0;return}}function m(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),m(b),b.detach(!0)):a.remove()}function s(a){for(var b,c=e(a.range).createDocumentFragment(),d;b=a.next();){a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(s(d)),d.detach(!0)):a.remove();if(10==b.nodeType)throw new L("HIERARCHY_REQUEST_ERR");c.appendChild(b)}return c}
function B(a,b,c){var e=!(!b||!b.length),d,f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];n(new w(a,!1),function(a){e&&!d.test(a.nodeType)||f&&!c(a)||g.push(a)});return g}function u(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+p.inspectNode(a.startContainer)+":"+a.startOffset+", "+p.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function w(a,b){this.range=a;this.clonePartiallySelectedTextNodes=b;if(!a.collapsed){this.sc=a.startContainer;this.so=a.startOffset;this.ec=
a.endContainer;this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&p.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||p.isCharacterDataNode(this.sc)?p.getClosestAncestorIn(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||p.isCharacterDataNode(this.ec)?p.getClosestAncestorIn(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function q(a){this.code=this[a];this.codeName=a;this.message=
"RangeException: "+this.codeName}function J(a,b,c){this.nodes=B(a,b,c);this._next=this.nodes[0];this._position=0}function T(a){return function(b,c){for(var e,d=c?b:b.parentNode;d;){e=d.nodeType;if(p.arrayContains(a,e))return d;d=d.parentNode}return null}}function t(a,b){if(M(a,b))throw new q("INVALID_NODE_TYPE_ERR");}function z(a){if(!a.startContainer)throw new L("INVALID_STATE_ERR");}function v(a,b){if(!p.arrayContains(b,a.nodeType))throw new q("INVALID_NODE_TYPE_ERR");}function H(a,b){if(0>b||b>
(p.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new L("INDEX_SIZE_ERR");}function A(a,b){if(Ba(a,!0)!==Ba(b,!0))throw new L("WRONG_DOCUMENT_ERR");}function C(a){if(K(a,!0))throw new L("NO_MODIFICATION_ALLOWED_ERR");}function y(a,b){if(!a)throw new L(b);}function F(a){return!p.arrayContains(Ta,a.nodeType)&&!Ba(a,!0)}function G(a,b){return b<=(p.isCharacterDataNode(a)?a.length:a.childNodes.length)}function E(a){return!!a.startContainer&&!!a.endContainer&&!F(a.startContainer)&&!F(a.endContainer)&&
G(a.startContainer,a.startOffset)&&G(a.endContainer,a.endOffset)}function x(a){z(a);if(!E(a))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");}function W(){}function ia(a){a.START_TO_START=0;a.START_TO_END=1;a.END_TO_END=2;a.END_TO_START=3;a.NODE_BEFORE=0;a.NODE_AFTER=1;a.NODE_BEFORE_AND_AFTER=2;a.NODE_INSIDE=3}function ga(a){ia(a);ia(a.prototype)}function ja(a,b){return function(){x(this);var c=this.startContainer,e=this.startOffset,d=this.commonAncestorContainer,
f=new w(this,!0);c!==d&&(c=p.getClosestAncestorIn(c,d,!0),e=k(c),c=e.node,e=e.offset);n(f,C);f.reset();d=a(f);f.detach();b(this,c,e,c,e);return d}}function U(b,e,d){function f(a,b){return function(c){z(this);v(c,ra);v(ka(c),Ta);c=(a?g:k)(c);(b?h:n)(this,c.node,c.offset)}}function h(a,b,c){var d=a.endContainer,f=a.endOffset;if(b!==a.startContainer||c!==a.startOffset){if(ka(b)!=ka(d)||1==p.comparePoints(b,c,d,f))d=b,f=c;e(a,b,c,d,f)}}function n(a,b,c){var d=a.startContainer,f=a.startOffset;if(b!==a.endContainer||
c!==a.endOffset){if(ka(b)!=ka(d)||-1==p.comparePoints(b,c,d,f))d=b,f=c;e(a,d,f,b,c)}}b.prototype=new W;a.util.extend(b.prototype,{setStart:function(a,b){z(this);t(a,!0);H(a,b);h(this,a,b)},setEnd:function(a,b){z(this);t(a,!0);H(a,b);n(this,a,b)},setStartBefore:f(!0,!0),setStartAfter:f(!1,!0),setEndBefore:f(!0,!1),setEndAfter:f(!1,!1),collapse:function(a){x(this);a?e(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):e(this,this.endContainer,this.endOffset,this.endContainer,
this.endOffset)},selectNodeContents:function(a){z(this);t(a,!0);e(this,a,0,a,p.getNodeLength(a))},selectNode:function(a){z(this);t(a,!1);v(a,ra);var b=g(a);a=k(a);e(this,b.node,b.offset,a.node,a.offset)},extractContents:ja(s,e),deleteContents:ja(m,e),canSurroundContents:function(){x(this);C(this.startContainer);C(this.endContainer);var a=new w(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);a.detach();return!b},detach:function(){d(this)},splitBoundaries:function(){x(this);var a=this.startContainer,
b=this.startOffset,c=this.endContainer,d=this.endOffset,f=a===c;p.isCharacterDataNode(c)&&0<d&&d<c.length&&p.splitDataNode(c,d);p.isCharacterDataNode(a)&&0<b&&b<a.length&&(a=p.splitDataNode(a,b),f?(d-=b,c=a):c==a.parentNode&&d>=p.getNodeIndex(a)&&d++,b=0);e(this,a,b,c,d)},normalizeBoundaries:function(){x(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,d=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,d=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},
g=function(e){var f=e.previousSibling;if(f&&f.nodeType==e.nodeType){a=e;var g=e.length;b=f.length;e.insertData(0,f.data);f.parentNode.removeChild(f);a==c?(d+=b,c=a):c==e.parentNode&&(f=p.getNodeIndex(e),d==f?(c=e,d=g):d>f&&d--)}},h=!0;p.isCharacterDataNode(c)?c.length==d&&f(c):(0<d&&(h=c.childNodes[d-1])&&p.isCharacterDataNode(h)&&f(h),h=!this.collapsed);h?p.isCharacterDataNode(a)?0==b&&g(a):b<a.childNodes.length&&(f=a.childNodes[b])&&p.isCharacterDataNode(f)&&g(f):(a=c,b=d);e(this,a,b,c,d)},collapseToPoint:function(a,
b){z(this);t(a,!0);H(a,b);a===this.startContainer&&b===this.startOffset&&a===this.endContainer&&b===this.endOffset||e(this,a,b,a,b)}});ga(b)}function D(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=a.collapsed?a.startContainer:p.getCommonAncestor(a.startContainer,a.endContainer)}function $(a,b,c,e,g){var h=a.startContainer!==b||a.startOffset!==c,ra=a.endContainer!==e||a.endOffset!==g;a.startContainer=b;a.startOffset=c;a.endContainer=e;a.endOffset=
g;D(a);d(a,"boundarychange",{startMoved:h,endMoved:ra})}function O(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};D(this)}a.requireModules(["DomUtil"]);var p=a.dom,I=p.DomPosition,L=a.DOMException;w.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=
this._next;a&&(this._next=a!==this._last?a.nextSibling:null,p.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));return a},remove:function(){var a=this._current,b,c;!p.isCharacterDataNode(a)||a!==this.sc&&a!==this.ec?a.parentNode&&a.parentNode.removeChild(a):(b=a===this.sc?this.so:0,c=a===this.ec?this.eo:a.length,b!=c&&a.deleteData(b,c-b))},isPartiallySelectedSubtree:function(){return c(this._current,
this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new O(e(this.range));var b=this._current,c=b,d=0,f=b,g=p.getNodeLength(b);p.isAncestorOf(b,this.sc,!0)&&(c=this.sc,d=this.so);p.isAncestorOf(b,this.ec,!0)&&(f=this.ec,g=this.eo);$(a,c,d,f,g)}return new w(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=
null}};q.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};q.prototype.toString=function(){return this.message};J.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var ra=[1,3,4,5,7,8,10],Ta=[2,9,11],jb=[1,3,4,5,7,8,10,11],kb=[1,3,4,5,7,8],ka=p.getRootContainer,Ba=T([9,11]),K=T([5,6,10,12]),M=T([6,10,12]),Q=document.createElement("style"),
P=!1;try{Q.innerHTML="<b>x</b>",P=3==Q.firstChild.nodeType}catch(V){}a.features.htmlParsingConforms=P;var S="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" ");W.prototype={attachListener:function(a,b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){x(this);A(this.startContainer,b.startContainer);var c=3==a||0==a?"start":"end",e=1==a||0==a?"start":"end";return p.comparePoints(this[c+"Container"],this[c+"Offset"],b[e+"Container"],b[e+"Offset"])},
insertNode:function(a){x(this);v(a,jb);C(this.startContainer);if(p.isAncestorOf(a,this.startContainer,!0))throw new L("HIERARCHY_REQUEST_ERR");a=h(a,this.startContainer,this.startOffset);this.setStartBefore(a)},cloneContents:function(){x(this);var a,b;if(this.collapsed)return e(this).createDocumentFragment();if(this.startContainer===this.endContainer&&p.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=e(this).createDocumentFragment(),
b.appendChild(a),b;b=new w(this,!0);a=l(b);b.detach();return a},canSurroundContents:function(){x(this);C(this.startContainer);C(this.endContainer);var a=new w(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);a.detach();return!b},surroundContents:function(a){v(a,kb);if(!this.canSurroundContents())throw new q("BAD_BOUNDARYPOINTS_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);h(a,this.startContainer,this.startOffset);a.appendChild(b);
this.selectNode(a)},cloneRange:function(){x(this);for(var a=new O(e(this)),b=S.length,c;b--;)c=S[b],a[c]=this[c];return a},toString:function(){x(this);var a=this.startContainer;if(a===this.endContainer&&p.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],a=new w(this,!0);n(a,function(a){3!=a.nodeType&&4!=a.nodeType||b.push(a.data)});a.detach();return b.join("")},compareNode:function(a){x(this);var b=a.parentNode,c=p.getNodeIndex(a);
if(!b)throw new L("NOT_FOUND_ERR");a=this.comparePoint(b,c);b=this.comparePoint(b,c+1);return 0>a?0<b?2:0:0<b?1:3},comparePoint:function(a,b){x(this);y(a,"HIERARCHY_REQUEST_ERR");A(a,this.startContainer);return 0>p.comparePoints(a,b,this.startContainer,this.startOffset)?-1:0<p.comparePoints(a,b,this.endContainer,this.endOffset)?1:0},createContextualFragment:P?function(a){var b=this.startContainer,c=p.getDocument(b);if(!b)throw new L("INVALID_STATE_ERR");var e=null;1==b.nodeType?e=b:p.isCharacterDataNode(b)&&
(e=p.parentElement(b));e=null===e||"HTML"==e.nodeName&&p.isHtmlNamespace(p.getDocument(e).documentElement)&&p.isHtmlNamespace(e)?c.createElement("body"):e.cloneNode(!1);e.innerHTML=a;return p.fragmentFromNodeChildren(e)}:function(a){z(this);var b=e(this).createElement("body");b.innerHTML=a;return p.fragmentFromNodeChildren(b)},toHtml:function(){x(this);var a=e(this).createElement("div");a.appendChild(this.cloneContents());return a.innerHTML},intersectsNode:function(a,b){x(this);y(a,"NOT_FOUND_ERR");
if(p.getDocument(a)!==e(this))return!1;var c=a.parentNode,d=p.getNodeIndex(a);y(c,"NOT_FOUND_ERR");var f=p.comparePoints(c,d,this.endContainer,this.endOffset),c=p.comparePoints(c,d+1,this.startContainer,this.startOffset);return b?0>=f&&0<=c:0>f&&0<c},isPointInRange:function(a,b){x(this);y(a,"HIERARCHY_REQUEST_ERR");A(a,this.startContainer);return 0<=p.comparePoints(a,b,this.startContainer,this.startOffset)&&0>=p.comparePoints(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a,b){x(this);
if(e(a)!=e(this))throw new L("WRONG_DOCUMENT_ERR");var c=p.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),d=p.comparePoints(this.endContainer,this.endOffset,a.startContainer,a.startOffset);return b?0>=c&&0<=d:0>c&&0<d},intersection:function(a){if(this.intersectsRange(a)){var b=p.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=p.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),e=this.cloneRange();-1==b&&
e.setStart(a.startContainer,a.startOffset);1==c&&e.setEnd(a.endContainer,a.endOffset);return e}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();-1==p.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset);1==p.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset);return b}throw new q("Ranges do not intersect");},containsNode:function(a,
b){return b?this.intersectsNode(a,!1):3==this.compareNode(a)},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,p.getNodeLength(a))},containsRange:function(a){return this.intersection(a).equals(a)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);return 0<c.length?(b.setStart(c[0],0),a=c.pop(),b.setEnd(a,a.length),a=this.containsRange(b),b.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,b){x(this);
return new J(this,a,b)},getNodes:function(a,b){x(this);return B(this,a,b)},getDocument:function(){return e(this)},collapseBefore:function(a){z(this);this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){z(this);this.setStartAfter(a);this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return O.rangesEqual(this,a)},isValid:function(){return E(this)},inspect:function(){return u(this)}};U(O,$,function(a){z(a);a.startContainer=a.startOffset=a.endContainer=a.endOffset=
null;a.collapsed=a.commonAncestorContainer=null;d(a,"detach",null);a._listeners=null});a.rangePrototype=W.prototype;O.rangeProperties=S;O.RangeIterator=w;O.copyComparisonConstants=ga;O.createPrototypeRange=U;O.inspect=u;O.getRangeDocument=e;O.rangesEqual=function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset};a.DomRange=O;a.RangeException=q});rangy.createModule("WrappedRange",function(a,b){function c(a,b,
c,e){var d=a.duplicate();d.collapse(c);var f=d.parentElement();g.isAncestorOf(b,f,!0)||(f=b);if(!f.canHaveHTML)return new k(f.parentNode,g.getNodeIndex(f));b=g.getDocument(f).createElement("span");var h,l=c?"StartToStart":"StartToEnd";do f.insertBefore(b,b.previousSibling),d.moveToElementText(b);while(0<(h=d.compareEndPoints(l,a))&&b.previousSibling);l=b.nextSibling;if(-1==h&&l&&g.isCharacterDataNode(l)){d.setEndPoint(c?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(l.data))for(f=d.duplicate(),c=f.text.replace(/\r\n/g,
"\r").length,c=f.moveStart("character",c);-1==f.compareEndPoints("StartToEnd",f);)c++,f.moveStart("character",1);else c=d.text.length;f=new k(l,c)}else l=(e||!c)&&b.previousSibling,f=(c=(e||c)&&b.nextSibling)&&g.isCharacterDataNode(c)?new k(c,0):l&&g.isCharacterDataNode(l)?new k(l,l.length):new k(f,g.getNodeIndex(b));b.parentNode.removeChild(b);return f}function e(a,b){var c,e,d=a.offset,f=g.getDocument(a.node),h=f.body.createTextRange(),k=g.isCharacterDataNode(a.node);k?(c=a.node,e=c.parentNode):
(c=a.node.childNodes,c=d<c.length?c[d]:null,e=a.node);f=f.createElement("span");f.innerHTML="&#feff;";c?e.insertBefore(f,c):e.appendChild(f);h.moveToElementText(f);h.collapse(!b);e.removeChild(f);if(k)h[b?"moveStart":"moveEnd"]("character",d);return h}a.requireModules(["DomUtil","DomRange"]);var d,g=a.dom,k=g.DomPosition,h=a.DomRange;if(a.features.implementsDomRange&&(!a.features.implementsTextRange||!a.config.preferTextRange))(function(){function b(a){for(var c=e.length,d;c--;)d=e[c],a[d]=a.nativeRange[d]}
var c,e=h.rangeProperties,k;d=function(a){if(!a)throw Error("Range must be specified");this.nativeRange=a;b(this)};h.createPrototypeRange(d,function(a,b,c,e,d){var f=a.endContainer!==e||a.endOffset!=d;if(a.startContainer!==b||a.startOffset!=c||f)a.setEnd(e,d),a.setStart(b,c)},function(a){a.nativeRange.detach();a.detached=!0;for(var b=e.length,c;b--;)c=e[b],a[c]=null});c=d.prototype;c.selectNode=function(a){this.nativeRange.selectNode(a);b(this)};c.deleteContents=function(){this.nativeRange.deleteContents();
b(this)};c.extractContents=function(){var a=this.nativeRange.extractContents();b(this);return a};c.cloneContents=function(){return this.nativeRange.cloneContents()};c.surroundContents=function(a){this.nativeRange.surroundContents(a);b(this)};c.collapse=function(a){this.nativeRange.collapse(a);b(this)};c.cloneRange=function(){return new d(this.nativeRange.cloneRange())};c.refresh=function(){b(this)};c.toString=function(){return this.nativeRange.toString()};var l=document.createTextNode("test");g.getBody(document).appendChild(l);
var w=document.createRange();w.setStart(l,0);w.setEnd(l,0);try{w.setStart(l,1),c.setStart=function(a,c){this.nativeRange.setStart(a,c);b(this)},c.setEnd=function(a,c){this.nativeRange.setEnd(a,c);b(this)},k=function(a){return function(c){this.nativeRange[a](c);b(this)}}}catch(q){c.setStart=function(a,c){try{this.nativeRange.setStart(a,c)}catch(e){this.nativeRange.setEnd(a,c),this.nativeRange.setStart(a,c)}b(this)},c.setEnd=function(a,c){try{this.nativeRange.setEnd(a,c)}catch(e){this.nativeRange.setStart(a,
c),this.nativeRange.setEnd(a,c)}b(this)},k=function(a,c){return function(e){try{this.nativeRange[a](e)}catch(d){this.nativeRange[c](e),this.nativeRange[a](e)}b(this)}}}c.setStartBefore=k("setStartBefore","setEndBefore");c.setStartAfter=k("setStartAfter","setEndAfter");c.setEndBefore=k("setEndBefore","setStartBefore");c.setEndAfter=k("setEndAfter","setStartAfter");w.selectNodeContents(l);c.selectNodeContents=w.startContainer==l&&w.endContainer==l&&0==w.startOffset&&w.endOffset==l.length?function(a){this.nativeRange.selectNodeContents(a);
b(this)}:function(a){this.setStart(a,0);this.setEnd(a,h.getEndOffset(a))};w.selectNodeContents(l);w.setEnd(l,3);k=document.createRange();k.selectNodeContents(l);k.setEnd(l,4);k.setStart(l,2);-1==w.compareBoundaryPoints(w.START_TO_END,k)&1==w.compareBoundaryPoints(w.END_TO_START,k)?c.compareBoundaryPoints=function(a,b){b=b.nativeRange||b;a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,b)}:c.compareBoundaryPoints=function(a,b){return this.nativeRange.compareBoundaryPoints(a,
b.nativeRange||b)};a.util.isHostMethod(w,"createContextualFragment")&&(c.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});g.getBody(document).removeChild(l);w.detach();k.detach()})(),a.createNativeRange=function(a){a=a||document;return a.createRange()};else if(a.features.implementsTextRange){d=function(a){this.textRange=a;this.refresh()};d.prototype=new h(document);d.prototype.refresh=function(){var a,b,e=this.textRange;a=e.parentElement();var d=e.duplicate();
d.collapse(!0);b=d.parentElement();d=e.duplicate();d.collapse(!1);e=d.parentElement();b=b==e?b:g.getCommonAncestor(b,e);b=b==a?b:g.getCommonAncestor(a,b);a=this.textRange;0==a.compareEndPoints("StartToEnd",a)?b=a=c(this.textRange,b,!0,!0):(a=c(this.textRange,b,!0,!1),b=c(this.textRange,b,!1,!1));this.setStart(a.node,a.offset);this.setEnd(b.node,b.offset)};h.copyComparisonConstants(d);var l=function(){return this}();"undefined"==typeof l.Range&&(l.Range=d);a.createNativeRange=function(a){a=a||document;
return a.body.createTextRange()}}a.features.implementsTextRange&&(d.rangeToTextRange=function(a){if(a.collapsed)return e(new k(a.startContainer,a.startOffset),!0);var b=e(new k(a.startContainer,a.startOffset),!0),c=e(new k(a.endContainer,a.endOffset),!1);a=g.getDocument(a.startContainer).body.createTextRange();a.setEndPoint("StartToStart",b);a.setEndPoint("EndToEnd",c);return a});d.prototype.getName=function(){return"WrappedRange"};a.WrappedRange=d;a.createRange=function(b){b=b||document;return new d(a.createNativeRange(b))};
a.createRangyRange=function(a){a=a||document;return new h(a)};a.createIframeRange=function(b){return a.createRange(g.getIframeDocument(b))};a.createIframeRangyRange=function(b){return a.createRangyRange(g.getIframeDocument(b))};a.addCreateMissingNativeApiListener(function(b){b=b.document;"undefined"==typeof b.createRange&&(b.createRange=function(){return a.createRange(this)});b=b=null})});rangy.createModule("WrappedSelection",function(a,b){function c(a){return(a||window).getSelection()}function e(a){return(a||
window).document.selection}function d(a,b,c){var e=c?"end":"start";c=c?"start":"end";a.anchorNode=b[e+"Container"];a.anchorOffset=b[e+"Offset"];a.focusNode=b[c+"Container"];a.focusOffset=b[c+"Offset"]}function g(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function k(b){var c;b instanceof y?(c=b._selectionNativeRange,c||(c=a.createNativeRange(q.getDocument(b.startContainer)),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,
b.startOffset),b._selectionNativeRange=c,b.attachListener("detach",function(){this._selectionNativeRange=null}))):b instanceof R?c=b.nativeRange:a.features.implementsDomRange&&b instanceof q.getWindow(b.startContainer).Range&&(c=b);return c}function h(a){var b=a.getNodes(),c;a:if(b.length&&1==b[0].nodeType){c=1;for(var e=b.length;c<e;++c)if(!q.isAncestorOf(b[0],b[c])){c=!1;break a}c=!0}else c=!1;if(!c)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");
return b[0]}function l(a,b){var c=new R(b);a._ranges=[c];d(a,c,!1);a.rangeCount=1;a.isCollapsed=c.collapsed}function n(b){b._ranges.length=0;if("None"==b.docSelection.type)g(b);else{var c=b.docSelection.createRange();if(c&&"undefined"!=typeof c.text)l(b,c);else{b.rangeCount=c.length;for(var e,h=q.getDocument(c.item(0)),k=0;k<b.rangeCount;++k)e=a.createRange(h),e.selectNode(c.item(k)),b._ranges.push(e);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed;d(b,b._ranges[b.rangeCount-1],!1)}}}function m(a,
b){for(var c=a.docSelection.createRange(),e=h(b),d=q.getDocument(c.item(0)),d=q.getBody(d).createControlRange(),f=0,g=c.length;f<g;++f)d.add(c.item(f));try{d.add(e)}catch(k){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}d.select();n(a)}function s(a,b,c){this.nativeSelection=a;this.docSelection=b;this._ranges=[];this.win=c;this.refresh()}function t(a,b){for(var c=q.getDocument(b[0].startContainer),c=q.getBody(c).createControlRange(),
e=0,d;e<rangeCount;++e){d=h(b[e]);try{c.add(d)}catch(f){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");}}c.select();n(a)}function u(a,b){if(a.anchorNode&&q.getDocument(a.anchorNode)!==q.getDocument(b))throw new z("WRONG_DOCUMENT_ERR");}function w(a){var b=[],c=new N(a.anchorNode,a.anchorOffset),e=new N(a.focusNode,a.focusOffset),d="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=
0,g=a.rangeCount;f<g;++f)b[f]=y.inspect(a.getRangeAt(f));return"["+d+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+e.inspect()+"]"}a.requireModules(["DomUtil","DomRange","WrappedRange"]);a.config.checkSelectionRanges=!0;var q=a.dom,v=a.util,y=a.DomRange,R=a.WrappedRange,z=a.DOMException,N=q.DomPosition,H,A,C=a.util.isHostMethod(window,"getSelection"),F=a.util.isHostObject(document,"selection"),I=F&&(!C||a.config.preferTextRange);I?(H=e,a.isSelectionValid=function(a){a=(a||window).document;
var b=a.selection;return"None"!=b.type||q.getDocument(b.createRange().parentElement())==a}):C?(H=c,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected.");a.getNativeSelection=H;var C=H(),G=a.createNativeRange(document),E=q.getBody(document),x=v.areHostObjects(C,v.areHostProperties(C,["anchorOffset","focusOffset"]));a.features.selectionHasAnchorAndFocus=x;var W=v.isHostMethod(C,"extend");a.features.selectionHasExtend=W;var ia="number"==typeof C.rangeCount;
a.features.selectionHasRangeCount=ia;var ga=!1,ja=!0;v.areHostMethods(C,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof C.rangeCount&&a.features.implementsDomRange&&function(){var a=document.createElement("iframe");a.frameBorder=0;a.style.position="absolute";a.style.left="-10000px";E.appendChild(a);var b=q.getIframeDocument(a);b.open();b.write("<html><head></head><body>12</body></html>");b.close();var c=q.getIframeWindow(a).getSelection(),e=b.documentElement.lastChild.firstChild,b=
b.createRange();b.setStart(e,1);b.collapse(!0);c.addRange(b);ja=1==c.rangeCount;c.removeAllRanges();var d=b.cloneRange();b.setStart(e,0);d.setEnd(e,2);c.addRange(b);c.addRange(d);ga=2==c.rangeCount;b.detach();d.detach();E.removeChild(a)}();a.features.selectionSupportsMultipleRanges=ga;a.features.collapsedNonEditableSelectionsSupported=ja;var U=!1,D;E&&v.isHostMethod(E,"createControlRange")&&(D=E.createControlRange(),v.areHostProperties(D,["item","add"])&&(U=!0));a.features.implementsControlRange=
U;A=x?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var $;v.isHostMethod(C,"getRangeAt")?$=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:x&&($=function(b){var c=q.getDocument(b.anchorNode),c=a.createRange(c);c.setStart(b.anchorNode,b.anchorOffset);c.setEnd(b.focusNode,b.focusOffset);c.collapsed!==this.isCollapsed&&(c.setStart(b.focusNode,b.focusOffset),c.setEnd(b.anchorNode,
b.anchorOffset));return c});a.getSelection=function(a){a=a||window;var b=a._rangySelection,c=H(a),d=F?e(a):null;b?(b.nativeSelection=c,b.docSelection=d,b.refresh(a)):(b=new s(c,d,a),a._rangySelection=b);return b};a.getIframeSelection=function(b){return a.getSelection(q.getIframeWindow(b))};D=s.prototype;if(!I&&x&&v.areHostMethods(C,["removeAllRanges","addRange"])){D.removeAllRanges=function(){this.nativeSelection.removeAllRanges();g(this)};var O=function(b,c){var e=y.getRangeDocument(c),e=a.createRange(e);
e.collapseToPoint(c.endContainer,c.endOffset);b.nativeSelection.addRange(k(e));b.nativeSelection.extend(c.startContainer,c.startOffset);b.refresh()};D.addRange=ia?function(b,c){if(U&&F&&"Control"==this.docSelection.type)m(this,b);else if(c&&W)O(this,b);else{var e;ga?e=this.rangeCount:(this.removeAllRanges(),e=0);this.nativeSelection.addRange(k(b));this.rangeCount=this.nativeSelection.rangeCount;this.rangeCount==e+1?(a.config.checkSelectionRanges&&(e=$(this.nativeSelection,this.rangeCount-1))&&!y.rangesEqual(e,
b)&&(b=new R(e)),this._ranges[this.rangeCount-1]=b,d(this,b,L(this.nativeSelection)),this.isCollapsed=A(this)):this.refresh()}}:function(a,b){b&&W?O(this,a):(this.nativeSelection.addRange(k(a)),this.refresh())};D.setRanges=function(a){if(U&&1<a.length)t(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;b<c;++b)this.addRange(a[b])}}}else if(v.isHostMethod(C,"empty")&&v.isHostMethod(G,"select")&&U&&I)D.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;
if(this.anchorNode)a=q.getDocument(this.anchorNode);else if("Control"==this.docSelection.type){var b=this.docSelection.createRange();b.length&&(a=q.getDocument(b.item(0)).body.createTextRange())}a&&(a.body.createTextRange().select(),this.docSelection.empty())}}catch(c){}g(this)},D.addRange=function(a){"Control"==this.docSelection.type?m(this,a):(R.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,d(this,a,!1))},D.setRanges=function(a){this.removeAllRanges();
var b=a.length;1<b?t(this,a):b&&this.addRange(a[0])};else return b.fail("No means of selecting a Range or TextRange was found"),!1;D.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new z("INDEX_SIZE_ERR");return this._ranges[a]};var p;if(I)p=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=q.getBody(b.win.document).createTextRange(),c.collapse(!0));"Control"==b.docSelection.type?n(b):c&&"undefined"!=typeof c.text?l(b,c):g(b)};else if(v.isHostMethod(C,"getRangeAt")&&
"number"==typeof C.rangeCount)p=function(b){if(U&&F&&"Control"==b.docSelection.type)n(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,e=b.rangeCount;c<e;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));d(b,b._ranges[b.rangeCount-1],L(b.nativeSelection));b.isCollapsed=A(b)}else g(b)};else if(x&&"boolean"==typeof C.isCollapsed&&"boolean"==typeof G.collapsed&&a.features.implementsDomRange)p=function(a){var b;b=a.nativeSelection;b.anchorNode?
(b=$(b,0),a._ranges=[b],a.rangeCount=1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset,a.isCollapsed=A(a)):g(a)};else return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;D.refresh=function(a){var b=a?this._ranges.slice(0):null;p(this);if(a){a=b.length;if(a!=this._ranges.length)return!1;for(;a--;)if(!y.rangesEqual(b[a],this._ranges[a]))return!1;return!0}};var K=function(a,
b){var c=a.getAllRanges(),e=!1;a.removeAllRanges();for(var d=0,f=c.length;d<f;++d)e||b!==c[d]?a.addRange(c[d]):e=!0;a.rangeCount||g(a)};D.removeRange=U?function(a){if("Control"==this.docSelection.type){var b=this.docSelection.createRange();a=h(a);for(var c=q.getDocument(b.item(0)),c=q.getBody(c).createControlRange(),e,d=!1,f=0,g=b.length;f<g;++f)e=b.item(f),e!==a||d?c.add(b.item(f)):d=!0;c.select();n(this)}else K(this,a)}:function(a){K(this,a)};var L;!I&&x&&a.features.implementsDomRange?(L=function(a){var b=
!1;a.anchorNode&&(b=1==q.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset));return b},D.isBackwards=function(){return L(this)}):L=D.isBackwards=function(){return!1};D.toString=function(){for(var a=[],b=0,c=this.rangeCount;b<c;++b)a[b]=""+this._ranges[b];return a.join("")};D.collapse=function(b,c){u(this,b);var e=a.createRange(q.getDocument(b));e.collapseToPoint(b,c);this.removeAllRanges();this.addRange(e);this.isCollapsed=!0};D.collapseToStart=function(){if(this.rangeCount){var a=
this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new z("INVALID_STATE_ERR");};D.collapseToEnd=function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new z("INVALID_STATE_ERR");};D.selectAllChildren=function(b){u(this,b);var c=a.createRange(q.getDocument(b));c.selectNodeContents(b);this.removeAllRanges();this.addRange(c)};D.deleteFromDocument=function(){if(U&&F&&"Control"==this.docSelection.type){for(var a=this.docSelection.createRange(),
b;a.length;)b=a.item(0),a.remove(b),b.parentNode.removeChild(b);this.refresh()}else if(this.rangeCount){a=this.getAllRanges();this.removeAllRanges();b=0;for(var c=a.length;b<c;++b)a[b].deleteContents();this.addRange(a[c-1])}};D.getAllRanges=function(){return this._ranges.slice(0)};D.setSingleRange=function(a){this.setRanges([a])};D.containsNode=function(a,b){for(var c=0,e=this._ranges.length;c<e;++c)if(this._ranges[c].containsNode(a,b))return!0;return!1};D.toHtml=function(){var a="";if(this.rangeCount){for(var a=
y.getRangeDocument(this._ranges[0]).createElement("div"),b=0,c=this._ranges.length;b<c;++b)a.appendChild(this._ranges[b].cloneContents());a=a.innerHTML}return a};D.getName=function(){return"WrappedSelection"};D.inspect=function(){return w(this)};D.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};s.inspect=w;a.Selection=s;a.selectionPrototype=D;a.addCreateMissingNativeApiListener(function(b){"undefined"==typeof b.getSelection&&(b.getSelection=function(){return a.getSelection(this)});
b=null})});rangy.createModule("CssClassApplier",function(a,b){function c(a,b){return a.className&&(new RegExp("(?:^|\\s)"+b+"(?:\\s|$)")).test(a.className)}function e(a,b){a.className?c(a,b)||(a.className+=" "+b):a.className=b}function d(a){return a.split(/\s+/).sort().join(" ")}function g(a,b){return d(a.className)==d(b.className)}function k(a){for(var b=a.parentNode;a.hasChildNodes();)b.insertBefore(a.firstChild,a);b.removeChild(a)}function h(a,b){var c=a.cloneRange();c.selectNodeContents(b);var e=
c.intersection(a),e=e?e.toString():"";c.detach();return""!=e}function l(a){return a.getNodes([3],function(b){return h(a,b)})}function n(a,b){if(a.attributes.length!=b.attributes.length)return!1;for(var c=0,e=a.attributes.length,d,f;c<e;++c)if(d=a.attributes[c],f=d.name,"class"!=f&&(f=b.attributes.getNamedItem(f),d.specified!=f.specified||d.specified&&d.nodeValue!==f.nodeValue))return!1;return!0}function m(a,b){for(var c=0,e=a.attributes.length,d;c<e;++c)if(d=a.attributes[c].name,(!b||!z.arrayContains(b,
d))&&a.attributes[c].specified&&"class"!=d)return!0;return!1}function s(a){var b;return a&&1==a.nodeType&&((b=a.parentNode)&&9==b.nodeType&&"on"==b.designMode||A(a)&&!A(a.parentNode))}function t(a){return(A(a)||1!=a.nodeType&&A(a.parentNode))&&!s(a)}function u(a){return a&&1==a.nodeType&&!C.test(H(a,"display"))}function w(a){if(0==a.data.length)return!0;if(K.test(a.data))return!1;switch(H(a.parentNode,"whiteSpace")){case "pre":case "pre-wrap":case "-moz-pre-wrap":return!1;case "pre-line":if(/[\r\n]/.test(a.data))return!1}return u(a.previousSibling)||
u(a.nextSibling)}function q(a,c,e,d){var f,g=0==e;if(z.isAncestorOf(c,a))return a;if(z.isCharacterDataNode(c))if(0==e)e=z.getNodeIndex(c),c=c.parentNode;else if(e==c.length)e=z.getNodeIndex(c)+1,c=c.parentNode;else throw b.createError("splitNodeAt should not be called with offset in the middle of a data node ("+e+" in "+c.data);var h=c,k=e;if(z.isCharacterDataNode(h)?0==k?h.previousSibling:k==h.length?h.nextSibling:1:0<k&&k<h.childNodes.length){if(!f){f=c.cloneNode(!1);for(f.id&&f.removeAttribute("id");g=
c.childNodes[e];)f.appendChild(g);z.insertAfter(f,c)}return c==a?f:q(a,f.parentNode,z.getNodeIndex(f),d)}return a!=c?(f=c.parentNode,c=z.getNodeIndex(c),g||c++,q(a,f,c,d)):a}function v(a){var b=a?"nextSibling":"previousSibling";return function(c,e){var d=c.parentNode,f=c[b];if(f){if(f&&3==f.nodeType)return f}else if(e){var f=d[b],h;if(h=f&&1==f.nodeType)h=f,h=d.tagName==h.tagName&&g(d,h)&&n(d,h);if(h)return f[a?"firstChild":"lastChild"]}return null}}function y(a){this.firstTextNode=(this.isElementMerge=
1==a.nodeType)?a.lastChild:a;this.textNodes=[this.firstTextNode]}function F(a,b,c){this.cssClass=a;var e,g,h=null;if("object"==typeof b&&null!==b){c=b.tagNames;h=b.elementProperties;for(e=0;g=E[e++];)b.hasOwnProperty(g)&&(this[g]=b[g]);e=b.normalize}else e=b;this.normalize="undefined"==typeof e?!0:e;this.attrExceptions=[];e=document.createElement(this.elementTagName);this.elementProperties={};for(var k in h)h.hasOwnProperty(k)&&(x.hasOwnProperty(k)&&(k=x[k]),e[k]=h[k],this.elementProperties[k]=e[k],
this.attrExceptions.push(k));this.elementSortedClassName=this.elementProperties.hasOwnProperty("className")?d(this.elementProperties.className+" "+a):a;this.applyToAnyTagName=!1;a=typeof c;if("string"==a)"*"==c?this.applyToAnyTagName=!0:this.tagNames=c.toLowerCase().replace(/^\s\s*/,"").replace(/\s\s*$/,"").split(/\s*,\s*/);else if("object"==a&&"number"==typeof c.length)for(this.tagNames=[],e=0,a=c.length;e<a;++e)"*"==c[e]?this.applyToAnyTagName=!0:this.tagNames.push(c[e].toLowerCase());else this.tagNames=
[this.elementTagName]}a.requireModules(["WrappedSelection","WrappedRange"]);var z=a.dom,I=function(){function a(b,c,e){return c&&e?" ":""}return function(b,c){b.className&&(b.className=b.className.replace(new RegExp("(?:^|\\s)"+c+"(?:\\s|$)"),a))}}(),H;"undefined"!=typeof window.getComputedStyle?H=function(a,b){return z.getWindow(a).getComputedStyle(a,null)[b]}:"undefined"!=typeof document.documentElement.currentStyle?H=function(a,b){return a.currentStyle[b]}:b.fail("No means of obtaining computed style properties found");
var A;(function(){A="boolean"==typeof document.createElement("div").isContentEditable?function(a){return a&&1==a.nodeType&&a.isContentEditable}:function(a){return a&&1==a.nodeType&&"false"!=a.contentEditable?"true"==a.contentEditable||A(a.parentNode):!1}})();var C=/^inline(-block|-table)?$/i,K=/[^\r\n\t\f \u200B]/,M=v(!1),G=v(!0);y.prototype={doMerge:function(){for(var a=[],b,c,e=0,d=this.textNodes.length;e<d;++e)b=this.textNodes[e],c=b.parentNode,a[e]=b.data,e&&(c.removeChild(b),c.hasChildNodes()||
c.parentNode.removeChild(c));return this.firstTextNode.data=a=a.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;b<c;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};var E=["elementTagName","ignoreWhiteSpace","applyToEditableOnly"],x={"class":"className"};F.prototype={elementTagName:"span",elementProperties:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,
hasClass:function(a){return 1==a.nodeType&&z.arrayContains(this.tagNames,a.tagName.toLowerCase())&&c(a,this.cssClass)},getSelfOrAncestorWithClass:function(a){for(;a;){if(this.hasClass(a,this.cssClass))return a;a=a.parentNode}return null},isModifiable:function(a){return!this.applyToEditableOnly||t(a)},isIgnorableWhiteSpaceNode:function(a){return this.ignoreWhiteSpace&&a&&3==a.nodeType&&w(a)},postApply:function(a,b,c){for(var e=a[0],d=a[a.length-1],f=[],g,h=e,k=d,l=0,m=d.length,n,q,s=0,u=a.length;s<
u;++s)n=a[s],(q=M(n,!c))?(g||(g=new y(q),f.push(g)),g.textNodes.push(n),n===e&&(h=g.firstTextNode,l=h.length),n===d&&(k=g.firstTextNode,m=g.getLength())):g=null;if(a=G(d,!c))g||(g=new y(d),f.push(g)),g.textNodes.push(a);if(f.length){s=0;for(u=f.length;s<u;++s)f[s].doMerge();b.setStart(h,l);b.setEnd(k,m)}},createContainer:function(b){b=b.createElement(this.elementTagName);a.util.extend(b,this.elementProperties);e(b,this.cssClass);return b},applyToTextNode:function(a){var b=a.parentNode;1==b.childNodes.length&&
z.arrayContains(this.tagNames,b.tagName.toLowerCase())?e(b,this.cssClass):(b=this.createContainer(z.getDocument(a)),a.parentNode.insertBefore(b,a),b.appendChild(a))},isRemovable:function(a){var b;if(b=a.tagName.toLowerCase()==this.elementTagName&&d(a.className)==this.elementSortedClassName)a:{b=this.elementProperties;for(var c in b)if(b.hasOwnProperty(c)&&a[c]!==b[c]){b=!1;break a}b=!0}return b&&!m(a,this.attrExceptions)&&this.isModifiable(a)},undoToTextNode:function(a,b,c){b.containsNode(c)||(a=
b.cloneRange(),a.selectNode(c),a.isPointInRange(b.endContainer,b.endOffset)&&(q(c,b.endContainer,b.endOffset,[b]),b.setEndAfter(c)),a.isPointInRange(b.startContainer,b.startOffset)&&(c=q(c,b.startContainer,b.startOffset,[b])));this.isRemovable(c)?k(c):I(c,this.cssClass)},applyToRange:function(a){a.splitBoundaries();var b=l(a);if(b.length){for(var c,e=0,d=b.length;e<d;++e)c=b[e],this.isIgnorableWhiteSpaceNode(c)||this.getSelfOrAncestorWithClass(c)||!this.isModifiable(c)||this.applyToTextNode(c);a.setStart(b[0],
0);c=b[b.length-1];a.setEnd(c,c.length);this.normalize&&this.postApply(b,a,!1)}},applyToSelection:function(b){b=b||window;b=a.getSelection(b);var c,e=b.getAllRanges();b.removeAllRanges();for(var d=e.length;d--;)c=e[d],this.applyToRange(c),b.addRange(c)},undoToRange:function(a){a.splitBoundaries();var b=l(a),c,e,d=b[b.length-1];if(b.length){for(var f=0,g=b.length;f<g;++f)c=b[f],(e=this.getSelfOrAncestorWithClass(c))&&this.isModifiable(c)&&this.undoToTextNode(c,a,e),a.setStart(b[0],0),a.setEnd(d,d.length);
this.normalize&&this.postApply(b,a,!0)}},undoToSelection:function(b){b=b||window;b=a.getSelection(b);var c=b.getAllRanges(),e;b.removeAllRanges();for(var d=0,f=c.length;d<f;++d)e=c[d],this.undoToRange(e),b.addRange(e)},getTextSelectedByRange:function(a,b){var c=b.cloneRange();c.selectNodeContents(a);var e=c.intersection(b),e=e?e.toString():"";c.detach();return e},isAppliedToRange:function(a){if(a.collapsed)return!!this.getSelfOrAncestorWithClass(a.commonAncestorContainer);for(var b=a.getNodes([3]),
c=0,e;e=b[c++];)if(!this.isIgnorableWhiteSpaceNode(e)&&h(a,e)&&this.isModifiable(e)&&!this.getSelfOrAncestorWithClass(e))return!1;return!0},isAppliedToSelection:function(b){b=b||window;b=a.getSelection(b).getAllRanges();for(var c=b.length;c--;)if(!this.isAppliedToRange(b[c]))return!1;return!0},toggleRange:function(a){this.isAppliedToRange(a)?this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},detach:function(){}};
F.util={hasClass:c,addClass:e,removeClass:I,hasSameClasses:g,replaceWithOwnChildren:k,elementsHaveSameNonClassAttributes:n,elementHasNonClassAttributes:m,splitNodeAt:q,isEditableElement:A,isEditingHost:s,isEditable:t};a.CssClassApplier=F;a.createCssClassApplier=function(a,b,c){return new F(a,b,c)}});Q("$.dmxEditor.ui");var M=ea.extend({init:function(a){this.editor=a;this.wrapper=d('<div class="dmx-editor-menu"></div>').data("dmxEditorMenu",this);V&&this.wrapper.addClass("ie").attr("unselectable",
"on")},addItem:function(a,b){this.wrapper.is(":empty")&&this.wrapper.append('<ul class="dmx-editor-menu-items"></ul>');this.wrapper.find("> ul")[b?"prepend":"append"](a.wrapper);a.editor=this.editor;return a},addControl:function(a,b){var c=this.editor.getControl(a);if(c instanceof Aa){for(var e=P(c.settings.values,c),d=this.addItem(new MenuItem(c),b),g=0,k=e.length;g<k;g++)(function(a){if("-"==a)d.addSeparator();else{var b="string"==typeof a?a:a.value;d.addItem(new MenuItem({label:b,execute:function(){c.command.execute(b)}}))}})(e[g]);
return d}return c instanceof fa?this.addItem(new DialogMenuItem(c),b):this.addItem(new MenuItem(c),b)},addSeparator:function(a){return this.addItem(new MenuSeparator,a)},isEmpty:function(){return this.wrapper.is(":empty")},empty:function(){this.wrapper.empty()}});d.dmxEditor.ui.Menu=M;d.dmxEditor.ui.hideMenus=function(a){d(".dmx-menu").each(function(){var a=d(this).data("settings");if(a&&d.isFunction(a.onHide))a.onHide()});d("#dmx-editor-dialog-contextmenu").remove();d(".dmx-menu,#dmx-editor-overlay").remove();
document.removeEventListener&&document.removeEventListener("mousedown",wa,!0)};d.dmxEditor.ui.createMenu=function(a){if(a&&a.data){var b=d('<div class="dmx-menu"></div>').appendTo("body").bind("mousedown",Ga).bind("repositionmenu",Ma).css({position:"absolute",width:"auto"}).data("settings",a);d.isFunction(a.data)&&(a.data=a.data());("string"===typeof a.data||a.data.jquery)&&b.append(a.data);Ma();document.addEventListener&&document.addEventListener("mousedown",wa,!0)}};Q("$.dmxEditor.ui");var Ua=ea.extend({init:function(a,
b,c){this.id=a;this.editor=b;this.settings=c;this.selector="div.dmx-editor-toolbar[data-id='"+a+"']";this.visible=!0;this.config()},config:function(a){d.extend(!0,this.settings,a||{});if(!d.isArray(this.settings.items)){a=[];for(var b in this.settings.items)this.settings.items[b]&&(0==b.indexOf("-")&&(b="-"),a.push(b));this.settings.items=a}},getHtml:function(){for(var a="",b=this.settings.items,c=0,e=b.length;c<e;c++)b[c]in this.editor.controls?a+=this.editor.controls[b[c]].getHtml():I("["+this.editor.id+
"] Control '"+b[c]+"' doesn't exists in editor");return'<div data-id="'+this.id+'" class="dmx-editor-toolbar"><div class="dmx-editor-toolbar-start"></div>'+a+'<div class="dmx-editor-toolbar-end"></div></div>'},addControl:function(a,b){this.settings.items.splice(b,0,a)},insertControlBefore:function(a,b){for(var c=this.settings.items,e=0;e<c.length;e++)if(c[e]==b){this.addControl(a,e);return}c.push(a)},insertControlAfter:function(a,b){for(var c=this.settings.items,e=0;e<c.length;e++)if(c[e]==b){this.addControl(a,
e+1);return}c.push(a)},update:function(){var a=this.settings,b=a.items;this.visible=d.isFunction(a.visible)?a.visible(this.editor):a.visible;this.editor.wrapper.find(this.selector).toggle(this.visible);if(this.visible&&this.editor.controls)for(a=0;a<b.length;a++)b[a]in this.editor.controls&&this.editor.controls[b[a]].update()}});d.dmxEditor.ui.Toolbar=Ua;Q("$.dmxEditor.ui");M=ea.extend({init:function(a,b){a?(this.id=a,this.editor=b&&b.editor,this.settings=b,this.selector=".dmx-editor-control[data-id='"+
this.id+"']",this.classPrefix="dmx-editor-",this.active=this.disabled=!1,this.command=b&&b.command,"string"===typeof this.command&&(this.command=this.editor.getCommand(this.command))):I("Control with no ID")},setActive:function(a){d(this.selector,this.editor.wrapper).toggleClass("dmx-editor-active",a);this.active=a},isActive:function(){return this.active},setDisabled:function(a){d(this.selector,this.editor.wrapper).toggleClass("dmx-editor-disabled",a);this.disabled=a},isDisabled:function(){return this.disabled},
getHtml:function(){return'<span data-id="'+this.id+'" class="dmx-editor-control"></span>'},update:function(){var a=this.command;a&&a.queryState&&a.queryEnabled&&(this.setDisabled(!a.queryEnabled()),this.isDisabled()?this.setActive(!1):this.setActive(a.queryState()))},onClick:function(){var a=this,b=this.command;this.isDisabled()||(b&&b.execute&&this.editor.execute(b.id),this.settings.execute&&this.settings.execute(),setTimeout(function(){a.editor.refreshSelection();a.editor.updateControls()},0))}});
d.dmxEditor.ui.Control=M;Q("$.dmxEditor.ui");var lb=M.extend({init:function(a,b){this._super(a,b)},getHtml:function(){return'<div class="'+this.classPrefix+'separator"></div>'},update:d.noop});d.dmxEditor.ui.Separator=lb;Q("$.dmxEditor.ui");M=M.extend({init:function(a,b){this._super(a,b)},getHtml:function(){var a=this.classPrefix,b=this.settings,c='<span data-id="'+this.id+'" class="'+a+"control "+a+'button"';b.tooltip&&(c+=' title="'+this.editor.translate(b.tooltip)+'"');c+=">";if(b.icon)var e=d.isFunction(b.icon)?
b.icon(this.editor):b.icon,c=-1!=e.indexOf("://")?c+('<div style="background-image:url('+e+');"  class="'+a+'icon"></div>'):c+('<div class="'+a+"icon "+a+"icon-"+e+'"></div>');b.label&&(c+='<span class="'+a+'label">'+this.editor.translate(b.label)+"</span>");return c+"</span>"}});d.dmxEditor.ui.Button=M;Q("$.dmxEditor.ui");var fa=M.extend({init:function(a,b){b.position=b.position||"down";this._super(a,b);var c=this,e=this.settings;this.dialog=new S(this.id,this.editor,d.extend({parent:this.selector,
onSuccess:function(){var a=c.command;a&&a.execute&&a.execute(this.value||this.data);e.execute&&e.execute.call(this,this.value||this.data)},onClose:function(){c.setActive(!1)}},e))},getHtml:function(){var a=this.classPrefix,b=this.settings,c='<span data-id="'+this.id+'" class="'+a+"control "+a+'button"';b.tooltip&&(c+=' title="'+this.editor.translate(b.tooltip)+'"');c+=">";"left"==b.position&&(c+='<span class="'+a+'dropdown">&#9668;</span>');if(b.icon)var e=d.isFunction(b.icon)?b.icon(this.editor):
b.icon,c=-1!=e.indexOf("://")?c+('<div style="background-image:url('+e+');"  class="'+a+'icon"></div>'):c+('<div class="'+a+"icon "+a+"icon-"+e+'"></div>');b.label&&(c+='<span class="'+a+'label">'+this.editor.translate(b.label)+"</span>");"right"==b.position?c+='<span class="'+a+'dropdown">&#9658;</span>':"left"!=b.position&&"right"!=b.position&&"center"!=b.position&&(c+='<span class="'+a+'dropdown">&#9660;</span>');return c+"</span>"},update:function(){d.isFunction(this.settings.disable)?this.setDisabled(this.settings.disable.apply(this)):
this.command&&this.setDisabled(!this.command.queryEnabled())},openDialog:function(){this.setActive(!0);if(this.command){var a=this.command.queryValue();d.isPlainObject(a)?this.dialog.data=a:this.dialog.value=a}this.settings.url?this.dialog.open(d.isFunction(this.settings.url)?this.settings.url(this.editor):this.settings.url):this.dialog.create(d.isFunction(this.getDialog)?this.getDialog():"No dialog")},onClick:function(){if(this.isDisabled()||this.isActive())return!1;this.openDialog()}});d.dmxEditor.ui.DialogButton=
fa;Q("$.dmxEditor.ui");M=fa.extend({init:function(a,b){this.type="web";this.value="";this._super(a,b)},getHtml:function(){var a=this.classPrefix,b=this.settings,c='<span data-id="'+this.id+'" class="'+a+"control "+a+'button"';b.tooltip&&(c+=' title="'+this.editor.translate(b.tooltip)+'"');c+='><div class="'+a+"icon "+a+"icon-"+b.icon+'"></div>';b.label&&(c+='<span class="'+a+'label">'+this.editor.translate(b.label)+"</span>");return c=c+('<span class="'+a+'dropdown">&#9660;</span>')+"</span>"},setValue:function(a){this.value=
a},update:function(){this.command&&(this.setDisabled(!this.command.queryEnabled()),this.setValue(this.command.queryValue()))},getDialog:function(){var a=this,b=d('<div class="menu-items-wrapper"></div>');d(this.editor.wrapper).find(this.selector);b.append(d('<div class="picker"></div>').dmxColorPicker({type:this.type,color:this.value})).prepend(d('<div class="clearfix" style="margin-bottom:5px;"><div class="color-preview"></div><input type="text" class="color-hex-preview" spellcheck="false" /></div>').append(d('<span class="dmx-editor-control dmx-editor-button" style="float:left;" title="'+
this.editor.translate("Clear Color")+'"><div class="dmx-editor-icon dmx-editor-icon-no-color" style="float:left;"/></span>').click(function(){a.dialog.value="clear";a.dialog.close(!0)})));b.bind("colorPreview",function(b,e){var f=e.getString(a.editor.storage.useColorCode[a.type]||"hex");d(".color-preview",this).css("backgroundColor",f);d(".color-hex-preview",this).val(e.getName()||f)}).bind("colorSelect",function(b,e){a.dialog.value=e.getString("hex");a.dialog.close(!0)});d(".color-hex-preview",b).bind("keyup",
function(a){var e=d.dmxEditor.Color.parse(this.value),f=e.getString("hex");d(".color-preview",b).css("backgroundColor",f);13==a.keyCode&&b.trigger("colorSelect",[e]);27!=a.keyCode&&a.stopPropagation()}).bind("keydown keypress",function(a){a.stopPropagation()});return b}});d.dmxEditor.ui.ColorButton=M;Q("$.dmxEditor.ui");var Aa=fa.extend({init:function(a,b){this._super(a,b);var c=this;this.value="";this.command&&(this.value=this.command.queryValue());this.dialog=new S(this.id,this.editor,{dialog:"select",
parent:this.selector,minWidth:function(){return parseInt(d(c.selector,c.editor.wrapper).width(),10)||10},onSuccess:function(a){(a=c.command)&&a.execute&&this.editor.execute(a.id,this.value);b.execute&&b.execute.call(c,this.value)},onShow:function(){this.dialog.find("li[data-value]").click(function(a){c.dialog.value=d(this).data("value");c.dialog.close(!0)})},onClose:function(){c.setActive(!1)}})},getHtml:function(){var a=this.classPrefix,b=this.settings,c='<span data-id="'+this.id+'" class="'+a+"control "+
a+'select"';b.tooltip&&(c+=' title="'+this.editor.translate(b.tooltip)+'"');c+=">";if(b.icon)var e=d.isFunction(b.icon)?b.icon(this.editor):b.icon,c=-1!=e.indexOf("://")?c+('<div style="background-image:url('+e+');"  class="'+a+'icon"></div>'):c+('<div class="'+a+"icon "+a+"icon-"+e+'"></div>');e="";b.width&&(e=' style="width:'+b.width+'"');c=b.editable?c+('<input class="'+a+'label"'+e+' value="'+this.value+'" />'):c+('<span class="'+a+'label"'+e+">"+ha(this.value)+"</span>");return c=c+('<span class="'+
a+'dropdown">&#9660;</span>')+"</span>"},getDialog:function(){var a=this.settings,b="",c=[],c=d.isFunction(a.values)?a.values():a.values,e=d(this.editor.selectedElement,this.editor.frame).parents().andSelf().map(function(){return this.tagName.toLowerCase()}).get();if(d.isArray(c))for(b+='<ul class="dmx-editor-select-menu">',a=0;a<c.length;a++){var f=c[a];"string"==typeof f?b="-"==f?b+'<li class="dmx-editor-select-separator"></li>':b+('<li data-value="'+f+'" class="dmx-editor-select-item">'+this.editor.translate(f)+
"</span></li>"):f.tag?-1<d.inArray(f.tag.toLowerCase(),e)&&(b+='<li data-value="'+f.tag+"."+f.value+'" class="dmx-editor-select-item"'+(f.style?' style="'+f.style+'"':"")+">"+this.editor.translate(f.label)+"</li>"):b+='<li data-value="'+f.value+'" class="dmx-editor-select-item"'+(f.style?' style="'+f.style+'"':"")+">"+this.editor.translate(f.label)+"</li>"}else{var b=b+'<ul class="dmx-editor-select-menu">',g;for(g in c)for(b+='<li class="dmx-editor-select-group">'+g+"</li>",e=c[g],a=0;a<e.length;a++)f=
e[a],b="string"==typeof f?"-"==f?b+'<li class="dmx-editor-select-separator"></li>':b+('<li data-value="'+f+'" class="dmx-editor-select-item">'+this.editor.translate(f)+"</li>"):b+('<li data-value="'+f.value+'" class="dmx-editor-select-item"'+(f.style?' style="'+f.style+'"':"")+">"+this.editor.translate(f.label)+"</li>")}return b+"</ul>"},update:function(){var a=this.settings;d.isFunction(a.disable)?this.setDisabled(a.disable.apply(this)):this.command&&this.setDisabled(!this.command.queryEnabled());
if(this.command){var b=this.command.queryValue(),a=d.isFunction(a.values)?a.values():a.values;if(d.isArray(a))for(var c=0;c<a.length;c++)if(a[c].value&&b.toLowerCase()==a[c].value.toLowerCase()){b=this.editor.translate(a[c].label);break}this.value=b||""}d(this.selector,this.editor.wrapper).find("."+this.classPrefix+"label").attr("title",this.value).text(this.value)}});d.dmxEditor.ui.Select=Aa;Q("$.dmxEditor.ui");M=fa.extend({init:function(a,b){this._super(a,b);var c=this;this.value=[];this.command&&
(this.value=this.command.queryValue());this.dialog=new S(this.id,this.editor,{dialog:"select",parent:this.selector,minWidth:function(){return parseInt(d(c.selector,c.editor.wrapper).width(),10)||10},onShow:function(){this.dialog.find("input").each(function(){for(var a=0;a<c.value.length;a++){var b=c.value[a],d=c.value[a].split(".")[1];if(this.value==b||this.value==d)this.checked=!0}}).change(function(a){(a=c.command)&&a.execute&&c.editor.execute(a.id,{value:this.value,checked:this.checked});b.execute&&
b.execute.call(c,{value:this.value,checked:this.checked})})},onClose:function(){c.setActive(!1)}})},getHtml:function(){var a=this.classPrefix,b=this.settings,c='<span data-id="'+this.id+'" class="'+a+"control "+a+'select"';b.tooltip&&(c+=' title="'+this.editor.translate(b.tooltip)+'"');c+=">";if(b.icon)var e=d.isFunction(b.icon)?b.icon(this.editor):b.icon,c=-1!=e.indexOf("://")?c+('<div style="background-image:url('+e+');"  class="'+a+'icon"></div>'):c+('<div class="'+a+"icon "+a+"icon-"+e+'"></div>');
e="";b.width&&(e=' style="width:'+b.width+'"');c=b.editable?c+('<input class="'+a+'label"'+e+' value="'+this.value.join(", ")+'" />'):c+('<span class="'+a+'label"'+e+">"+ha(this.value.join(", "))+"</span>");return c=c+('<span class="'+a+'dropdown">&#9660;</span>')+"</span>"},getDialog:function(){var a=this.settings,b="",c=[],c=d.isFunction(a.values)?a.values():a.values,a=d(this.editor.selectedElement,this.editor.frame).parents().andSelf().map(function(){return this.tagName.toUpperCase()}).get();if(d.isArray(c))for(var b=
b+'<ul class="dmx-editor-select-menu">',e=0;e<c.length;e++){var f=c[e];"string"==typeof f?"-"==f?b+='<li class="dmx-editor-select-separator"></li>':(b+='<li class="dmx-editor-select-item">',b+='<label><input type="checkbox" value="'+f+'" />',b+=this.editor.translate(f)+"</label></li>"):f.tag&&-1<d.inArray(f.tag,a)?(b+='<li class="dmx-editor-select-item"'+(f.style?' style="'+f.style+'"':"")+">",b+='<label><input type="checkbox" value="'+f.tag+"."+f.value+'" />',b+=this.editor.translate(f.label)+"</label></li>"):
f.tag||(b+='<li class="dmx-editor-select-item"'+(f.style?' style="'+f.style+'"':"")+">",b+='<label><input type="checkbox" value="'+f.value+'" />',b+=this.editor.translate(f.label)+"</label></li>")}else{var b=b+'<ul class="dmx-editor-select-menu">',g;for(g in c)if("General"==g&&this.editor.getBlockNode()||-1<d.inArray(g,a))for(var b=b+('<li class="dmx-editor-select-group">'+g+"</li>"),k=c[g],e=0;e<k.length;e++)f=k[e],"string"==typeof f?"-"==f?b+='<li class="dmx-editor-select-separator"></li>':(b+=
'<li class="dmx-editor-select-item">',b+='<label><input type="checkbox" value="'+f+'" />',b+=this.editor.translate(f)+"</label></li>"):(f.tag&&"*"!=f.tag?(b+='<li class="dmx-editor-select-item"'+(f.style?' style="'+f.style+'"':"")+">",b+='<label><input type="checkbox" value="'+f.tag+"."+f.value+'" />'):(b+='<li class="dmx-editor-select-item"'+(f.style?' style="'+f.style+'"':"")+">",b+='<label><input type="checkbox" value="'+f.value+'" />'),b+=this.editor.translate(f.label)+"</label></li>")}return b+
"</ul>"},update:function(){var a=this.settings;d.isFunction(a.disable)?this.setDisabled(a.disable.apply(this)):this.command&&this.setDisabled(!this.command.queryEnabled());if(this.command){var b=this.command.queryValue(),a=d.isFunction(a.values)?a.values():a.values;if(d.isArray(a))for(var c=0;c<a.length&&!(a[c].value&&-1<$inArray(a[c].value.toLowerCase(),b));c++);this.value=b||[]}b=this.value.join(", ");d(this.selector,this.editor.wrapper).find("."+this.classPrefix+"label").attr("title",b).text(b)}});
d.dmxEditor.ui.MultiSelect=M;S.cache={};S.init=null;S.prototype={open:function(a,b){-1==a.indexOf("://")&&(a=d.dmxEditor.basePath+"dmxEditor/"+a);this.url=a;if(this.options.cache&&a in d.dmxEditor.Dialog.cache)this.create(d.dmxEditor.Dialog.cache[a],b);else{var c=this;d.ajax({url:a,dataType:"html",success:function(e){d.dmxEditor.Dialog.cache[a]=e;c.create(e,b)},error:function(a,b,c){ba(b,c)}})}},close:function(a){var b=this.options;this.parent.unbind(".dialog").css("z-index","");this.success=!!a;
this.getData();d.isFunction(b.onClose)&&!1===b.onClose.call(this)?this.success=!1:(this.options.retFocus&&this.editor.focus(),a&&d.isFunction(b.onSuccess)&&b.onSuccess.call(this),this.unbindEvents(),this.dialog.remove(),0===d("."+this.cls).length&&d.dmxEditor.removeOverlay())},create:function(a,b){var c=this.options,e;"none"!=c.position?(this.overlay=d.dmxEditor.createOverlay(c.darken),e=parseFloat(this.overlay.css("z-index"))||1E6):xIndex=1;d.dmxEditor.Dialog.init=null;window.DMXAjaxDialog={init:null};
this.success=!1;d.isPlainObject(b)&&(this.data=b);this.parent="string"==typeof c.parent?d(c.parent,this.editor.wrapper):d(c.parent);d("#"+this.id).remove();this.dialog=d('<div id="'+this.id+'" tabindex="0" class="'+this.cls+'" style="z-index:'+(e+1)+";min-width:"+(d.isFunction(c.minWidth)?c.minWidth():c.minWidth)+"px;min-height:"+(d.isFunction(c.minHeight)?c.minWidth():c.minWidth)+'px;"></div>').data("dialog",this).appendTo(c.container);"string"==typeof a?(this.url&&(e=this.url.split("?")[0],a=a.replace(/\$\{url\}/g,
e.substring(0,e.lastIndexOf("/")+1))),this.dialog.html(this.editor.translateHtml(a))):this.dialog.append(d(a));"default"!==this.editor.options.skin&&this.dialog.addClass(this.editor.options.skin);this.setData();if(d.isFunction(DMXAjaxDialog.init))try{DMXAjaxDialog.init.call(this,this.editor)}catch(f){ba(f)}if(d.isFunction(d.dmxEditor.Dialog.init))try{d.dmxEditor.Dialog.init.call(this)}catch(g){ba(g)}this.bindEvents();this.reposition();e=this.dialog.find(":input:first");0!=e.length?e.focus():this.dialog.focus();
d.isFunction(c.onShow)&&c.onShow.call(this)},getData:function(){function a(a,b,c){var d;for(b=b.split(".");b[1];)d=b.shift(),a=a[d]=a[d]||{};a[b.shift()]=c}var b=this,c;this.dialog.find("input,textarea,select").each(function(){if(this.name&&!this.disabled){c=null;if("input"==this.nodeName.toLowerCase())switch(this.getAttribute("type").toLowerCase()){case "checkbox":var e=b.dialog.find('input[name="'+this.name+'"]');1==e.length?c=!!this.checked:(c=[],e.filter(":checked").each(function(){c.push(this.value)}),
0==c.length&&(c=null));break;case "number":c=this.value-0||null;break;case "radio":c=b.dialog.find('input["'+this.name+'"]:checked').val()||null;break;default:c=d(this).val()||null}else c=d(this).val()||null;a(b.data,this.name,c)}})},setData:function(){function a(a){var c,g=d.extend({},b.data);for(a=a.split(".");a[0];){c=a.shift();if(null==g[c])return null;g=g[c]}return g}var b=this,c;this.dialog.find("input,textarea,select").each(function(){this.name&&(c=a(this.name),null!=c&&(c instanceof Array?
"select"==this.nodeName.toLowerCase()?d(this).val():b.dialog.find('input["'+this.name+'"]').each(function(){this.checked=-1!=d.inArray(this.value,c)}):"checkbox"==this.type?this.checked="boolean"==typeof c?c:c==this.value:d(this).val(c)))})},bindEvents:function(){var a=this,b=this.options;this.overlay&&this.overlay.bind("mousedown."+this.id,function(c){c.preventDefault();b.modal||a.close(!1)});this.dialog.find(".dmx-editor-OK").bind("click",function(b){a.close(!0)});this.dialog.find(".dmx-editor-CANCEL").bind("click",
function(b){a.close(!1)});"center"!==b.position&&d(window).bind("resize."+this.id,function(b){a.reposition()});this.dialog.bind("keypress."+this.id,function(b){27===b.keyCode?a.close(!1):13===b.keyCode&&"textarea"!=b.target.nodeName.toLowerCase()&&a.close(!0)})},unbindEvents:function(){this.overlay&&this.overlay.unbind("."+this.id);d(window).unbind("."+this.id)},reposition:function(){var a=this.options,b=a.parent.jQuery?a.parent:d(a.parent,this.editor.wrapper),c=b.offset(),e=this.dialog.outerWidth(),
f=this.dialog.outerHeight(),g=d(window).width();d(window).height();switch(a.position){case "none":this.dialog.css({position:"relative",left:0,top:0});break;case "center":this.dialog.css({position:"fixed",left:"50%",top:"50%",marginLeft:"-"+e/2+"px",marginTop:"-"+f/2+"px"});break;case "left":this.dialog.css({left:c.left-e,top:c.top});break;case "right":this.dialog.css({left:c.left+b.outerWidth(),top:c.top});break;case "down-r":a=c.left+b.outerWidth()-e;this.dialog.css({left:0>a?0:a,top:c.top+b.outerHeight()});
break;default:this.dialog.css({left:c.left+e>g?g-e:c.left,top:c.top+b.outerHeight()})}}};d.dmxEditor.Dialog=S;d.dmxEditor.createOverlay=function(a){d.dmxEditor.removeOverlay();var b=d('<div id="dmx-editor-overlay"></div>').appendTo("body");a&&b.addClass("dmx-editor-darken");return b};d.dmxEditor.removeOverlay=function(){d("#dmx-editor-overlay").remove()};var ib=ea.extend({init:function(a,b){var c=this;this.editor=a;this.tolerance=b||200;this.idle=!0;d(a.frame).bind("editor:*",function(a,b){"editor:idle"!=
b.type&&"editor:documentedited"!=b.type&&c.activity()})},enterIdle:function(){this.clearIdleTimer();this.idle||(this.idle=!0,this.editor.dispatch("editor:idle"))},activity:function(){this.clearIdleTimer();this.idle&&(this.idle=!1);this.idleTimer=window.setTimeout(Z(this,this.enterIdle),this.tolerance)},clearIdleTimer:function(){this.idleTimer&&(window.clearTimeout(this.idleTimer),delete this.idleTimer)},destruct:function(){this.clearIdleTimer()}});d.extend(d.dmxEditor.prototype,{tokenize:function(a,
b){var c=this;this.tokens||(this.tokens=[]);return a.replace(b,function(a){c.tokens.push(a);return"_dmxEditorToken_"+c.tokens.length+"_dmx_"})},unTokenize:function(a){var b=this;this.tokens&&(a=a.replace(/_dmxEditorToken_(\d+)_dmx_(?:="")?/gi,function(a,e){return b.tokens[e-1]||""}),this.tokens=null);return a}});var hb=ea.extend({init:function(a){this.editor=a;this.items=[];this.position=-1;this.limit=a.options.historyLimit},notify:function(a){"saveUndoPoint"!=a&&(this.editor.stopModificationsMonitoring(),
this.editor.setHTML(this.items[this.position].content),this.editor.startModificationsMonitoring());this.editor.dispatch("editor:historychange",this,this.items,this.position)},saveUndoPoint:function(a,b){var c=this.limit,e=this.items.length;0<c&&e>=c&&this.items.splice(1,e-c);this.position=this.items.push({content:a,name:b||"Unknown command"})-1;this.notify("saveUndoPoint");return this.position},undo:function(){this.canUndo()&&(this.position--,this.notify("undo"));return this.position},redo:function(){this.canRedo()&&
(this.position++,this.notify("redo"));return this.position},moveTo:function(a){this.position=a;this.notify("moveTo");return this.position},canUndo:function(){return 0<this.position},canRedo:function(){return this.position<this.items.length-1},getLength:function(){return this.items.length},clear:function(){if(0<this.items.length){for(this.position=this.items.length;--this.position;)items.splice(this.position,1);notify("clear")}},getAll:function(){return this.items},setLimit:function(a){this.limit=
a}});d.extend(d.dmxEditor.prototype,{focus:function(){this.getWindow().focus()},resizeUI:function(){this.wrapper.hasClass("fullscreen")&&(this.wrapper.width(d(window).width()),this.wrapper.height(d(window).height()));var a=this.wrapper.find(".dmx-editor-frame-wrapper"),b=this.wrapper.parents(":hidden").filter(function(){return"none"==d(this).css("display")}),c=0;b.show();a.siblings(":visible").each(function(){"absolute"!=d(this).css("position")&&(c+=d(this).outerHeight())});b.hide();qa?a.height(this.wrapper.height()-
18-c):a.height(this.wrapper.height()-2-c)},resizeTo:function(a,b){a&&this.wrapper.width(a);b&&this.wrapper.height(b);this.resizeUI()},resizeBy:function(a,b){this.resizeTo(this.wrapper.width()+a,this.wrapper.height()+b)},resizeWith:function(a,b){this.resizeTo(this.wrapper.width()+a,this.wrapper.height()+b)},setSkin:function(a){var b=this,c=d("link[href*='dmxEditor.css']"),e=d.dmxEditor.basePath,f=e+"../styles/dmxEditor/";0<c.length&&(f=c[0].href.replace(/dmxEditor.css$/i,"dmxEditor/"));d("link[href*='"+
f+"']").each(function(){b.wrapper.removeClass(this.href.match(/\/([^\/\.]*)\.css$/i)[1])});"string"==typeof a&&""!==a&&"default"!==a&&require([e+"css.js!"+f+a+"/"+a+".css"],function(){b.wrapper.addClass(a);b.resizeUI();b.options.skin=a})},setIconSet:function(a){var b=this,c=d.dmxEditor.basePath,e=c+"dmxEditor/iconsets/";this.wrapper.removeClass(function(a,b){for(var c=b.split(" "),e=[],d=0;d<c.length;d++)/^dmx-editor-iconset-/.test(c[d])&&e.push(c[d]);return e.join(" ")});"string"==typeof a&&"default"!==
a&&require([c+"css.js!"+e+a+"/"+a+".css"],function(){b.wrapper.addClass("dmx-editor-iconset-"+a);b.resizeUI();b.options.iconSet=a})},toggleFullscreen:function(a){var b=this.getBody(),c=this,e=this.wrapper;this.toggleFullscreen.oldDim=this.toggleFullscreen.oldDim||{};X&&(this.frame.blur(),b.contentEditable=!1,b.removeAttribute("contenteditable"));e.hasClass("fullscreen")||(this.toggleFullscreen.oldDim.width=e.width(),this.toggleFullscreen.oldDim.height=e.height());a?(e.css({width:"",height:""}).addClass("fullscreen"),
d(window).bind("resize.fullscreeneditor",function(a){c.resizeUI()}).triggerHandler("resize.fullscreeneditor")):(d(window).unbind("resize.fullscreeneditor"),e.removeClass("fullscreen"),this.resizeTo(this.toggleFullscreen.oldDim.width,this.toggleFullscreen.oldDim.height));this.dispatch(a?"enterfullscreen":"leavefullscreen");if(X)try{b.setAttribute("contenteditable","true"),b.contentEditable=!0}catch(f){}this.focus()},createToolbars:function(){var a=this,b=this.wrapper.find(".dmx-editor-toolbars");b.empty();
for(var c=this.options.toolbarsOrder,e,f={},g=0;g<c.length;g++)e=c[g],this.options.toolbars[e].enabled&&(f[e]=1,this.reloadToolbar(e,this.options.toolbars[e]));for(e in this.options.toolbars)!f[e]&&this.options.toolbars[e].enabled&&(f[e]=g++,this.reloadToolbar(e,this.options.toolbars[e]));t.attach(b[0]);b.unbind("click.editor").bind("click.editor",function(b){var c=d(b.target).closest(".dmx-editor-control").data("id");c&&(c=a.controls[c],c.onClick.call(c,b))});this.refreshToolbars()},reloadToolbar:function(a,
b){var c=this.getToolbar(a);c&&(b&&c.config(b),$tb=this.wrapper.find(c.selector),0<$tb.length?$tb.replaceWith(c.getHtml()):this.wrapper.find(".dmx-editor-toolbars").append(c.getHtml()),c.update())},reloadAllToolbars:function(){var a=this;this.wrapper.find(".dmx-editor-toolbar").each(function(){a.reloadToolbar(d(this).data("id"))})},getToolbar:function(a){return this.Toolbars[a]||this.addToolbar(a)},addToolbar:function(a){a=this.Toolbars[a]=new Ua(a,this,{visible:!0,items:[]});this.wrapper.find(".dmx-editor-toolbars").append(a.getHtml());
return a},refreshToolbars:function(){for(var a in this.Toolbars)this.Toolbars[a].update();this.resizeUI()},getView:function(){return this.currentView},getIconPath:function(a){return d.dmxEditor.basePath+"dmxEditor/iconsets/"+this.options.iconSet+"/"+a}});d.extend(d.dmxEditor.prototype,{initEvents:function(){var a=this;V&&d(this.frame).bind("beforedeactivate",Z(this,this.saveSelection)).bind("activate beforeeditfocus",Z(this,this.restoreSelection));X&&d(this.designview.document).bind("focus.editor",
function(b){b=a.getBody().firstElementChild;if(d(b).is("p")&&"\u200b"==b.innerHTML){try{a.getSelection().collapse(b.firstChild,0)}catch(c){}a.refreshSelection()}});qa&&function(){var b=!1;d(a.designview.document).bind("touchstart",function(a){b=!0}).bind("touchmove",function(a){b=!1}).bind("touchend",function(c){if(b&&"IMG"==c.target.nodeName){var d=a.getDocument().createRange();d.selectNode(c.target);a.selection.setSingleRange(d);return!1}})}();var b="selectionchange.editor";qa||(b="keyup.editor mouseup.editor");
var c;d(window).bind("onorientationchange.editor resize.editor",function(b){clearInterval(c);c=setInterval(function(){a.resizeUI()},100)});d(this.element).filter(":input").bind("render.dmxDataBindings.editor",function(b){a.setHTML(d(this).val())});d(this.designview.element).bind("editor:documentedited.editor",function(b,c,g){"design"==a.currentView&&d(a.element).filter(":input").val(g.replace(/\u200B/g,"")).trigger("change")});d(this.designview.element).bind("editor:ready",function(a,b){d(b.frame).bind("editor:idle",
Z(b,b.checkForDocChange))});d(this.designview.window).bind("unload.editor blur.editor focus.editor",Z(this,this.dispatch));d(this.designview.document).bind(b,Z(this,this.refreshSelection)).bind("contextmenu.editor",ta).bind("keydown.editor",Z(this,this.handleKeyDown)).bind("mouseup.editor",function(b){d("body").trigger("hidemenus");3==b.which&&setTimeout(function(){var c=d(a.frame).offset(),g=b.clientX+c.left+2,c=b.clientY+c.top,k=new DMXMenu(a),h,l=!!a.getBlockNode(!0);a.refreshSelection();"default"!=
a.options.skin&&k.wrapper.addClass(a.options.skin);"default"!=a.options.iconSet&&k.wrapper.addClass("dmx-editor-iconset-"+a.options.iconSet);if(a.getCommand("undo").queryEnabled()||a.getCommand("redo").queryEnabled())k.addControl("undo"),k.addControl("redo"),k.addSeparator();l&&(h=k.addSubMenu(a.translate("Align")),h.addControl("justifyleft"),h.addControl("justifycenter"),h.addControl("justifyfull"),h.addControl("justifyright"),a.getBlockNode(!1)&&(h.addSeparator(),h.addControl("indent"),h.addControl("outdent")));
a.hasTextSelection()&&(h=k.addSubMenu(a.translate("Toggle selection formatting")),h.addControl("bold"),h.addControl("italic"),h.addControl("underline"),h.addControl("strikethrough"),h.addControl("subscript"),h.addControl("superscript"));k.addSeparator();a.hasParentNode("TABLE",!0)&&!a.hasTextSelection()&&(k.addControl("editTable"),k.addControl("editTableCell"),k.addSeparator(),k.addControl("insertColBefore"),k.addControl("insertColAfter"),k.addControl("insertRowBefore"),k.addControl("insertRowAfter"),
k.addSeparator(),k.addControl("deleteRow"),k.addControl("deleteCol"),k.addControl("deleteTable"));k.addSeparator();(a.hasTextSelection()||a.hasParentNode("IMG",!0))&&k.addControl("addlink");a.hasParentNode("A",!0)&&k.addControl("deletelink");a.hasParentNode("IMG",!0)&&!a.getParentNode("IMG",!0).hasAttribute("data-translated")&&k.addControl("addaoreditimage");l&&(k.addSeparator(),k.addControl("formatblock"));if(!k.isEmpty()){h=new jQuery.Event("beforecontextmenu");d(b.target).trigger(h,[k,a,b]);h.isPropagationStopped()&&
!b.isPropagationStopped()&&b.stopPropagation();if(h.isImmediatePropagationStopped()&&!b.isImmediatePropagationStopped())try{b.stopImmediatePropagation()}catch(n){}h.isDefaultPrevented()||(k.overlay=d.dmxEditor.createOverlay(),zIndex=parseFloat(k.overlay.css("z-index"))||1E6,k.wrapper.css("z-index",zIndex+1),k.wrapper.addClass("contextmenu").appendTo("body"),k.showAt(g,c))}},0)})},handleKeyDown:function(a){d(this.designview.document).unbind("keyup.preventDefault keypress.preventDefault",ta);if(!(a.keyCode in
Qa)&&a.keyCode in Ra&&(!(a.keyCode in gb)||a.ctrlKey||a.metaKey||a.altKey)){var b=new jQuery.Event("editor:keydown");this.dispatch(b);if(!b.isDefaultPrevented()){b="";a.shiftKey&&(b+="SHIFT+");if(a.ctrlKey||a.metaKey)b+="CTRL+";a.altKey&&(b+="ALT+");b+=Ra[a.keyCode];if(b in this.Keys){if(!0===this.Keys[b].call(this))return!0;a.preventDefault();d(this.designview.document).one("keyup.preventDefault keypress.preventDefault",ta);return!1}}}},dispatch:function(a){var b,c=Array.prototype.slice.call(arguments,
1);b="string"==typeof a?a:a.type;b=b.replace(/^(editor\:)?/,"editor:");if("editor:nodeselectionchange"==b&&!this.isValidSelectionChange(c))return!1;b=new jQuery.Event(b);d(this.frame).trigger("editor:*",b,c).trigger(b,c);"string"!=typeof a&&(b.isDefaultPrevented()&&a.preventDefault(),b.isPropagationStopped()&&a.stopPropagation(),b.isImmediatePropagationStopped()&&a.stopImmediatePropagation());return b.result},isValidSelectionChange:function(a){return a[0]&&a[0]!==this.getDocument()&&1===d(a[0]).closest("body").length?
!0:!1}});d.extend(d.dmxEditor.prototype,{insertBR:function(){var a=this.range,b=this.getDocument(),c=b.createElement("br");a.insertNode(c);a.collapseAfter(c);if(3==a.endContainer.nodeType&&a.endOffset==a.endContainer.length||1==a.endContainer.nodeType&&a.endOffset==a.endContainer.childNodes.length)b=b.createTextNode("\u200b"),a.insertNode(b);this.updateSelection()},insertBlock:function(a){var b;this.getDocument();b=this.range;b.deleteContents();var c=b.endContainer;3==c.nodeType&&(c=c.parentNode);
c.nodeName in ya&&b.collapseAfter(c);a=this.getDocument().createElement(a);b.insertNode(a);b.selectNodeContents(a);a=this.getDocument().createTextNode("\u200b");b.insertNode(a);this.updateSelection();this.refreshSelection();this.checkForDocChange()},getWindow:function(){return rangy.dom.getIframeWindow(this.frame)},getBody:function(a){return rangy.dom.getBody(a||this.getDocument())},getDocument:function(){return rangy.dom.getIframeDocument(this.frame)},getRootElement:function(){return this.getDocument().documentElement||
this.getBody()},findText:function(a,b,c){var e=this.getWindow(),d=this.getDocument(),g=!1;if(!a)return!1;if(e.find)return e.find(a,!!b,!!c);if(V)if(this.focus(),d.selection&&d.selection.createRange){if(g=!0,e=d.selection.createRange(),e.collapse(!!c),e.findText(a,c?-1E9:1E9,b?4:0))return e.select(),this.refreshSelection(),!0}else if(d.getSelection&&d.body.createTextRange){g=!0;e=d.getSelection().getRangeAt(0).cloneRange();e.collapse(!!c);for(var k=d.body.createTextRange(),h=0,l=c?-1:1;k.findText(a,
c?-1E9:1E9,b?4:0);){k.select();if(d.getSelection().getRangeAt(0).compareBoundaryPoints(c?Range.START_TO_START:Range.END_TO_END,e)==l)return this.refreshSelection(),!0;k.collapse(!!c);h++;if(1E3==h)return}k.expand("textedit");if(k.findText(a,c?-1E9:1E9,b?4:0))return k.select(),this.refreshSelection(),!0}g||I("Searching text inside iframe is not supported!");return!1},getText:function(){var a=rangy.createRange(this.getDocument()),b="";a.selectNodeContents(this.getBody());b=a.toString();a.detach();return b},
getHTML:function(){return this.getBody().innerHTML},css:function(a,b){var c=this.getSelectedNode();return 1===arguments.length?d(c).css(a):d(c).css(a,b)},hasParentNode:function(a,b){return!!this.getParentNode(a,b)},getParentNode:function(a,b){var c=d(this.getSelectedNode());b||(c=c.parent());c=c.closest(a);return 0==c.length?null:c[0]},getBlockNode:function(a,b){for(var c=a?ya:Oa,e=b||this.getSelectedNode();e&&e.nodeName&&!(e.nodeName in c)&&e.parentNode;)e=e.parentNode;return e&&e.nodeName&&e.nodeName in
c?e:null},getBlockFormat:function(a){var b="Normal";try{b=this.queryCommandValue("formatblock")}catch(c){}if(!b||"Normal"==b)if(b="Normal",a=this.getBlockNode(a))return ya[a.nodeName];return b},removeBlockFormat:function(){var a=this.getBlockNode();a&&this.removeNode(a)}});d.extend(d.dmxEditor.prototype,{initSelection:function(){rangy.init();rangy.supported?(this.selection=rangy.getIframeSelection(this.frame),this.refreshSelection("init")):ba("The browser doesn't support rangy to handle selections")},
checkForSelectionChange:function(){var a=this.range;this.oldRange||(this.oldRange=this.range);a.equals(this.oldRange)||(this.dispatch("editor:selectionchange"),this.oldElem!==this.selectedElement&&(this.dispatch("editor:nodeselectionchange",this.selectedElement,this.oldElem),this.controlSelection&&this.dispatch("editor:controlselect",this.selectedElement,this.oldElem)),this.oldElem=this.selectedElement,this.oldRange=a)},refreshSelection:function(a){if(!a||"keyup"!=a.type||!(a.keyCode in Qa||(32==
a.keyCode||48<=a.keyCode&&90>=a.keyCode)&&!a.altKey&&!a.ctrlKey&&!a.metaKey)){if(a&&"touchend"==a.type&&"IMG"==a.target.nodeName){var b=this.getDocument().createRange();b.selectNode(a.target);this.selection.setSingleRange(b);return!1}if(d(this.frame).is(":visible")){this.selection=rangy.getIframeSelection(this.frame);this.range=0==this.selection.rangeCount?rangy.createRange(this.getDocument()):this.selection.getRangeAt(0);a=this.range.startContainer;var b=this.range.startOffset,c=this.range.endContainer,
e=this.range.endOffset;this.controlSelection=!1;this.range.collapsed||1!=a.nodeType||a!=c||1!=e-b?this.selectedElement=this.range.commonAncestorContainer:(this.selectedElement=a.childNodes[b],this.selectedElement.nodeName in Pa&&(this.controlSelection=!0));3==this.selectedElement.nodeType&&(this.selectedElement=this.selectedElement.parentNode);this.selectedElement&&this.selectedElement.ownerDocument||(this.selectedElement=this.getBody());this.refreshToolbars();this.prevRange=this.range}this.focus()}},
updateSelection:function(){this.selection.setSingleRange(this.range);this.refreshSelection("UPDATE")},hasTextSelection:function(){return!this.range.collapsed&&!this.controlSelection},collapseSelection:function(a){this.range.collapse(a);this.updateSelection()},saveSelection:function(a){9!=this.getRange().commonAncestorContainer.nodeType&&(this.savedSelectionRange=this.getRange().cloneRange())},restoreSelection:function(a){this.savedSelectionRange&&(this.range=this.savedSelectionRange,this.updateSelection(),
this.refreshSelection())},getSelectedNode:function(a){a&&this.refreshSelection("NOCACHE");return this.selectedElement},selectionIsEditable:function(a,b){var c=a||this.getRange();return!(!d.dmxEditor.nodeIsEditable(this.getSelectionStartNode(c),b)||!d.dmxEditor.nodeIsEditable(this.getSelectionEndNode(c),b))},getSelectionEndNode:function(a){var b=a||this.getRange();a=b.endContainer;b=b.endOffset;1==a.nodeType&&a.hasChildNodes()&&(a=a.childNodes[0<b?b-1:b]);return a&&3==a.nodeType?a.parentNode:a},getSelectionStartNode:function(a){a=
a||this.getRange();var b;b=a.startContainer;1==b.nodeType&&b.hasChildNodes()&&(b=b.childNodes[Math.min(b.childNodes.length-1,a.startOffset)]);return b&&3==b.nodeType?b.parentNode:b},getSelection:function(){this.selection.refresh();this.range=this.getRange(this.selection);return this.selection},getRange:function(a){return(a=a||this.getSelection())&&0<a.rangeCount?a.getRangeAt(0):this.createRange()},createRange:function(){return rangy.createRange(this.designview.document)},getSelectionText:function(){var a=
this.getSelection();return 0<a.rangeCount?a.getRangeAt(0).toString():""},getSelectionHTML:function(){return d("<p/>").append(this.getRange().cloneContents()).html()},getSelectionRange:function(){var a=this.getBody(),b=-1,c=-1,e=this.getSelection(),d=this.createRange();d.setStart(a,0);e.focusNode&&(d.setEnd(e.focusNode,e.focusOffset),b=d.toString().length);e.anchorNode&&(d.setEnd(e.anchorNode,e.anchorOffset),c=d.toString().length);d.detach();return[Math.min(b,c),Math.max(b,c)]},setSelectionRange:function(a,
b){function c(a){a=a.childNodes;for(var b=a.length,d=[],e=0;e<b;e++)3==a[e].nodeType?d.push(a[e]):1===a[e].nodeType&&(d=d.concat(c(a[e])));return d}var e=Math.min(a,b),f=Math.max(a,b),g=this.getBody(),k=c(g),h=this.createRange(),l=0,n=!1,m=!1,s=g;d.each(k,function(a,b){s=b;!n&&l+b.length>e&&(h.setStart(s,e-l),n=!0);!m&&l+b.length>f&&(h.setEnd(s,f-l),m=!0);if(n&&m)return!1;l+=b.length});n||h.setStart(g,0);m||h.setEnd(h.startContainer,h.startOffset);g=this.getSelection();g.removeAllRanges();g.addRange(h)}});
var K=d.dmxEditor.Locale={languages:{en:{}},supported:v.makeMap("bg ca da de en es fi fr it nl sl".split(" ")),translate:function(a,b){return b&&this.languages[b]&&this.languages[b][a]?this.languages[b][a]:a in this.languages.en?this.languages.en[a]:a},translateString:function(a,b){return a.replace(/@\{([^\}]*)\}/g,function(a,e){return K.translate(e,b)})},translateHtml:function(a,b){return a.replace(/@\{([^\}]*)\}/g,function(a,e){return ha(K.translate(e,b))})},detectLanguage:function(){return(navigator.language||
navigator.userLanguage).toLowerCase().split("-")[0]},setLanguage:function(a,b){a.options.locale=b;d.each(a.Commands,function(a,e){e.notifyLocaleChange(b);e.locale=b;e.update()});a.ready&&(a.reloadAllToolbars(),a.dispatch("editor:localChange",b))}};d.dmxEditor.locales=K.languages;d.extend(d.dmxEditor.prototype,{translate:function(a,b){return K.translate(a,b||this.options.locale)},translateString:function(a,b){return K.translateString(a,b||this.options.locale)},translateHtml:function(a,b){return K.translateHtml(a,
b||this.options.locale)},setLocale:function(a){var b=this;require([d.dmxEditor.basePath+"dmxEditor/translations/en.js"]);"auto"==a&&(a=K.detectLanguage());a in K.languages?K.setLanguage(this,a):a in K.supported&&require([d.dmxEditor.basePath+"dmxEditor/translations/"+a+".js"],function(){K.setLanguage(b,a)})},registerTranslations:function(a){d.each(a,function(a,c){d.dmxEditor.locales[a]=d.dmxEditor.locales[a]||{};d.extend(d.dmxEditor.locales[a],c)})}});(function(a){a.extend(a.dmxEditor.prototype,{loadExtension:function(b,
c,e){var d=this;a.isArray(b)||(b=[b]);for(var g=0,k=b.length;g<k;g++)b[g]=b[g]+"/"+b[g];require({baseUrl:a.dmxEditor.basePath+"dmxEditor/extensions/"},b,function(){for(var b=0;b<arguments.length;b++){var g=arguments[b],k=g.dep||[];a.isArray(k)||(k=[k]);for(var m=0;m<k.length;m++){var s;d.extensions[k[m]]?s=d.extensions[k[m]]:(s=require(k[m]+"/"+k[m]),d.registerExtension(s));g[k[m]]=s}g.editor=d;g.env=a.extend({},za,{__DIR__:a.dmxEditor.basePath+"dmxEditor/extensions/"+g.id+"/"});d.registerExtension(g)}c.call(e||
d)})},registerExtension:function(b){b.translation&&this.registerTranslations(b.translation);b.commands&&this.registerCommands(b.commands);b.toolbars&&this.registerToolbars(b.toolbars);b.translators&&this.registerTranslators(b.translators);b.locale&&this.registerTranslations(b.locale);b.controls&&this.registerControls(b.controls);this.extensions[b.id]=b;b.extLang&&(Da(a.dmxEditor.basePath+"dmxEditor/extensions/"+b.id+"/en.js"),"en"!=this.options.locale&&Da(a.dmxEditor.basePath+"dmxEditor/extensions/"+
b.id+"/"+this.options.locale+".js"));if(a.isFunction(b.init))try{b.init(this,a.extend({},za,{__DIR__:a.dmxEditor.basePath+"dmxEditor/extensions/"+b.id+"/"}))}catch(c){console.log(b,c)}},registerCommands:function(a){for(var c in a)this.addCommand(c,a[c])},registerControls:function(a){for(var c in a)this.addControl(c,a[c])},registerToolbars:function(b){a.isArray(b)||(b=[b]);for(var c=0,d=b.length;c<d;c++){var f=b[c];f.id&&(this.options.toolbars[f.id]=a.extend(this.options.toolbars[f.id]||{},f),this.reloadToolbar(f.id))}},
registerTranslators:function(b){a.isArray(b)||(b=[b]);for(var c=a(this.frame),d,f=0,g=b.length;f<g;f++)d=b[f],a.isFunction(d.htmlToCode)&&c.bind("editor:untranslate",function(a,b){b.inStr=d.htmlToCode(b.inStr,b.editor)}),a.isFunction(d.codeToHtml)&&c.bind("editor:translate",function(a,b){b.inStr=d.codeToHtml(b.inStr,b.editor)})}})})(jQuery);Q("$.dmxEditor");var Ca=ea.extend({init:function(a,b,c){this.id=a;this.editor=b;c&&d.extend(this,c)},queryEnabled:function(){return"design"!=this.editor.currentView?
!1:!0},queryState:Fa,queryValue:Fa,execute:d.noop});d.dmxEditor.Command=Ca;var Va=Ca.extend({init:function(a,b,c){this._super(a,b,c)},queryEnabled:function(){if("design"!=this.editor.currentView)return!1;try{return this.editor.getDocument().queryCommandEnabled(this.id)}catch(a){return!0}},queryState:function(){if("design"!=this.editor.currentView)return!1;try{return this.editor.getDocument().queryCommandState(this.id)}catch(a){return!1}},queryValue:function(){if("design"!=this.editor.currentView)return null;
try{return this.editor.getDocument().queryCommandValue(this.id)}catch(a){return null}},execute:function(a){if("design"!=this.editor.currentView)return!1;try{this.editor.getDocument().execCommand("styleWithCSS",!1,!1)}catch(b){}try{this.editor.getDocument().execCommand(this.id,!1,a||null)}catch(c){I("Error executing "+this.id)}this.editor.refreshSelection()}});d.dmxEditor.NativeCommand=Va;d.extend(d.dmxEditor.prototype,{initCommands:function(){this.commands=this.commands||{};for(var a in d.dmxEditor.commands)this.addCommand(a,
d.dmxEditor.commands[a])},addCommand:function(a,b){a=a.toLowerCase();this.commands[a]=b.isNative?new Va(a,this,b):new Ca(a,this,b)},execCommand:function(a,b,c){a=a.toLowerCase();return this.queryCommandSupported(a)&&this.queryCommandEnabled?(this.commands[a].execute(c),this.checkForDocChange(),!0):!1},getCommand:function(a){return this.commands[a.toLowerCase()]},execute:function(a,b){a=a.toLowerCase();a in this.commands&&this.commands[a].queryEnabled()&&!1!==this.commands[a].execute(b)&&this.checkForDocChange()},
queryCommandAvailable:function(a){a=a.toLowerCase();return a in this.commands},queryCommandEnabled:function(a){a=a.toLowerCase();return this.queryCommandAvailable(a)?this.commands[a].queryEnabled():(I(a+" is not available in the commands collection"),!1)},queryCommandIndeterm:function(a){a=a.toLowerCase();return this.queryCommandAvailable(a)?null===this.commands[a].queryState():(I(a+" is not available in the commands collection"),!1)},queryCommandState:function(a){a=a.toLowerCase();return this.queryCommandAvailable(a)?
this.commands[a].queryState():(I(a+" is not available in the commands collection"),!1)},queryCommandValue:function(a){a=a.toLowerCase();return this.queryCommandAvailable(a)?this.commands[a].queryValue():(I(a+" is not available in the commands collection"),!1)}});d.dmxEditor.commands={bold:{isNative:!0},italic:{isNative:!0},underline:{isNative:!0},strikethrough:{isNative:!0},superscript:{isNative:!0},subscript:{isNative:!0},insertunorderedlist:{isNative:!0},insertorderedlist:{isNative:!0},inserthorizontalrule:{isNative:!0},
removeformat:{isNative:!0},fontname:{isNative:!0},"delete":{isNative:!0},noop:{},justifyleft:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.hasParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0)},queryState:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0);return a?"left"==d(a).css("textAlign")||"start"==d(a).css("textAlign")&&"ltr"==d(a).css("direction")||"end"==d(a).css("textAlign")&&"rtl"==
d(a).css("direction"):!1},execute:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0);a&&(this.queryState()?d(a).removeAttr("align").css("textAlign",""):d(a).removeAttr("align").css("textAlign","left"))}},justifycenter:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.hasParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0)},queryState:function(){if("design"!=this.editor.currentView)return!1;var a=
this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0);return a?"center"==d(a).css("textAlign")||"center"==d(a).attr("align"):!1},execute:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0);a&&(this.queryState()?d(a).removeAttr("align").css("textAlign",""):d(a).removeAttr("align").css("textAlign","center"))}},justifyfull:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.hasParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",
!0)},queryState:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0);return a?"justify"==d(a).css("textAlign")||"justify"==d(a).attr("align"):!1},execute:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0);a&&(this.queryState()?d(a).removeAttr("align").css("textAlign",""):d(a).removeAttr("align").css("textAlign","justify"))}},justifyright:{queryEnabled:function(){return"design"!=
this.editor.currentView?!1:this.editor.hasParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0)},queryState:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",!0);return a?"right"==d(a).css("textAlign")||"start"==d(a).css("textAlign")&&"rtl"==d(a).css("direction")||"end"==d(a).css("textAlign")&&"ltr"==d(a).css("direction"):!1},execute:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("DIV,H1,H2,H3,H4,H5,H6,P,TD,TH,LI",
!0);a&&(this.queryState()?d(a).removeAttr("align").css("textAlign",""):d(a).removeAttr("align").css("textAlign","right"))}},indent:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:!!this.editor.getBlockNode(!0)||this.editor.hasParentNode("LI",!0)},execute:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("LI",!0);if(a)this.editor.getDocument().execCommand("indent",!1,null);else if(a=this.editor.getBlockNode(!0)){var b=parseInt(d(a).css("marginLeft"),
10)||0;d(a).css("marginLeft",b+40)}}},outdent:{queryEnabled:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("LI",!0);return a?!0:(a=this.editor.getBlockNode(!0))?(marginLeft=parseInt(d(a).css("marginLeft"),10)||0,0<marginLeft):!1},execute:function(){if("design"!=this.editor.currentView)return!1;var a=this.editor.getParentNode("LI",!0);if(a)this.editor.getDocument().execCommand("outdent",!1,null);else if(a=this.editor.getBlockNode(!0)){var b=parseInt(d(a).css("marginLeft"),
10)||0;40<b?d(a).css("marginLeft",b-40):d(a).css("marginLeft","")}}},inserthtml:{execute:function(a){a&&this.editor.insertHtml(a,!0)}},fontsize:{queryValue:function(){return"design"!=this.editor.currentView?"":this.editor.css("fontSize")||""},execute:function(a){function b(a,b){a=d(a?a:f);a.css("fontSize",b);a.is("font[size]")&&a.removeAttr("size")}function c(a){a=d(a?a:f);0!==a.length?(a.is("font[size]")&&a.removeAttr("size"),a[0].style.removeProperty?a[0].style.removeProperty("font-size"):a[0].style.fontSize=
"inherit",""===a.attr("style")&&a.removeAttr("style")):I("no font node?")}if("design"!=this.editor.currentView)return!1;var e=this.editor,f=d(e.getSelectedNode(!0));e.hasTextSelection()?(e.getDocument().execCommand("styleWithCSS",!1,!1),e.getDocument().execCommand("FontSize",!1,3),e=f.is("font")?f:f.find("font"),0<e.length&&(""===a?c(e):b(e,a))):""===a?c(f):b(f,a);this.editor.updateSelection()}},formatblock:{queryValue:function(){if("design"!=this.editor.currentView)return"";var a=this.editor.getBlockNode();
return a&&a.nodeName||""},execute:function(a){if("design"!=this.editor.currentView)return!1;try{this.editor.getDocument().execCommand("formatblock",!1,"<"+a+">"),this.editor.refreshSelection()}catch(b){ba("can't execute formatblock command",b)}}},find:{queryEnabled:ca,queryValue:function(){return{textToFind:this.editor.getRange().toString()}},execute:function(a){a=a||{textToFind:this.editor.getRange().toString()};(a=this.editor.findText(a.textToFind,a.matchCase,a.searchUpward))||sa("Not found");return a}},
replace:{queryEnabled:ca,execute:function(a){if(a&&a.textToFind){var b=this.editor.getRange(),c=b.toString(),d=!1;a.matchCase||(c=c.toLowerCase(),a.textToFind=a.textToFind.toLowerCase());c==a.textToFind?(b.deleteContents(),b.collapse(!0),a.replaceWith&&(c=this.editor.getDocument().createTextNode(a.replaceWith),b.insertNode(c),b.selectNode(c)),this.editor.findText(a.textToFind,a.matchCase),d=!0):d=this.editor.findText(a.textToFind,a.matchCase);d||sa("Not found");return d}}},replaceAll:{queryEnabled:ca,
execute:function(a){if(a&&a.textToFind){this.editor.saveSelection();var b=this.editor.getRange(),c=this.editor.getBody(),d=!1;b.selectNodeContents(c);for(b.collapse(!0);this.editor.findText(a.textToFind,a.matchCase);)b=this.editor.getRange(),b.deleteContents(),b.collapse(!0),d=!0,a.replaceWith&&(c=this.editor.getDocument().createTextNode(a.replaceWith),b.insertNode(c),b.selectNode(c));d||(this.editor.restoreSelection(),sa("Not found"));return d}}},setClassName:{queryEnabled:function(){return"design"!=
this.editor.currentView?!1:this.editor.selectedElement&&"BODY"!=this.editor.selectedElement.tagName},queryValue:function(){if("design"!=this.editor.currentView)return"";var a=[];d(this.editor.selectedElement).parents("[class]").andSelf().each(function(){var b=d(this).attr("class");if(b)for(var b=b.replace(/\bdmx[^\s]*/gi,"").replace(/^\s+|\s+$/g).split(" "),c=0;c<b.length;c++)a.push(this.tagName+"."+b[c])});return a},execute:function(a){if("design"!=this.editor.currentView||!a.value)return!1;if(this.editor.hasTextSelection()&&
-1==a.value.indexOf("."))rangy.createCssClassApplier(a.value,{applyToEditableOnly:!0,normalize:!0}).toggleRange(this.editor.getRange());else{var b=d(this.editor.getBlockNode()),c=a.value;0<a.value.indexOf(".")&&(c=a.value.split("."),b=d(this.editor.selectedElement).closest(c[0]),c=c[1]);a.checked?b.addClass(c):b.removeClass(c)}}},forecolor:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getDocument().queryCommandEnabled("forecolor")},queryValue:function(){if("design"!=
this.editor.currentView)return null;try{return this.editor.getDocument().queryCommandValue("forecolor")}catch(a){return null}},execute:function(a){if("design"!=this.editor.currentView)return!1;if("clear"==a)for(a=this.editor.selectedElement;a&&"BODY"!=a.nodeName;){if(a.style.color){a.style.color="";break}a=a.parentNode}else if(this.editor.hasTextSelection())this.editor.getDocument().execCommand("forecolor",!1,a);else{var b=this.editor.getBlockNode();b&&(b.style.color=a)}}},bgcolor:{queryEnabled:function(){return"design"!=
this.editor.currentView?!1:this.editor.selectionIsEditable(null,"content")},queryValue:function(){if("design"!=this.editor.currentView)return null;try{return document.queryCommandSupported("hiliteColor")?(X&&this.editor.getDocument().execCommand("styleWithCSS",!1,!0),this.editor.getDocument().queryCommandValue("hilitecolor")):this.editor.getDocument().queryCommandValue("backcolor")}catch(a){return null}},execute:function(a){if("design"!=this.editor.currentView)return!1;if("clear"==a)for(a=this.editor.selectedElement;a&&
"BODY"!=a.nodeName;){if(a.style.backgroundColor){a.style.backgroundColor="";break}a=a.parentNode}else if(this.editor.hasTextSelection())document.queryCommandSupported("hiliteColor")?(X&&this.editor.getDocument().execCommand("styleWithCSS",!1,!0),this.editor.getDocument().execCommand("hilitecolor",!1,a)):this.editor.getDocument().execCommand("backcolor",!1,a);else{var b=this.editor.getBlockNode();b&&(b.style.backgroundColor=a)}}},insertTable:{execute:function(a){if("design"!=this.editor.currentView)return!1;
if(d.isPlainObject(a)){var b="<table";""!==a.width&&(b+=' width="'+a.width+a.widthExt+'"');""!==a.border&&(b+=' border="'+a.border+'"');""!==a.cellspacing&&(b+=' cellspacing="'+a.cellspacing+'"');""!==a.cellpadding&&(b+=' cellpadding="'+a.cellpadding+'"');""!==a.align&&(b+=' align="'+a.align+'"');for(var b=b+">",c=0;c<a.rows;c++){for(var b=b+"<tr>",e=0;e<a.cols;e++)b+="<td><br /></td>";b+="</tr>"}b+="</table>";"center"==a.align&&(b="<br />"+b+"<br />");this.editor.insertHtml(b)}}},editTable:{queryEnabled:function(){return"design"!=
this.editor.currentView?!1:!!this.editor.hasParentNode("TABLE",!0)},queryValue:function(){if("design"!=this.editor.currentView)return{};var a={};if(this.editor.hasParentNode("TABLE",!0)){var b,c=d(this.editor.getParentNode("TABLE",!0));if(b=c.attr("width"))a.width=parseInt(b,10)||"",a.widthExt=-1!=b.indexOf("%")?"%":"";a.border=c.attr("border")||"";a.cellspacing=c.attr("cellspacing")||"";a.cellpadding=c.attr("cellpadding")||"";a.align=c.attr("align")||""}return a},execute:function(a){if("design"!=
this.editor.currentView)return!1;if(d.isPlainObject(a)&&this.editor.hasParentNode("TABLE",!0)){var b=d(this.editor.getParentNode("TABLE",!0));""!==a.width?b.attr("width",a.width+a.widthExt):b.removeAttr("width");""!==a.border?b.attr("border",a.border):b.removeAttr("border");""!==a.cellspacing?b.attr("cellspacing",a.cellspacing):b.removeAttr("cellspacing");""!==a.cellpadding?b.attr("cellpadding",a.cellpadding):b.removeAttr("cellpadding");""!==a.align?b.attr("align",a.align):b.removeAttr("align")}}},
editTableCell:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:!!this.editor.hasParentNode("td,th",!0)}},hyperlink:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.hasTextSelection()||this.editor.hasParentNode("IMG",!0)||this.editor.hasParentNode("A",!0)},queryValue:function(){if("design"!=this.editor.currentView)return{};if(this.editor.hasParentNode("A",!0)){var a=d(this.editor.getParentNode("A",!0)),b,c,e,f,g,k=a[0].href.match(/^\w+:(\/\/)?/);b=
a.attr("href");c=b.match(/utm_source=([^&]*)/i);e=b.match(/utm_medium=([^&]*)/i);f=b.match(/utm_content=([^&]*)/i);g=b.match(/utm_campaign=([^&]*)/i);b=b.replace(/&(amp;)?utm_(source|medium|content|campaign)=([^&]*)/gi,"");var h="dmxLightbox"==a.attr("rel"),l=a.attr("rev"),n={};h&&l&&(n=eval("("+l+")"));return{lb_use:h,lb_width:n.width||"",lb_height:n.height||"",lb_group:n.group||"",utm_source:c?c[1]:"",utm_medium:e?e[1]:"",utm_content:f?f[1]:"",utm_campaign:g?g[1]:"",url:b,title:a.attr("title")||
"",target:a.attr("target")||"",scheme:k?k[0]:""}}return{}},execute:function(a){if("design"!=this.editor.currentView)return!1;if(d.isPlainObject(a)){var b,c=a.url;this.editor.hasParentNode("A",!0)?b=d(this.editor.getParentNode("A",!0)):(b="javascript:void("+(new Date).getTime()+");",this.editor.getDocument().execCommand("createlink",!1,b),b=d('a[href="'+b+'"]',this.editor.getBody()));a.utm_source&&(c+="&utm_source="+a.utm_source);a.utm_medium&&(c+="&utm_medium="+a.utm_medium);a.utm_content&&(c+="&utm_content="+
a.utm_content);a.utm_campaign&&(c+="&utm_campaign="+a.utm_campaign);b.attr("href",c);a.title?b.attr("title",a.title):b.removeAttr("title");if(a.lb_use){var c="",e=parseInt(a.lb_width,10),f=parseInt(a.lb_height,10);"number"==typeof e&&0<e&&(c+="width:"+e+",");"number"==typeof f&&0<f&&(c+="height:"+f+",");this.editor.options.lb_preset&&(c+="preset:'"+this.editor.options.lb_preset+"',");a.lb_group&&""!==a.lb_group&&(c+="group:'"+a.lb_group+"',");a.target="_blank";b.attr("rel","dmxLightbox");""!==c&&
b.attr("rev","{"+c.substr(0,c.length-1)+"}")}else"dmxLightbox"==b.attr("rel")&&(b.removeAttr("rel"),b.removeAttr("rev"));a.target?b.attr("target",a.target):b.removeAttr("target")}}},unlink:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.hasParentNode("A",!0)},execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.removeNode(this.editor.getParentNode("A",!0))}},addaoreditimage:{queryEnabled:function(){if("design"!=this.editor.currentView)return!1;
var a=this.editor.getParentNode("IMG",!0);return a&&a.hasAttribute("data-translated")?!1:!0},queryValue:function(){if("design"!=this.editor.currentView)return{};if(this.editor.hasParentNode("IMG",!0)){var a=d(this.editor.getParentNode("IMG",!0)),b={src:"",alt:"",align:"",border:0,hspace:"",vspace:"",width:"",height:""},c;for(c in b)b[c]=a.attr(c)||"";return b}return{}},execute:function(a){if("design"!=this.editor.currentView)return!1;if(d.isPlainObject(a))if(this.editor.hasParentNode("IMG",!0)){var b=
d(this.editor.getParentNode("IMG",!0));b.css({width:"",height:""});for(var c in a)""===a[c]?b.removeAttr(c):b.attr(c,a[c])}else b="<img",a.src&&(b+=' src="'+a.src+'"'),a.alt&&(b+=' alt="'+a.alt+'"'),a.align&&(b+=' align="'+a.align+'"'),a.border&&(b+=' border="'+a.border+'"'),a.hspace&&(b+=' hspace="'+a.hspace+'"'),a.vspace&&(b+=' vspace="'+a.vspace+'"'),a.width&&(b+=' width="'+a.width+'"'),a.height&&(b+=' height="'+a.height+'"'),this.editor.insertHtml(b+"/>")}},save:{queryEnabled:function(){return this.editor.isDocumentModified()},
execute:function(){this.editor.save();return!1}},close:{queryEnabled:ca,execute:function(){this.editor.isDocumentModified()&&confirm(this.editor.translate("msgAskSaveBeforeClose"))&&this.editor.save();var a=this;setTimeout(function(){a.editor.destruct()},10);return!1}},viewsource:{queryEnabled:ca,queryState:function(){return"code"==this.editor.getView()},execute:function(){this.editor.setView("code"==this.editor.getView()?"design":"code")}},togglefullscreen:{queryEnabled:ca,queryState:function(){return this.editor.wrapper.hasClass("fullscreen")},
execute:function(){this.editor.toggleFullscreen(!this.editor.wrapper.hasClass("fullscreen"))}},undo:{queryEnabled:function(){return this.editor.history.canUndo()},execute:function(){this.editor.history.undo()}},redo:{queryEnabled:function(){return this.editor.history.canRedo()},execute:function(){this.editor.history.redo()}},deleteRow:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getTableEditor().canDeleteRow()},execute:function(){if("design"!=this.editor.currentView)return!1;
this.editor.getTableEditor().deleteRow()}},insertRowBefore:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getTableEditor().canInsertRowBefore()},execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.getTableEditor().insertRowBefore()}},insertRowAfter:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getTableEditor().canInsertRowAfter()},execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.getTableEditor().insertRowAfter()}},
insertColBefore:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getTableEditor().canInsertColBefore()},execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.getTableEditor().insertColBefore()}},insertColAfter:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getTableEditor().canInsertColAfter()},execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.getTableEditor().insertColAfter()}},deleteCol:{queryEnabled:function(){return"design"!=
this.editor.currentView?!1:this.editor.getTableEditor().canDeleteCol()},execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.getTableEditor().deleteCol()}},deleteTable:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getTableEditor().canDeleteTable()},execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.getTableEditor().deleteTable()}},splitCell:{queryEnabled:function(){return"design"!=this.editor.currentView?!1:this.editor.getTableEditor().canSplitCell()},
execute:function(){if("design"!=this.editor.currentView)return!1;this.editor.getTableEditor().splitCell()}}};d.extend(d.dmxEditor.prototype,{initControls:function(){this.controls={};for(var a in d.dmxEditor.controls)this.addControl(a,d.dmxEditor.controls[a])},addControl:function(a,b){b=d.extend({type:"Control",editor:this},b||{});d.dmxEditor.ui[b.type]?this.controls[a]=new d.dmxEditor.ui[b.type](a,b):ba("Control not found: "+b.type);return this.controls[a]},getControl:function(a){return this.controls[a]},
updateControls:function(){for(var a in this.controls)this.controls[a].update()}});d.dmxEditor.controls={"-":{type:"Separator"},save:{type:"Button",icon:"save",tooltip:"Save",command:"save"},close:{type:"Button",icon:"close",tooltip:"Close",command:"close"},viewsource:{type:"Button",icon:"source",tooltip:"View Source",command:"viewsource"},togglefullscreen:{type:"Button",icon:"fullscreen",tooltip:"Toggle Fulscreen Mode",command:"togglefullscreen"},undo:{type:"Button",icon:"undo",tooltip:"Undo",command:"undo"},
redo:{type:"Button",icon:"redo",tooltip:"Redo",command:"redo"},find:{type:"DialogButton",icon:"find",tooltip:"Find",url:"dialogs/find.html",command:"find",cache:!0},replace:{type:"DialogButton",icon:"replace",tooltip:"Find and Replace",url:"dialogs/replace.html",command:"find",cache:!0},bold:{type:"Button",icon:"bold",tooltip:"Bold",command:"bold"},italic:{type:"Button",icon:"italic",tooltip:"Italic",command:"italic"},underline:{type:"Button",icon:"underline",tooltip:"Underline",command:"underline"},
strikethrough:{type:"Button",icon:"strikethrough",tooltip:"Strike Through",command:"strikethrough"},superscript:{type:"Button",icon:"superscript",tooltip:"Superscript",command:"superscript"},subscript:{type:"Button",icon:"subscript",tooltip:"Subscript",command:"subscript"},justifyleft:{type:"Button",icon:"align-left",tooltip:"Justify Left",command:"justifyleft"},justifycenter:{type:"Button",icon:"align-center",tooltip:"Justify Center",command:"justifycenter"},justifyfull:{type:"Button",icon:"align-justify",
tooltip:"Justify Full",command:"justifyfull"},justifyright:{type:"Button",icon:"align-right",tooltip:"Justify Right",command:"justifyright"},indent:{type:"Button",icon:"indent",tooltip:"Indent",command:"indent"},outdent:{type:"Button",icon:"outdent",tooltip:"Outdent",command:"outdent"},forecolor:{type:"ColorButton",icon:"fore-color",tooltip:"Text Color",command:"forecolor"},bgcolor:{type:"ColorButton",icon:"back-color",tooltip:"Background Color",command:"bgcolor"},removeformat:{type:"Button",icon:"remove-format",
tooltip:"Remove formatting",command:"removeformat"},insertunorderedlist:{type:"Button",icon:"list-bullets",tooltip:"UnorderedList",command:"insertunorderedlist"},insertorderedlist:{type:"Button",icon:"list-numbers",tooltip:"OrderedList",command:"insertorderedlist"},inserttable:{type:"DialogButton",icon:"table-insert",tooltip:"Insert Table",command:"insertTable",url:"dialogs/insert_table.html",cache:!0},editTable:{type:"DialogButton",icon:"table-edit",tooltip:"Table properties",command:"editTable",
url:"dialogs/edit_table.html",cache:!0},editTableCell:{type:"DialogButton",icon:"table-cell",tooltip:"Cell properties",command:"editTableCell",url:"dialogs/table_cell.html",cache:!0},insertRowBefore:{type:"Button",icon:"table-insert-row-before",tooltip:"Insert row above",command:"insertRowBefore"},insertRowAfter:{type:"Button",icon:"table-insert-row-after",tooltip:"Insert row below",command:"insertRowAfter"},insertColBefore:{type:"Button",icon:"table-insert-column-before",tooltip:"Insert column on the left",
command:"insertColBefore"},insertColAfter:{type:"Button",icon:"table-insert-column-after",tooltip:"Insert column on the right",command:"insertColAfter"},deleteRow:{type:"Button",icon:"table-delete-row",tooltip:"Delete row",command:"deleteRow"},deleteCol:{type:"Button",icon:"table-delete-column",tooltip:"Delete column",command:"deleteCol"},deleteTable:{type:"Button",icon:"table-delete",tooltip:"Delete table",command:"deleteTable"},inserthorizontalrule:{type:"Button",icon:"horizontal-rule",tooltip:"Horizontal rule",
command:"inserthorizontalrule"},addlink:{type:"DialogButton",icon:"link",tooltip:"Add Link",command:"hyperlink",url:"dialogs/link.html",cache:!0},deletelink:{type:"Button",icon:"unlink",tooltip:"Remove Link",command:"unlink"},addaoreditimage:{type:"DialogButton",icon:"image",tooltip:"Add/Edit Image",command:"addaoreditimage",url:"dialogs/image.html",modal:!0,cache:!0},insertspecialchar:{type:"DialogButton",icon:"special",tooltip:"Insert Special Character",url:"dialogs/specialchars.html",cache:!0},
fontname:{type:"Select",icon:"font",tooltip:"Font Family",width:"80px",command:"fontname",values:function(){var a=d.extend(!0,{},this.editor.options.fonts),b;for(b in a)for(var c=0;c<a[b].length;c++){var e=a[b][c];a[b][c]={label:e,value:e,style:"padding-left:10px;font-size:12px;font-family:"+e}}return a}},fontsize:{type:"Select",tooltip:"Font size",width:"40px",command:"fontsize",values:function(){return this.editor.options.fontSizes}},formatblock:{type:"Select",tooltip:"Format block",width:"100px",
command:"formatblock",values:function(){return this.editor.options.formatBlocks}},setClassName:{type:"MultiSelect",tooltip:"CSS class",width:"120px",command:"setClassName",values:function(){return this.editor.userStyles}},code_toggle_wrap:{type:"Button",icon:"text-wrap",tooltip:"Wrap lines",command:"code_toggle_wrap"},code_toggle_indent:{type:"Button",icon:"text-indent",tooltip:"Indent Source",command:"code_toggle_indent"}};d.extend(d.dmxEditor.prototype,{initKeys:function(){for(var a in d.dmxEditor.Keys)this.registerKey(a,
d.dmxEditor.Keys[a])},registerKey:function(a,b){for(var c=a.split(" "),d=0;d<c.length;d++)this.Keys[this.normalizeKey(c[d])]=b},normalizeKey:function(a){a=a.toUpperCase().split("+");for(var b="",c="",d=!1,f=!1,g=!1,k=0;k<a.length;k++)switch(a[k]){case "ALT":d=!0;break;case "CMD":case "COMMAND":case "META":case "CTRL":case "CONTROL":f=!0;break;case "SHIFT":g=!0;break;default:c=a[k]}g&&(b+="SHIFT+");f&&(b+="CTRL+");d&&(b+="ALT+");return b+c}});d.dmxEditor.Keys={Enter:function(){var a=this.options.lineBreak.toUpperCase(),
b=this.getBlockNode(!0);this.refreshSelection();if("design"!=this.currentView)this.insertBR();else if(b||"BR"==a||3!=this.selectedElement.firstChild.nodeType)if(b){if(/^(LI|UL|DL|DT|DD|OL)$/.test(b.nodeName)){if(/^[\s\r\n\t\f(&nbsp;)(<br>)]*$/.test(b.innerHTML)){d(b).remove();this.insertBlock("AUTO"==a||"BR"==a?"P":a);return}return!0}if("BR"==a&&/^(P|DIV)$/.test(b.nodeName))this.insertBR();else{b=this.selection;b.isCollapsed||b.deleteFromDocument();var c=!1;rangy.dom.isCharacterDataNode(b.focusNode)&&
b.focusOffset==b.focusNode.length&&(c=!0);if(!c)return!0;this.insertBlock("AUTO"==a||"BR"==a?"P":a)}}else this.insertBR();else a="AUTO"==a||"BR"==a?"P":a,d(this.selectedElement.firstChild).wrap("<"+a+">"),this.insertBlock(a)},"Shift+Enter":function(){var a=this.getBlockNode(!0,this.getSelectedNode(!0));if(a&&"PRE"==a.nodeName){a=this.selection;a.isCollapsed||a.deleteFromDocument();var a=this.range,b=this.getDocument().createTextNode("\r\n");a.insertNode(b);a.collapseAfter(b);this.updateSelection()}else this.insertBR()},
"Ctrl+1":function(){this.execute("formatblock","h1")},"Ctrl+2":function(){this.execute("formatblock","h2")},"Ctrl+3":function(){this.execute("formatblock","h3")},"Ctrl+4":function(){this.execute("formatblock","h4")},"Ctrl+5":function(){this.execute("formatblock","h5")},"Ctrl+6":function(){this.execute("formatblock","h6")},"Ctrl+S":function(){this.execute("save")},"Ctrl+Q":function(){this.execute("close")},"Ctrl+Z":function(){this.execute("undo")},"Ctrl+Y Ctrl+Shift+Z":function(){this.execute("redo")},
"Ctrl+B":function(){this.execute("bold")},"Ctrl+I":function(){this.execute("italic")},"Ctrl+U":function(){this.execute("underline")},Tab:function(){return"code"==this.currentView?(this.insertHtml("&nbsp;&nbsp;"),!1):!0},"Ctrl+Tab":function(){this.execute("indent")},"Shift+Ctrl+Tab":function(){this.execute("outdent")},"Ctrl+F":function(){var a=this.getControl("find");a&&a.openDialog()},"Ctrl+H":function(){var a=this.getControl("replace");a&&a.openDialog()},F3:function(){this.execute("find")}};d.fn.dmxEditorDestruct=
function(){return this.each(function(a,b){var c=d.data(b,"dmxEditor");c&&(c.destruct(),d(b).removeData("dmxEditor"))})};d.fn.dmxEditor=function(a){rangy.init();return this.each(function(){var b=d.data(this,"dmxEditor");b?b.config(a||{}):d.dmxEditor.replaceElement(this,a||{})})}}else alert("Please include jQuery before using Advanced HTML Editor 3!")})();
